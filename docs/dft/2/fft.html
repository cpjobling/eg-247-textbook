<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>The Fast-Fourier Transform</title>
  <meta name="description" content="The Fast Fourier Transform">

  <link rel="canonical" href="/eg-247-textbook/eg-247-textbook/dft/2/fft.html">
  <link rel="alternate" type="application/rss+xml" title="EG-247 Signals and Systems" href="/eg-247-textbook/eg-247-textbook/feed.xml">

  <meta property="og:url"         content="/eg-247-textbook/eg-247-textbook/dft/2/fft.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="The Fast-Fourier Transform" />
<meta property="og:description" content="The Fast Fourier Transform" />
<meta property="og:image"       content="" />


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage":
    "/eg-247-textbook/dft/2/fft.html",
  "headline":
    "The Fast-Fourier Transform",
  "datePublished":
    "2019-04-05T08:37:43+01:00",
  "dateModified":
    "2019-04-05T08:37:43+01:00",
  "description":
    "The Fast Fourier Transform",
  "author": {
    "@type": "Person",
    "name": "Dr Chris P. Jobling"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "/eg-247-textbook",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "/eg-247-textbook",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/eg-247-textbook/assets/css/styles.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css ">
  <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/eg-247-textbook/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    CommonHTML: {
        linebreaks: {
            automatic: true,
        },
    },
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_CHTML' async></script>

  <!-- DOM updating function -->
  <script>
const runWhenDOMLoaded = cb => {
  if (document.readyState != 'loading') {
    cb()
  } else if (document.addEventListener) {
    document.addEventListener('DOMContentLoaded', cb)
  } else {
    document.attachEvent('onreadystatechange', function() {
      if (document.readyState == 'complete') cb()
    })
  }
}

// Helper function to init things quickly
initFunction = function(myfunc) {
  runWhenDOMLoaded(myfunc);
  document.addEventListener('turbolinks:load', myfunc);
};
</script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="/eg-247-textbook/assets/js/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  <script src="https://unpkg.com/nbinteract-core" async></script>

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


  <!-- Google analytics -->
  <script src="/eg-247-textbook/assets/js/ga.js" async></script>

  <!-- Clipboard copy button -->
  <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/eg-247-textbook/assets/js/scripts.js" async></script>

  <!-- Load JS that depends on site variables -->
  <script>
/**
 * Set up copy/paste for code blocks
 */
const codeCellId = index => `codecell${index}`

const clipboardButton = id =>
  `<a class="btn copybtn o-tooltip--left" data-tooltip="Copy" data-clipboard-target="#${id}">
    <img src="/eg-247-textbook/assets/images/copy-button.svg" alt="Copy to clipboard">
  </a>`

// Clears selected text since ClipboardJS will select the text when copying
const clearSelection = () => {
  if (window.getSelection) {
    window.getSelection().removeAllRanges()
  } else if (document.selection) {
    document.selection.empty()
  }
}

// Changes tooltip text for two seconds, then changes it back
const temporarilyChangeTooltip = (el, newText) => {
  const oldText = el.getAttribute('data-tooltip')
  el.setAttribute('data-tooltip', newText)
  setTimeout(() => el.setAttribute('data-tooltip', oldText), 2000)
}

const addCopyButtonToCodeCells = () => {
  // If ClipboardJS hasn't loaded, wait a bit and try again. This
  // happens because we load ClipboardJS asynchronously.
  if (window.ClipboardJS === undefined) {
    setTimeout(addCopyButtonToCodeCells, 250)
    return
  }

  const codeCells = document.querySelectorAll('.input_area pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    codeCell.insertAdjacentHTML('afterend', clipboardButton(id))
  })

  const clipboard = new ClipboardJS('.copybtn')
  clipboard.on('success', event => {
    clearSelection()
    temporarilyChangeTooltip(event.trigger, 'Copied!')
  })

  clipboard.on('error', event => {
    temporarilyChangeTooltip(event.trigger, 'Failed to copy')
  })

  // Get rid of clipboard before the next page visit to avoid memory leak
  document.addEventListener('turbolinks:before-visit', () =>
    clipboard.destroy()
  )
}

initFunction(addCopyButtonToCodeCells);
</script>

  <!-- Load custom user CSS and JS  -->
  <script src="/eg-247-textbook/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/eg-247-textbook/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  <script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['hub'] = hub;
      } else {
        // Create the REST params
        params = {'hub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}

// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    hubUrl = rest['hub'];
    if (hubUrl !== undefined) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);
      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      link = document.querySelectorAll("a.interact-button")[0];
      if (link !== undefined) {
          // Update the interact link URL
          var href = link.getAttribute('href');
          var hub_type = '';
          if (hub_type === 'binder') {
            // If binder links exist, we need to re-work them for jupyterhub
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // If localhost, assume we're working from a local Jupyter server and remove `/hub`
              first = [hubUrl, 'git-sync'].join('/')
            } else {
              first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
            }
            href = first + '?' + binder2Jupyterhub(href);
          } else {
            // If JupyterHub links, we only need to replace the hub url
            href = href.replace("", hubUrl);
            if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
              // Assume we're working from a local Jupyter server and remove `/hub`
              href = href.replace("/hub/user-redirect", "");
            }
          }
          link.setAttribute('href', decodeURIComponent(href));

          // Add text after interact link saying where we're launching
          hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
          document.querySelectorAll("a.interact-button")[0].insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');
      }
      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>
</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <img src="/eg-247-textbook/images/logo/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/>
  <h2 class="c-sidebar__title">EG-247 Signals and Systems</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/introduction/index"
        >
          
            1.
          
          Introduction
        </a>

        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/elementary_signals/index"
        >
          
            2.
          
          Elementary Signals
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/elementary_signals/hw1"
                >
                  
                  Homework 1
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/laplace_transform/index"
        >
          
            3.
          
          Laplace Transforms and their Applications
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/1/laplace"
                >
                  
                    3.1
                  
                  The Laplace Transformation
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/2/inverse_laplace"
                >
                  
                    3.2
                  
                  The Inverse Laplace Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/3/circuit_analysis"
                >
                  
                    3.3
                  
                  Using Laplace Transforms for Circuit Analysis
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/4/transfer_functions"
                >
                  
                    3.4
                  
                  Transfer Functions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/5/convolution"
                >
                  
                    3.5
                  
                  The Impulse Response and Convolution
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/fourier_series/index"
        >
          
            4.
          
          Fourier Series
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/1/trig_fseries"
                >
                  
                    4.1
                  
                  Trigonometric Fourier Series
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/2/exp_fs1"
                >
                  
                    4.2
                  
                  Exponential Fourier Series
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/3/exp_fs2"
                >
                  
                    4.3
                  
                  Line Spectra and their Applications
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/fourier_transform/index"
        >
          
            5.
          
          Fourier Transform
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/1/ft1"
                >
                  
                    5.1
                  
                  Defining the Fourier Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/2/ft2"
                >
                  
                    5.2
                  
                  Fourier transforms of commonly occuring signals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/3/ft3"
                >
                  
                    5.3
                  
                  Fourier Transforms for Circuit and LTI Systems Analysis
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/4/ft4"
                >
                  
                    5.4
                  
                  Introduction to Filters
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/dt_systems/index"
        >
          
            6.
          
          Sampled Data Systems
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dt_systems/1/sampling"
                >
                  
                    6.1
                  
                  Sampling Theory
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dt_systems/2/z_transform"
                >
                  
                    6.2
                  
                  The Z-Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dt_systems/3/i_z_transform"
                >
                  
                    6.3
                  
                  The Inverse Z-Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dt_systems/4/dt_models"
                >
                  
                    6.4
                  
                  Models of Discrete Time Systems
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/dft/index"
        >
          
            7.
          
          Discrete Fourier Transform
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dft/1/dft"
                >
                  
                    7.1
                  
                  The Discrete Fourier Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/eg-247-textbook/dft/2/fft"
                >
                  
                    7.2
                  
                  The Fast-Fourier Transform
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">In Class Worksheets</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/worksheets/index"
        >
          
          Worksheets
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/introduction/worksheet1"
                >
                  
                  Worksheet 1 Introduction
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/introduction/worksheet2"
                >
                  
                  Worksheet 2
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/elementary_signals/worksheet3"
                >
                  
                  Worksheet 3 Elementary Signals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/1/worksheet4"
                >
                  
                  Worksheet 4 Laplace Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/2/worksheet5"
                >
                  
                  Worksheet 5 Inverse Laplace Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/3/worksheet6"
                >
                  
                  Worksheet 6 Using Laplace Transforms for Circuit Analysis
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/4/worksheet7"
                >
                  
                  Worksheet 7 Transfer Functions
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/laplace_transform/5/worksheet8"
                >
                  
                  Worksheet 8 Impulse Response and Time Convolution
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/1/worksheet9"
                >
                  
                  Worksheet 9 Trigonometric Fourier Series
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/2/worksheet10"
                >
                  
                  Worksheet 10 Exponential Fourier Series
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_series/3/worksheet11"
                >
                  
                  Worksheet 11 Line Spectra and their Applications
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/1/worksheet12"
                >
                  
                  Worksheet 12 Defining the Fourier Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/2/worksheet13"
                >
                  
                  Worksheet 13 Fourier transforms of commonly occuring signals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/3/worksheet14"
                >
                  
                  Worksheet 14 Fourier Transforms for Circuit and LTI Systems Analysis
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/fourier_transform/4/worksheet15"
                >
                  
                  Worksheet 15 Introduction to Filters
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dt_systems/3/worksheet16"
                >
                  
                  Worksheet 16 The Inverse Z-Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dt_systems/4/worksheet17"
                >
                  
                  Worksheet 17 Models of DT Systems
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dft/1/worksheet18"
                >
                  
                  Worksheet 18 The Discrete-time Fourier Transform
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/dft/2/worksheet19"
                >
                  
                  Worksheet 19 The Fast Fourier Transform
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">Homework</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Lab Exercises</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/labs/index"
        >
          
          Laboratory Exercises
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab01/index"
                >
                  
                  Lab 1 - Elemementary Signals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab02/index"
                >
                  
                  Lab 2 - Laplace and Inverse Laplace Transforms
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab03/index"
                >
                  
                  Lab 3 -  Laplace Transforms and Transfer Functions for Circuit Analysis
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab04/index"
                >
                  
                  Lab 4 - Time Domain Convolution
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab05/index"
                >
                  
                  Lab 5 - Fourier Series
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab06/index"
                >
                  
                  Lab 6 - Sounds and Sampling
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/lab07/index"
                >
                  
                  Optional Lab 7 - Filters
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/eg-247-textbook/labs/project/index"
                >
                  
                  Project
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">Project</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/labs/project/index"
        >
          
          Project
        </a>

        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">Answers to Selected problems</li>
        
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/eg-247-textbook/introduction/answers"
        >
          
          Worksheet 2
        </a>

        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/choldgraf/jupyter-book">Jupyter Book</a></p>
</nav>

      <!-- Shamelessly copied from minimal mistakes -->


<!-- TOC will only show up if it has at least one item -->


  <aside class="sidebar__right">
    <nav class="onthispage">
      <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
      <ul class="toc__menu">
  <li><a href="#scope-and-background-reading">Scope and Background Reading</a>
    <ul>
      <li><a href="#acknowledgements">Acknowledgements</a></li>
    </ul>
  </li>
  <li><a href="#agenda">Agenda</a></li>
  <li><a href="#the-inefficiency-of-the-dft">The inefficiency of the DFT</a></li>
  <li><a href="#the-fast-fourier-transform-fft">The Fast Fourier Transform (FFT)</a>
    <ul>
      <li><a href="#decomposition-in-time-fft-algorithm">Decomposition-in-Time FFT Algorithm</a></li>
      <li><a href="#in-class-example-1">In Class Example 1</a></li>
      <li><a href="#decomposition-in-frequency-fft">Decomposition-in-Frequency FFT</a></li>
      <li><a href="#in-class-example-2">In Class Example 2</a></li>
    </ul>
  </li>
  <li><a href="#efficiency-of-the-fft">Efficiency of the FFT</a>
    <ul>
      <li><a href="#dft-and-fft-comparisons">DFT and FFT Comparisons</a></li>
    </ul>
  </li>
  <li><a href="#in-class-demonstrations">In Class Demonstrations</a>
    <ul>
      <li><a href="#fft-in-matlab">FFT in MATLAB</a></li>
      <li><a href="#example-3">Example 3</a></li>
      <li><a href="#example-4">Example 4</a></li>
    </ul>
  </li>
  <li><a href="#summary">Summary</a></li>
  <li><a href="#homework">Homework</a></li>
  <li><a href="#the-end">The End?</a>
    <ul>
      <li><a href="#footnotes">Footnotes</a></li>
    </ul>
  </li>
  <li><a href="#solutions">Solutions</a>
    <ul>
      <li><a href="#example-1">Example 1</a></li>
      <li><a href="#example-2">Example 2</a></li>
      <li><a href="#example-3-1">Example 3</a></li>
      <li><a href="#example-4-1">Example 4</a></li>
    </ul>
  </li>
</ul>
    </nav>
  </aside>



      <main class="c-textbook__page" tabindex="-1">
          <div class="o-wrapper">
            <div class="c-sidebar-toggle">
  <!-- We show the sidebar by default so we use .is-active -->
  <button
    id="js-sidebar-toggle"
    class="hamburger hamburger--arrowalt is-active"
  >
    <span class="hamburger-box">
      <span class="hamburger-inner"></span>
    </span>
    <span class="c-sidebar-toggle__label">Toggle Sidebar</span>
  </button>
</div>

            
<div class="buttons">




</div>


            <div class="c-textbook__content">
              <h1 id="the-fast-fourier-transform">The Fast Fourier Transform</h1>

<h2 id="scope-and-background-reading">Scope and Background Reading</h2>

<p>This session introduces the fast fourier transform (FFT) which is one of the most widely used numerical algorithms in the world. It exploits some features of the symmetry of the computation of the DFT to reduce the complexity to something that takes order $N^2$ ($O(N^2)$) complex operations to something that takes order $N log N$ ($O(N \log N)$) operations.</p>

<p>The FFT is to be found in all manner of signal and image processing algorithms, and because it is more efficient than the DFT, you will find it exploited in hundreds of signal processing applications.</p>

<p>As one example, it turns out that the computation of the convolution of two long DT sequences is more efficient if the FFT of the two signals is taken, the product of the frequency spectra is computed, and the Inverse DFT of the result is computed.</p>

<p>In this presentation, we will not go through the mathematical development of the FFT, please read section 10.6 of Karris if you want the details. Here we will concentrate on the benefits to be gained by using the FFT and give some examples of its use in MATLAB.</p>

<h3 id="acknowledgements">Acknowledgements</h3>

<p>The material in this presentation and notes is based on Chapter 10 of <a href="http://site.ebrary.com/lib/swansea/docDetail.action?docID=10547416">Steven T. Karris, Signals and Systems: with Matlab Computation and Simulink Modelling, 5th Edition</a> from the <strong>Required Reading List</strong>. The models of the FFT signal flow graphs and Simulink block diagrams are based on the presentation given in Section 12.5 of Phillips, Parr and Riskin, Signals, Systems and Transforms, 5th Ed., Pearson, 2014.</p>

<h2 id="agenda">Agenda</h2>

<ul>
  <li>
    <p>The inefficiency of the DFT</p>
  </li>
  <li>
    <p>The FFT - a sketch of its development</p>
  </li>
  <li>
    <p>An illustration of part of the FFT algorithm</p>
  </li>
  <li>
    <p>FFT v DFT</p>
  </li>
  <li>
    <p>Two examples</p>
  </li>
</ul>

<h2 id="the-inefficiency-of-the-dft">The inefficiency of the DFT</h2>

<p>Consider a signal whose highest frequency is 18 kHz, the sampling frequency is 50 kHz, and 1024 samples are taken, i.e., $N=1024$.</p>

<p>The time required to compute the entire DFT would be:</p>

<script type="math/tex; mode=display">t = \frac{1024\,\mathrm{samples}}{50\times 10^3\,\mathrm{samples\ per\ second}} = 20.48\,\mathrm{ms}</script>

<p>To compute the number of operations required to complete this task, let us expand the N-point DFT defined as:</p>

<script type="math/tex; mode=display">X[m] = \sum_{n=0}^{N-1} x[n] W_N^{mn}</script>

<p>Then
<script type="math/tex">% <![CDATA[
\begin{eqnarray*}
  X[0] &=& x[0]W_N^0 + x[1]W_N^0 + x[1]W_N^0 +  \cdots  + x[N - 1]W_N^0 \hfill \\
  X[1] &=& x[0]W_N^0 + x[1]W_N^1 + x[1]W_N^2 +  \cdots  + x[N - 1]W_N^{N - 1} \hfill \\
  X[2] &=& x[0]W_N^0 + x[1]W_N^2 + x[1]W_N^4 +  \cdots  + x[N - 1]W_N^{2(N - 1)} \hfill \\
  \hfil &\cdots&  \hfill \\
  X[N - 1] &=& x[0]W_N^0 + x[1]W_N^{N - 1} + x[1]W_N^{2(N - 1)} +  \cdots  + x[N - 1]W_N^{(N - 1)^2} \hfill \\ 
\end{eqnarray*} %]]></script></p>

<ul>
  <li>It is worth remembering that</li>
</ul>

<script type="math/tex; mode=display">W_N^0 = \exp\left(-j\frac{2\pi}{N}(0)\right) = 1.</script>

<ul>
  <li>
    <p>Since $W_N^i$ is a complex number, the computation of any frequency component $X[k]$ requires $N$ complex multiplications and $N$ complex additions</p>
  </li>
  <li>
    <p>$2N$ complex arithmetic operations are required to compute any frequency component of $X[k].$<sup>1</sup></p>
  </li>
  <li>
    <p>If we assume that $x[n]$ is real, then only $N/2$ of the $X[m]$ components are unique.</p>
  </li>
  <li>
    <p>Therefore we would require $2N\times N/2 = N^2$ complex operations to compute the entire frequency spectrum.<sup>2</sup></p>
  </li>
  <li>
    <p>For our example, the $N=1024$-point DFT, would require $1024^2 = 1,048,576$ complex operations</p>
  </li>
  <li>
    <p>These would have to be completed in 20.48 ms.</p>
  </li>
  <li>
    <p>This may be possible with modern computing hardware, perhaps even in a mobile phone, but it seems impractical.</p>
  </li>
  <li>
    <p>Fortunately, many of the $W_N$ terms in the computation are unity ($=\pm 1$).</p>
  </li>
  <li>
    <p>Moreover, because the $W_N^i$ points are equally spaced points on the unit circle;</p>
  </li>
  <li>
    <p>And because $N$ is a power of 2, the points on the upper-half plane (range $0 &lt; \theta &lt; \pi$ are the mirror image of the points on the lower-half plane range $\pi &lt; \theta &lt; 2\pi$;</p>
  </li>
  <li>
    <p>Thus, there is a great deal of symmetry in the computation that can be exploited to simplify the computation and reduce the number of operations considerably to a much more manageable $N\log_2 N$ operations<sup>3</sup>.</p>
  </li>
</ul>

<p>This is possible with the algorithm called the <a href="https://en.wikipedia.org/wiki/Fast_Fourier_transform">FTT</a> (fast Fourier transform) that was originally developed by <a href="https://en.wikipedia.org/wiki/James_Cooley">James Cooley</a> and <a href="https://en.wikipedia.org/wiki/John_Tukey">John Tukey</a> and has been considerably refined since.</p>

<h2 id="the-fast-fourier-transform-fft">The Fast Fourier Transform (FFT)</h2>

<p>The FFT is very well documented, including in Karris, so we will only sketch its development and present its main result. However, we will illustrate part of the algorithm to make concrete an idea of the efficiency advantage that the FFT has over the DFT that we have already seen.</p>

<p>Much of the development follows from the properties of the rotating vector.<sup>4</sup></p>

<script type="math/tex; mode=display">W_N=\exp\left(-\frac{j2\pi}{N}\right)</script>

<p>which results in some simplifications and mathematical short-cuts when $N$ is a power of 2.</p>

<p>The most useful properties are:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{eqnarray*}
  W_N^N &=& \exp\left(-j\frac{2\pi}{N}N\right) = \exp\left(-j2\pi\right) = 1.\\
  W_N^{N/2} &=&  \exp\left(-j\frac{2\pi}{N}\frac{N}{2}\right) = \exp\left(-j\pi\right) = -1.\\
  W_N^{N/4} &=&  \exp\left(-j\frac{2\pi}{N}\frac{N}{4}\right) = \exp\left(-j\pi/2\right) = -j.\\
  W_N^{3N/4} &=&  \exp\left(-j\frac{2\pi}{N}\frac{3N}{4}\right) = \exp\left(-j3\pi/2\right) = j.\end{eqnarray*} %]]></script>

<script type="math/tex; mode=display">% <![CDATA[
\begin{eqnarray*}
  W_N^{kN} &=&  \exp\left(-j\frac{2\pi}{N}kN\right) = \exp\left(-j2\pi\right) = 1,\,k=0,1,2,\ldots\\
  W_N^{kN+r} &=&  \exp\left(-j\frac{2\pi}{N}kN\right)\exp\left(-j\frac{2\pi}{N}r\right) = 1.W_N^r=W_N^r.\\
  W_{2N}^{k} &=&  \exp\left(-j\frac{2\pi}{2N}k\right) = \exp\left(-j\frac{2\pi}{N}\frac{k}{2}\right) = W_N^{k/2}.
\end{eqnarray*} %]]></script>

<p>Representing</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{eqnarray*}
  X[0] &=& x[0]W_N^0 + x[1]W_N^0 + x[2]W_N^0 +  \cdots  + x[N - 1]W_N^0 \hfill \\
  X[1] &=& x[0]W_N^0 + x[1]W_N^1 + x[2]W_N^2 +  \cdots  + x[N - 1]W_N^{N - 1} \hfill \\
  X[2] &=& x[0]W_N^0 + x[1]W_N^2 + x[2]W_N^4 +  \cdots  + x[N - 1]W_N^{2(N - 1)} \hfill \\
  \hfil &\cdots&  \hfill \\
  X[N - 1] &=& x[0]W_N^0 + x[1]W_N^{N - 1} + x[2]W_N^{2(N - 1)} +  \cdots  + x[N - 1]W_N^{(N - 1)^2} \hfill \\ 
\end{eqnarray*} %]]></script>

<p>in matrix form:
<script type="math/tex">% <![CDATA[
\left[ {\begin{array}{*{20}{c}}
{X[0]}\\
{X[1]}\\
{X[2]}\\
 \vdots \\
{X[N - 1]}\end{array}} \right] = \left[ {\begin{array}{*{20}{c}}
{W_N^0}&{W_N^0}&{W_N^0}&\cdots&{W_N^0}\\
{W_N^0}&{W_N^1}&{W_N^2}&\cdots&{W_N^{N - 1}}\\
{W_N^0}&{W_N^2}&{W_N^4}&\cdots&{W_N^{2(N - 1)}}\\
\cdots&\cdots&\cdots&\cdots&\cdots\\
{W_N^0}&{W_N^{N - 1}}&{W_N^{2(N - 1)}}&\cdots&W_N^{(N - 1)^2}\\
\end{array}} \right]\left[ {\begin{array}{*{20}{c}}
{x[0]}\\
{x[1]}\\
{x[2]}\\
 \vdots \\
{x[N - 1]}
\end{array}} \right]. %]]></script></p>

<p>This is a complex <a href="https://en.wikipedia.org/wiki/Vandermonde_matrix">Vandemonde matrix</a> and it is more compactly expressed as:</p>

<script type="math/tex; mode=display">\mathbf{X}[m] = \mathbf{W_N} \mathbf{x}[n]</script>

<p>The algorithm developed by Cooley and Tukey is based on <em>matrix decomposition</em> methods, where the matrix $\mathbf{W_N}$ is factored into $L$ smaller matrices, that is:</p>

<script type="math/tex; mode=display">\mathbf{W_N} = \mathbf{W_1} \mathbf{W_2} \mathbf{W_3} \cdots \mathbf{W_L}</script>

<p>where $L$ is chosen as $L = \log_2N$ or $N=2^L$.</p>

<p>Each row of the matrices on the right side of the decomposition, contains only two, non-zero terms, unity and $W_N^k$.</p>

<p>And the DFT sequence is:</p>

<script type="math/tex; mode=display">\mathbf{X}[m] = \mathbf{W_1} \mathbf{W_2} \mathbf{W_3} \cdots \mathbf{W_L} \mathbf{x}[n].</script>

<p>The FFT computation starts with matrix $\mathbf{W}_L$. It operates on $\mathbf{x}[n]$ producing a row vector, and each component of the row vector is obtained by one multiplication and one addition. This is because there are only two non-zero elements on a given row, and one of those elements is unity. Since there are $N$ components of $\mathbf{x}[n]$, there will be $N$ complex multiplications and $N$ complex additions.</p>

<p>This new vector is then operated on by the $\mathbf{W}<em>{L-1}$ matrix, then on $\mathbf{W}</em>{L-2}$ and so on, until the entire operation is completed.</p>

<p>It appears that the entire operation would require $NL= N\log_2N$ complex additions and also $N\log_2N$ complex additions.</p>

<p>However, since $W_N^0 = 1$, $W_N^{N/2}=-1$, and other simplifications, it is estimated that only about half of these, that is, $N\log_2 N$ total complex arithmetic operations are required by the FFT versus the $N^2$ required by the DFT<sup>5</sup>.</p>

<h3 id="decomposition-in-time-fft-algorithm">Decomposition-in-Time FFT Algorithm</h3>

<p>This development follows (Philips, <em>et al.</em>, 2015). It is called the <em>decomposition-in-time (DIT), radix-2, FFT</em>.</p>

<p>It allows us to visualize the FFT as a block diagram (for simulation) or a signal flow graph (for ease of drawing).</p>

<p>We start from a 2-point FFT ($N=2$), and work up to an 8-point FFT ($N=8$) before generalizing the result.</p>

<p>We have implemented each algorithm in Simulink so we are able illustrate these structures with executable examples as we go.</p>

<h4 id="2-point-dft">2-Point DFT</h4>

<script type="math/tex; mode=display">X[k] = \sum_{n=0}^1 x[n]W^{nk}_2 = x[0]W_2^{0k} + X[1]W_2^{1k},\,k=0,1.</script>

<p>Because $W_2^{0k}=\exp\left(j0\right)=1$ and $W_2^{1k}=\exp\left(-j\pi k\right)=(-1)^k$, we write</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{eqnarray*}
X[0] &=& x[0]+x[1];\\
X[1] &=& x[0]-x[1].
\end{eqnarray*} %]]></script>

<p>In general for the 2-point DFT, we have</p>

<script type="math/tex; mode=display">X[k]=x[0]+(-1)^kx[1].</script>

<p><img src="pictures/2-point-dft-sfg.png" alt="Signal flow graph of 2-point DFT" /></p>

<p>An equivalent Simulink model in block diagram form is:</p>

<p><img src="pictures/2-point-dft.png" alt="2-point dft" /></p>

<h4 id="lets-see-it-in-matlab">Letâ€™s See it in MATLAB</h4>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> <span class="n">matlab</span>
<span class="nb">clear</span> <span class="nb">all</span>
<span class="nb">format</span> <span class="n">compact</span>
</code></pre></div></div>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">open</span> <span class="n">two_point_dft</span>
</code></pre></div></div>

<h4 id="4-point-dft">4-point DFT</h4>

<p>The 4-point DFT is given by</p>

<script type="math/tex; mode=display">X[k] = \sum_{n=0}^3 x[n]W_4^{nk}= x[0]W_4^{0k} + x[1]W_4^{1k} + x[2]W_4^{2k} + x[3]W_4^{3k}.</script>

<p>As a result of the periodicity of the weighting factor, we can simplify this expression:</p>

<p>\begin{eqnarray<em>}
W_N^{nk} &amp;=&amp; \exp\left(-j(2\pi/N)nk\right);<br />
W_4^{0k} &amp;=&amp; 1;<br />
W_4^{1k} &amp;=&amp; \exp\left(-j(\pi/2)k\right) = (-j)^k;<br />
W_4^{2k} &amp;=&amp; \exp\left(-j\pi k\right) = (-1)^k;<br />
W_4^{3k} &amp;=&amp; W_4^{2k}W_4^{1k}=(-1)^k W_4^{1k}.
\end{eqnarray</em>}</p>

<p>Using these results, we write</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{eqnarray*}
X[k] &=&  x[0] + x[1]W_4^{1k} + x[2](-1)^k + x[3](-1)^kW_4^{1k},\\
X[k] &=&  \left[x[0] + x[2](-1)^k\right] \left[x[1] +  x[3](-1)^k\right]W_4^{1k}.
\end{eqnarray*} %]]></script>

<p>To clarify the next step, we define two new variables
<script type="math/tex">% <![CDATA[
\begin{eqnarray*}
x_e[n]&=&x[2n],\,n=0,1;\\
x_o[n]&=&x[2n+1],\,n=0,1.
\end{eqnarray*} %]]></script></p>

<p>Then,</p>

<script type="math/tex; mode=display">X[k] =  \left[x_e[0] + x_e[1](-1)^k\right] \left[x_o[0] + x_o[1](-1)^k\right]W_4^{1k}.</script>

<p>The factors in brackets in this equation can be recognized as 2-point DFTs:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{eqnarray*}
X_e[m] &=& x_e[0] + x_e[1](-1)^m,\;m=0,1;\\
X_o[m] &=& x_o[0] + x_o[1](-1)^m,\;m=0,1.
\end{eqnarray*} %]]></script>

<p>Note that $X_e[k]$ and $X_o[k]$ are periodic; for example,</p>

<script type="math/tex; mode=display">X_e[2]= x_e[0]+ x_e[1](-1)^2 = X_e[0]</script>

<p>and</p>

<script type="math/tex; mode=display">X_o[3]= x_o[0]+ x_o[1](-1)^3 = X_o[1]</script>

<p>The 4-point DFT then is</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{eqnarray*}
X[0] &=& X_e[0] + X_o[0]W_4^{1(0)} = X_e[0] + X_o[0];\\
X[1] &=& X_e[1] + X_o[1]W_4^{1(1)} = X_e[0] + X_o[0]W_4^1;\\
X[2] &=& X_e[0] - X_o[0]W_4^{1(2)} = X_e[0] + X_o[0];\\
X[3] &=& X_e[1] - X_o[1]W_4^{1(3)} = X_e[0] + X_o[0]W_4^1.
\end{eqnarray*} %]]></script>

<p>We see that the 4-point DFT can be computed by the generation of two 2-point DFTs, followed by a <em>recomposition</em> of terms as shown in the signal flow graph below:</p>

<p><img src="pictures/4-point-dft-sfg.png" alt="Signal flow graph of 4-point DFT" /></p>

<p>In other words,</p>

<p>[4-point DFT of $x[n]$] = [2-point DFT of $x_e[n]$] + $W_4^{1k}$[2-point DFT of $x_o[n]$].</p>

<h4 id="simulink-model-of-4-point-dft">SIMULINK Model of 4-Point DFT</h4>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">open</span> <span class="n">four_point_dft</span>
</code></pre></div></div>

<h4 id="8-point-dft">8-point DFT</h4>

<script type="math/tex; mode=display">X[k] = \sum_{n=0}^{7}x[n]W_8^{nk}.</script>

<p>After some manipulation, not reproduced here, it can be shown that the 8-point DFT is the recombination of two, 4-point DFTs that operate on the even and odd numbered values in the sequence $x[n]$ respectively.</p>

<h4 id="signal-flow-graph-of-8-point-dft">Signal flow graph of 8-point DFT</h4>

<p><img src="pictures/8-point-dft-sfg.png" alt="Signal flow graph of 8-point DFT" /></p>

<h4 id="simulink-model-of-8-point-dft">SIMULINK Model of 8-Point DFT</h4>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">open</span> <span class="n">eight_point_dft</span>
</code></pre></div></div>

<h4 id="n-point-radix-2-dif-fft">N-Point, radix-2 DIF FFT</h4>

<p>In general, the $N$-point, radix-2 DIT FFT is computed as the recomposition of two $(N/2)$-point FFTs) as shown in the buterfly diagram below</p>

<p><img src="pictures/n-point-fft.png" alt="N-point FFT" /></p>

<h3 id="in-class-example-1">In Class Example 1</h3>

<p>Use four two-point DIT FFT to confirm that the DFT of the sequence</p>

<script type="math/tex; mode=display">x[n] = [1, 2, 3, 4]</script>

<p>is</p>

<script type="math/tex; mode=display">X[m] = [10, -2+j2, -4, -2-j2].</script>

<pre style="border: 2px solid blue">






















</pre>

<h3 id="decomposition-in-frequency-fft">Decomposition-in-Frequency FFT</h3>

<p>Another approach to forming the FFT is the so-called decomposition in frequency (DIF) FFT.</p>

<p>We will not cover itâ€™s development in detail (see Karris and Phillips <em>et al.</em>) if you want to follow it through.</p>

<p>We instead illustrate the final result for the four-point DIF FFT.</p>

<h4 id="signal-flow-graph-for-4-point-dif-fft">Signal flow graph for 4-point DIF FFT</h4>

<p><img src="pictures/4-point-dif-fft.png" alt="Signal flow chart for 4-point DIF FFT" /></p>

<p>Note that the structure is a 4-point decompostion followed by two 2-point FFTs.</p>

<p>Also note that it is frequency $X_n[k]$ that is the input to the DFT stage.</p>

<h4 id="simulink-model-of-8-point-dft-1">SIMULINK Model of 8-Point DFT</h4>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">open</span> <span class="n">four_point_dif</span>

</code></pre></div></div>

<h3 id="in-class-example-2">In Class Example 2</h3>

<p>Use four two-point FIT FFT to confirm that the DFT of the sequence</p>

<script type="math/tex; mode=display">x[n] = [1, 2, 3, 4]</script>

<p>is</p>

<script type="math/tex; mode=display">X[m] = [10, -2+j2, -4, -2-j2].</script>

<pre style="border: 2px solid blue">






















</pre>

<h2 id="efficiency-of-the-fft">Efficiency of the FFT</h2>

<p>Wether we implement it as a Decomposition-in-Time (DIT) or a Decomposition-in-Frequency (DIF), the FFT ends up having approximately $(N/2)\log_2(N)$ multiplications and a similar number of complex additions or subtractions.</p>

<p>In other words, $(N)\log_2(N)$ complex arithmetic operations.</p>

<p>As complex arithmetic, particularly multiplication, is very expensive, this is a great saving over the DFT which has of order $N^2$ operations.</p>

<h3 id="dft-and-fft-comparisons">DFT and FFT Comparisons</h3>

<p>Under the assumptions about the relative efficiency of the DFT and FFT we can create a table like that shown below:</p>

<table>
  <thead>
    <tr>
      <th>Â </th>
      <th>Â </th>
      <th>DFT</th>
      <th>FFT</th>
      <th>FFT/DFT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>N</td>
      <td><script type="math/tex">\log_2 N</script></td>
      <td><script type="math/tex">N^2</script></td>
      <td>$N\log_2 N$</td>
      <td>%</td>
    </tr>
    <tr>
      <td>8</td>
      <td>3</td>
      <td>64</td>
      <td>24</td>
      <td>37.5</td>
    </tr>
    <tr>
      <td>16</td>
      <td>4</td>
      <td>256</td>
      <td>64</td>
      <td>25</td>
    </tr>
    <tr>
      <td>32</td>
      <td>5</td>
      <td>1,024</td>
      <td>160</td>
      <td>15.6</td>
    </tr>
    <tr>
      <td>64</td>
      <td>6</td>
      <td>4,096</td>
      <td>384</td>
      <td>9.4</td>
    </tr>
    <tr>
      <td>128</td>
      <td>7</td>
      <td>16,384</td>
      <td>896</td>
      <td>5.5</td>
    </tr>
    <tr>
      <td>256</td>
      <td>8</td>
      <td>65,536</td>
      <td>2,048</td>
      <td>3.1</td>
    </tr>
    <tr>
      <td>512</td>
      <td>9</td>
      <td>261,144</td>
      <td>4,608</td>
      <td>1.8</td>
    </tr>
    <tr>
      <td>1024</td>
      <td>10</td>
      <td>1,048,576</td>
      <td>10,240</td>
      <td>1</td>
    </tr>
    <tr>
      <td>2048</td>
      <td>11</td>
      <td>4,194,304</td>
      <td>22,528</td>
      <td>0.5</td>
    </tr>
  </tbody>
</table>

<p>As you can see, the efficiency of the FFT actual gets better as the number of samples go up!</p>

<p>However, there are other costs, such as the data storage needed for intermediate steps, that need to be taken into account as well. For example, an 8-point FFT requires only a 3 stage decomposition, with each stage needing storage for 8 complex numbers. That is 24 in all. Whereas a 2048 sequence will require 11 stages, storing 2048 values each. That is a total of 22,528 complex values<sup>6</sup>.</p>

<h2 id="in-class-demonstrations">In Class Demonstrations</h2>

<h3 id="fft-in-matlab">FFT in MATLAB</h3>

<p>The FFT algorithm is implemented, in MATLAB, as the function <code class="highlighter-rouge">fft</code>. We will conclude the class by working through Exercises 6 and 7 from section 10.8 of Karris.</p>

<h3 id="example-3">Example 3</h3>

<p>Plot the Fourier transform of the rectangular pulse shown below, using the MATLAB <code class="highlighter-rouge">fft</code> func-tion. Then, use the <code class="highlighter-rouge">ifft</code> function to verify that the inverse transformation produces the rectangular pulse.</p>

<p><img src="pictures/fft_example1.png" alt="Example 1" /></p>

<h4 id="fft-for-example-3">FFT for Example 3</h4>

<p>The rectangular pulse can be produced like so</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="nb">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span> <span class="nb">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">)];</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">)];</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<p>and the FFT is produced as</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
</code></pre></div></div>

<p>unwind</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">fftshift</span><span class="p">(</span><span class="nb">fft</span><span class="p">(</span><span class="n">y</span><span class="p">))))</span>
</code></pre></div></div>

<p>The inverse FFT is obtained with</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">ifft</span><span class="p">(</span><span class="nb">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
</code></pre></div></div>

<h3 id="example-4">Example 4</h3>

<p><img src="pictures/fft_example2.png" alt="Example 2" /></p>

<h4 id="fft-example-4">FFT Example 4</h4>

<p>The triangular pulse is obtained with</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">);</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">50</span><span class="p">)];</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<p>and the FFT is obtained with</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">fftshift</span><span class="p">(</span><span class="nb">fft</span><span class="p">(</span><span class="n">y</span><span class="p">))))</span>
</code></pre></div></div>

<p>The inverse FFT is obtained with</p>

<div class="language-matlab input_area highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">ifft</span><span class="p">(</span><span class="nb">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
</code></pre></div></div>

<h2 id="summary">Summary</h2>

<ul>
  <li>The inefficiency of the DFT</li>
  <li>The FFT - a sketch of its development</li>
  <li>An illustration of part of the FFT algorithm</li>
  <li>FFT v DFT</li>
  <li>Two examples</li>
</ul>

<h2 id="homework">Homework</h2>

<p>Read the rest of Chapter 10 of Karris from page 10.9 and make your own notes on the implementation of the FFT.</p>

<h2 id="the-end">The End?</h2>

<ul>
  <li>This concludes this module.</li>
  <li>There is some material that I have not covered, most notably is a significant amount of additional information about <strong>Filter Design</strong> (including the use of MATLAB for this) in Chapter 11 of Karris.</li>
</ul>

<h3 id="footnotes">Footnotes</h3>

<ol>
  <li>
    <p><em>Note</em>: addition of two complex numbers $(a + jb) + (c + jd) = (a+b) + j(b + d)$ so requires 2 floating-point additions; multiplication $(a + jb)(c + jd) = (ac - bd)+j(ad + bc)$ requires four floating-point multiplications and two additions.</p>

    <p>In MATLAB, complex numbers are represented internally as two 64 bit floating point operations so each complex operation is expensive both in terms of computing time and working memory space. And the result of an N-point DFT will require twice the memory of the original sequence, assuming that it is stored as floating point real numbers, considerably 16 times the storage is needed if the original sequence is the result of sampling by, say, an 8 bit ADC.</p>

    <p>Of course, modern 64 bit mirocprocessers have hardware support for floating point operations and so these operations take a minumum number of machine cycles. Digital Signal Processors and Graphic Processing Units, probably have hardware support for complex arithmetic too. Nonethess, complex arithmetic is an expensive operation, so any simplifications we can make will be valuable.</p>
  </li>
  <li>
    <p>Even if we do not have a real sequence, we only need to compute the first $N/2$ values of the spectrum because the sequence for $X[k]$ from $N/2 + 1 &lt; k \le N-1$ are complex conjugates, in the reverse order, of the sequence of $X[k]$ for $0 \le k &lt; N/2$. This is easy to prove by looking at the geometry of the unit circle in the z-plane.</p>
  </li>
  <li>
    <p>If $N=1024$, $N\log_2 N = 1024\times 10 = 10,240$ complex operations.</p>
  </li>
  <li>
    <p>The Inverse FFT (IFFT) follows by noting that the rotation vector used in its computation is the complex conjugate
<script type="math/tex">W_N^{-1}.</script></p>
  </li>
  <li>
    <p>Karris goes further in showing how the decomposition used to implement the FFT can be further be understood by considering even and odd decompositions. This is also the approach taken by Phillips <em>et al.</em> reproduced here.
Youâ€™ll also find that most text books on Digital Signal Processing will cover the FFT and give more or less understandable presentations of the way the algorithm works.</p>
  </li>
  <li>
    <p>A complex number in MATLAB is 2 floating point doubles or 128 bits. So a 2048 â€œbinâ€ FFT needs storage in RAM for approximately $22,528\times 128 = 2.9$ Mbit ($260$ kByte) of data.</p>
  </li>
</ol>

<h2 id="solutions">Solutions</h2>

<h3 id="example-1">Example 1</h3>

<p>From the mathematical development and signal flow graph shown earlier:</p>

<p>\begin{eqnarray<em>}
X_e[0] &amp;=&amp; x[0] + x[2] = 1 + 3 = 4;<br />
X_e[1] &amp;=&amp; x[0] - x[2] = 1 - 3 = -2;<br />
X_o[0] &amp;=&amp; x[1] + x[3] = 2 + 4 = 6;<br />
X_o[1] &amp;=&amp; x[1] - x[3] = 2 - 4 = -2.
\end{eqnarray</em>}</p>

<p>Thus,</p>

<p>\begin{eqnarray<em>}
X[0] &amp;=&amp; X_e[0] + X_o[0] = 4 + 6 = 10,<br />
X[1] &amp;=&amp; X_e[1] + W_4^1 X_o[1] = -2 + (-j)(-2) = -2 - j2,<br />
X[2] &amp;=&amp; X_e[0] - X_o[0] = 4 - 6 = -4,<br />
X[3] &amp;=&amp; X_e[1] - W_4^1 X_o[1] = -2 - (-j)(-2) = -2 + j2.
\end{eqnarray</em>}</p>

<p>Q.E.D.</p>

<h3 id="example-2">Example 2</h3>

<p>After decomposition we have:</p>

<p>\begin{eqnarray<em>}
X_1[0] &amp;=&amp; x[0] + x[2] = 1 + 3 = 4;<br />
X_1[1] &amp;=&amp; W_4^0\left[x[1] - x[3]\right] = 2 + 4 = 6;<br />
X_2[0] &amp;=&amp; x[0] - x[2] = 1 - 3 = -2;<br />
X_2[1] &amp;=&amp; W_4^1\left[x[1] - x[3]\right] = -j[2 - 4] = j2.
\end{eqnarray</em>}</p>

<p>Hence, after 2-point FFT:</p>

<p>\begin{eqnarray<em>}
X[0] &amp;=&amp; X_1[0] + X_1[1] = 4 + 6 = 10,<br />
X[1] &amp;=&amp; X_2[0] + X_2[1] = -2 + j2,<br />
X[2] &amp;=&amp; X_1[0] - X_1[1] = 4 - 6 = -4,<br />
X[3] &amp;=&amp; X_2[0] - X_2[1] = -2 - j2.
\end{eqnarray</em>}</p>

<p>Q.E.D.</p>

<h3 id="example-3-1">Example 3</h3>

<p>See script <a href="https://github.com/cpjobling/EG-247-Resources/blob/master/week10/matlab/fft_ex1.m">fft_ex1.m</a>.</p>

<h3 id="example-4-1">Example 4</h3>

<p>See script <a href="https://github.com/cpjobling/EG-247-Resources/blob/master/week10/matlab/fft_ex2.m">fft_ex2.m</a>.</p>

              <nav class="c-page__nav">
  
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/eg-247-textbook/dft/1/dft">
      ã€ˆ <span class="u-margin-right-tiny"></span> The Discrete Fourier Transform
    </a>
  

  
    <a id="js-page__nav__next" class="c-page__nav__next" href="/eg-247-textbook/worksheets/index">
      Worksheets <span class="u-margin-right-tiny"></span> ã€‰
    </a>
  
</nav>

            </div>
          </div>
        </div>
      </main>
    </div>

  </body>
</html>
