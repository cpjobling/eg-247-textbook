

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Unit 7.1: Designing Analogue Filters &#8212; EG-247 Digital Signal Processing</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystyles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'filter_design/analogue_filters';</script>
    <link rel="canonical" href="https://cpjobling.github.io/eg-247-textbook/filter_design/analogue_filters.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Unit 7.2: Designing Digital Filters in MATLAB and Simulink" href="digital_filters.html" />
    <link rel="prev" title="Unit 7: Analogue and Digital Filters" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../introduction/index.html">
  
  
  
  
  
  
    <p class="title logo__title">EG-247 Digital Signal Processing</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../introduction/index.html">
                    Unit 1: Introducing Digital Signal Processing
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Online notes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../transfer_functions/index.html">Transfer Function Analysis of Dynamic Systems</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../transfer_functions/1/concepts.html">Concept Review</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transfer_functions/2/transfer_function_basics.html">Transfer Function Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transfer_functions/3/pole_zero_analysis.html">Pole Zero Analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fourier_series/index.html">Fourier Series</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/1/trig_fseries.html">Trigonometric Fourier Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/2/exp_fs1.html">Exponential Fourier Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/3/exp_fs2.html">Computing Line Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/4/exp_fs3.html">Applications of Line Spectra</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fourier_transform/index.html">Fourier Transform</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/1/ft1.html">Defining the Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/2/ft2.html">Fourier transforms of commonly occuring signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/3/ft3.html">Fourier Transforms for Circuit and LTI Systems Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/4/ft4.html">Introduction to Filters</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dt_systems/index.html">Sampled Data Systems</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../dt_systems/1/sampling.html">Sampling Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dt_systems/2/z_transform.html">The Z-Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dt_systems/3/i_z_transform.html">The Inverse Z-Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dt_systems/4/dt_models.html">Models of Discrete Time Systems</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dft/index.html">Discrete Fourier Transform</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../dft/1/dft.html">The Discrete Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dft/2/fft.html">The Fast-Fourier Transform</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Analogue and Digital Filter Design</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Unit 7.1: Designing Analogue Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="digital_filters.html">Unit 7.2: Designing Digital Filters in MATLAB and Simulink</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../zbib.html">Bibliography</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">In Class Worksheets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../worksheets/index.html">Worksheets</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/worksheet1.html">Worksheet 1 Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/1/worksheet2.html">Worksheet 2 Trigonometric Fourier Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/2/worksheet3.html">Worksheet 3 Exponential Fourier Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/3/worksheet4.html">Worksheet 4 Computing Line Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/4/worksheet5.html">Worksheet 5 Applications of Line Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/1/worksheet6.html">Worksheet 6 Defining the Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/2/worksheet7.html">Worksheet 7 Fourier transforms of commonly occuring signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/3/worksheet8.html">Worksheet 8 Fourier Transforms for Circuit and LTI Systems Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/4/worksheet9.html">Worksheet 9 Introduction to Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dt_systems/3/worksheet10.html">Worksheet 10 The Inverse Z-Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dt_systems/4/worksheet11.html">Worksheet 11 Models of DT Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dft/1/worksheet12.html">Worksheet 12 The Discrete-time Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dft/2/worksheet13.html">Worksheet 13 The Fast Fourier Transform</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Homework problems</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../homework/index.html">Homework</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../homework/hw4.html">Homework 4 Fourier Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/hw5.html">Homework 5 Fourier Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/hw6.html">Homework 6: Fourier Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/hw7.html">Homework 7 Applications of the Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/hw8.html">Homework 8 Sampling Theory and the Z-Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/hw9.html">Homework 9 Inverse Z-Transform and Models of Discrete-Time Systems</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Answers to Selected Problems</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction/answers.html">Worksheet 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../transfer_functions/1/lt_props.html">Properties of the Laplace Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transfer_functions/1/lt_table.html">Common Laplace Transform Pairs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fourier_transform/1/ft_props.html">Properties of the Fourier Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fourier_transform/1/ft_table.html">Common Fourier Transform Pairs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dt_systems/2/zt_props.html">Properties of the Z-Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dt_systems/2/zt_table.html">Table of Z-Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup/polling_setup.html">Set Up In-Class Polling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">List of Planned Enhancements</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../setup/index.html">Setting up your own version of this book</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../transfer_functions/1/LICENSE.html">MathWorks License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/jupyter.html">About Jupyter notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/python.html">Installing Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/setup.html">Setting up your Own Jupyter-MATLAB Computing Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/matlab_kernel.html">Testing the Jupyter Matlab Kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/advanced-setup.html">Quick Start - For Experienced Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/jupyter-book.html">Setting up jupyter-book</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cpjobling/eg-247-textbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cpjobling/eg-247-textbook/edit/master/filter_design/analogue_filters.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cpjobling/eg-247-textbook/issues/new?title=Issue%20on%20page%20%2Ffilter_design/analogue_filters.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/filter_design/analogue_filters.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Unit 7.1: Designing Analogue Filters</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#colophon">Colophon</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scope-and-background-reading">Scope and Background Reading</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#agenda">Agenda</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#low-pass-analogue-filter-prototypes">Low-pass analogue filter prototypes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#magnitude-square-function">Magnitude-square function</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1">Example 1</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#solution">Solution</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#general-form-of-magnitude-square-function">General form of magnitude-square function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-magnitude-square-filter">Analysis of magnitude-square filter</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2">Example 2</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#butterworth-analogue-low-pass-filter-design">Butterworth Analogue Low-Pass Filter Design</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3">Example 3</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Solution</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#designing-butterworth-filters-in-matlab">Designing Butterworth filters in MATLAB</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-4">Example 4</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Solution</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#denormalizing-a-prototype-filter">Denormalizing a prototype filter</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5">Example 5</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Solution</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-the-stop-band-attenuation-in-a-butterworth-filter">Defining the stop-band attenuation in a Butterworth filter</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chebyshev-type-i-analogue-low-pass-filter-design">Chebyshev Type I Analogue Low-Pass Filter Design</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-6">Example 6</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chebyshev-type-ii-analogue-low-pass-filter-design">Chebyshev Type II Analogue Low-Pass Filter Design</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-7">Example 7</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#elliptic-analogue-low-pass-filter-design">Elliptic Analogue Low-Pass Filter Design</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-8">Example 8</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-of-analogue-low-pass-filter-designs">Comparison of analogue low-pass filter designs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advantages-and-disadvantages-of-different-types-of-filters">Advantages and disadvantages of different types of filters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#high-pass-band-pass-and-band-elimination-filter-design">High-Pass, Band-Pass and Band-Elimination Filter Design</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#low-pass-to-low-pass">Low-pass to low-pass</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#low-pass-to-high-pass">Low-pass to high-pass</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-9">Example 9</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#low-pass-to-band-pass">Low-pass to band-pass</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-10">Example 10</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#low-pass-to-band-stop">Low-pass to band-stop</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-11">Example 11</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Low-pass to band-pass</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-7-1-summary">Unit 7.1 Summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-7-1-takeaways">Unit 7.1 Takeaways</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coming-next">Coming Next</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matlab-functions-introduced-in-unit-7-1">MATLAB functions introduced in Unit 7.1</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analogue-prototype-designers">Analogue prototype designers</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-transformation-functions">Filter transformation functions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#utility-functions">Utility functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#footnotes">Footnotes</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="unit-7-1-designing-analogue-filters">
<span id="unit7-1"></span><h1>Unit 7.1: Designing Analogue Filters<a class="headerlink" href="#unit-7-1-designing-analogue-filters" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">format</span><span class="w"> </span><span class="n">compact</span>
<span class="nb">cd</span><span class="w"> </span><span class="n">matlab</span>
</pre></div>
</div>
</div>
</div>
<section id="colophon">
<h2>Colophon<a class="headerlink" href="#colophon" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>The source code for this page is <a class="reference external" href="https://github.com/cpjobling/eg-247-textbook/blob/master/filter_design/analogue_filters.md">filter_design/analogue_filters.md</a>.</p></li>
<li><p>You can view the notes for this presentation as a webpage (<a class="reference external" href="https://cpjobling.github.io/eg-247-textbook/filter_design/analogue_filters.html">HTML</a>).</p></li>
<li><p>This page is downloadable as a <a class="reference external" href="https://cpjobling.github.io/eg-247-textbook/filter_design/analogue_filters.pdf">PDF</a> file.</p></li>
</ul>
</section>
<section id="scope-and-background-reading">
<h2>Scope and Background Reading<a class="headerlink" href="#scope-and-background-reading" title="Permalink to this heading">#</a></h2>
<p>We introduced the idea of filters in <a class="reference internal" href="../fourier_transform/4/ft4.html#ft4"><span class="std std-ref">Unit 4.4: Introduction to Filters</span></a> and examined in some detail the idea of an ideal low-pass filter and an approximation to the ideal filter known and the <em>Butterworth</em> filter. We also showed how a high-pass filter, stop-band filter and and pass-band filter could be implemented by simple manipulations of the frequency response (or transfer functions) of a low-pass filter.</p>
<p>An advantage of the Butterworth filter is that it has a flat response in the pass band, a consistent attenuation of -3 dB at the cut-off frequency, and a steady roll-off in the stop band. A disadvantage is that you need a high-order filter to get a fast transition between the pass-band and the stop-band.</p>
<p>In <a class="reference internal" href="../dt_systems/4/dt_models.html#demo"><span class="std std-ref">Example: Digital Butterworth Filter</span></a>, we showed how an analogue 2nd-order Butterworth filter could be translated into a discrete-time (DT) system using the MATLAB function <code class="docutils literal notranslate"><span class="pre">c2d</span></code>, and we demonstrated the architecture and code that might be used to implement the digital filter.</p>
<p>In this unit we will explore further some of the concepts of what is called <em>filter design by analogue prototype</em>. This Unit is based on Chapter 11 of <span id="id1">[<a class="reference internal" href="../zbib.html#id7" title="Steven T. Karris. Signals and systems with MATLAB computing and Simulink modeling. Orchard Publishing, Fremont, CA., fifth edition, 2012. ISBN 9781934404232. Library call number: TK5102.9 K37 2012 LOCATE. URL: https://ebookcentral.proquest.com/lib/swansea-ebooks/detail.action?docID=3384197&amp;pq-origsite=primo.">Karris, 2012</a>]</span>. We will illustrate the concepts using MATLAB and Simulink as appropriate on the understanding that <strong>you should be able to recognize the filter type from a frequency response</strong>.</p>
</section>
<section id="agenda">
<h2>Agenda<a class="headerlink" href="#agenda" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#unit7-1-introduction"><span class="std std-ref">Introduction</span></a></p></li>
<li><p><a class="reference internal" href="#unit7-1-afp"><span class="std std-ref">Low-pass analogue filter prototypes</span></a></p>
<ul>
<li><p><a class="reference internal" href="#unit7-1-msf"><span class="std std-ref">Magnitude-square function</span></a></p></li>
<li><p><a class="reference internal" href="#unit7-1-butter"><span class="std std-ref">Butterworth Analogue Low-Pass Filter Design</span></a></p></li>
<li><p><a class="reference internal" href="#unit7-1-cheby1"><span class="std std-ref">Chebyshev Type I Analogue Low-Pass Filter Design</span></a></p></li>
<li><p><a class="reference internal" href="#unit7-1-cheby2"><span class="std std-ref">Chebyshev Type II Analogue Low-Pass Filter Design</span></a></p></li>
<li><p><a class="reference internal" href="#unit7-1-ellip"><span class="std std-ref">Elliptic Analogue Low-Pass Filter Design</span></a></p></li>
<li><p><a class="reference internal" href="#unit7-1-comparison"><span class="std std-ref">Comparison of analogue low-pass filter designs</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#unit7-1-other"><span class="std std-ref">High-Pass, Band-Pass and Band-Elimination Filter Design</span></a></p></li>
</ul>
</section>
<section id="introduction">
<span id="unit7-1-introduction"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p><strong>Analogue filters</strong> are defined in continuous range of frequencies. They are classified as <em>low-pass</em>, <em>high-pass</em>, <em>band-pass</em> and <em>band-elimination</em> (<em>band-stop</em>) filters.</p>
<p>The ideal magnitude characteristics of each are illustrated in <a class="reference internal" href="#fig-7-1-mag-chars"><span class="std std-numref">Fig. 11</span></a></p>
<figure class="align-default" id="fig-7-1-mag-chars">
<a class="reference internal image-reference" href="../_images/mag_chars.png"><img alt="illustration of the magnitude characteristics of ideal filters" src="../_images/mag_chars.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Magnitude characteristics of ideal filters (reproduced from Figure 11.1 <span id="id2">[<a class="reference internal" href="../zbib.html#id7" title="Steven T. Karris. Signals and systems with MATLAB computing and Simulink modeling. Orchard Publishing, Fremont, CA., fifth edition, 2012. ISBN 9781934404232. Library call number: TK5102.9 K37 2012 LOCATE. URL: https://ebookcentral.proquest.com/lib/swansea-ebooks/detail.action?docID=3384197&amp;pq-origsite=primo.">Karris, 2012</a>]</span>).</span><a class="headerlink" href="#fig-7-1-mag-chars" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>As we saw in <a class="reference internal" href="../fourier_transform/4/ft4.html#ft4-ideal-lp-filter"><span class="std std-ref">Ideal Low-Pass Filter (LPF)</span></a>, filters with ideal characteristics are not physically realizable (they are not <em>causal</em> systems). Instead we design practical filters that approximate these characteristics.</p>
<p>A <strong>digital filter</strong>, in general, is a computational process, or algorithm, that converts one sequence of numbers representing the input signal into another sequence of numbers representing the output signal.</p>
<p>Analogue filter functions have been used extensively as prototype models for designing digital filters, and that is the approach we will present here.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In Section 11.2 of <span id="id3">Karris [<a class="reference internal" href="../zbib.html#id7" title="Steven T. Karris. Signals and systems with MATLAB computing and Simulink modeling. Orchard Publishing, Fremont, CA., fifth edition, 2012. ISBN 9781934404232. Library call number: TK5102.9 K37 2012 LOCATE. URL: https://ebookcentral.proquest.com/lib/swansea-ebooks/detail.action?docID=3384197&amp;pq-origsite=primo.">2012</a>]</span> examples of analogue low-pass and high-pass filters made from RC circuits and band-pass and stop band filters made from RLC circuits are given. We will pass over these as our interest is in digital filters, and in any case, filters made from passive components are only practical in a limited range of applications. Instead, we will look at the idea of analogue filter porotypes.</p>
</div>
</section>
<section id="low-pass-analogue-filter-prototypes">
<span id="unit7-1-afp"></span><h2>Low-pass analogue filter prototypes<a class="headerlink" href="#low-pass-analogue-filter-prototypes" title="Permalink to this heading">#</a></h2>
<p>In this section, we will use the analogue low-pass filter as a basis. Using transformations, we can derive high-pass and other types of filter from the low-pass filter.</p>
<p>We will discuss the <em>Butterworth</em>, <em>Chebyshev Type I</em>, <em>Chebyshev Type II</em> and <em>Elliptic</em> filters.</p>
<p>As through MATLAB and the Signal Processing Toolbox, we have access to sophisticated design tools, we will gloss over some of the mathematical details. If you are interested in such detail, please refer to Section 11.3 and following sections of <span id="id4">[<a class="reference internal" href="../zbib.html#id7" title="Steven T. Karris. Signals and systems with MATLAB computing and Simulink modeling. Orchard Publishing, Fremont, CA., fifth edition, 2012. ISBN 9781934404232. Library call number: TK5102.9 K37 2012 LOCATE. URL: https://ebookcentral.proquest.com/lib/swansea-ebooks/detail.action?docID=3384197&amp;pq-origsite=primo.">Karris, 2012</a>]</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>From the point of view of assessment, you are only required to be able to recognise the filter types presented here and their key properties. Although you can design a filter of virtually any order, we will limit ourselves to second-order filters and provide the actual transfer function coefficients that you need to be able to convert the analogue filter into a digital filter using the <em>bilinear transform</em>. If you need access to the filter formulae, you will be given them in the question.</p>
</div>
<section id="magnitude-square-function">
<span id="unit7-1-msf"></span><h3>Magnitude-square function<a class="headerlink" href="#magnitude-square-function" title="Permalink to this heading">#</a></h3>
<p>To facilitate the design of filters we use a so-called <em>magnitude-squared function</em><a class="footnote-reference brackets" href="#u71-note1" id="id5">1</a> <span class="math notranslate nohighlight">\(A^2(\omega)\)</span>, and from it derive a <span class="math notranslate nohighlight">\(G(s)\)</span> function such that</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-1">
<span class="eqno">(16)<a class="headerlink" href="#equation-eq-7-1-1" title="Permalink to this equation">#</a></span>\[A^2(\omega) = \left.G(s).G(-s)\right|_{s = j\omega}\]</div>
<p>Since <span class="math notranslate nohighlight">\((j\omega)^* = (-j\omega)\)</span>, the square of a complex number can be expressed as that complex number and its complex conjugate. Thus, if the magnitude is <span class="math notranslate nohighlight">\(A\)</span>, then</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-2">
<span class="eqno">(17)<a class="headerlink" href="#equation-eq-7-1-2" title="Permalink to this equation">#</a></span>\[A^2(\omega) = \left|G(j\omega)\right| = G(j\omega)G^*(j\omega) = G(j\omega).G(-j\omega)\]</div>
<p>Now, <span class="math notranslate nohighlight">\(G(j\omega)\)</span> can be considered as <span class="math notranslate nohighlight">\(G(s)\)</span> evaluated at <span class="math notranslate nohighlight">\(s = j\omega\)</span>, and this <a class="reference internal" href="#equation-eq-7-1-1">(16)</a> is justified.</p>
<p>Also, since <span class="math notranslate nohighlight">\(A\)</span> is understood to represent the magnitude, it does not need to be enclosed in vertical lines.</p>
<p>Not all magnitude-square functions can be decomposed to <span class="math notranslate nohighlight">\(G(s)\)</span> and <span class="math notranslate nohighlight">\(G(-s)\)</span> rational functions; only even functions of <span class="math notranslate nohighlight">\(\omega\)</span>, positive for all <span class="math notranslate nohighlight">\(\omega\)</span>, and <em>proper-rational functions</em><a class="footnote-reference brackets" href="#u71-note2" id="id6">2</a> can satisfy <a class="reference internal" href="#equation-eq-7-1-1">(16)</a>.</p>
<section id="example-1">
<span id="unut7-1-ex1"></span><h4>Example 1<a class="headerlink" href="#example-1" title="Permalink to this heading">#</a></h4>
<p>It is known that</p>
<div class="math notranslate nohighlight">
\[G(s) = \frac{3s^2 + 5s + 7}{s^2 + 4s + 6} \]</div>
<p>Compute <span class="math notranslate nohighlight">\(A^2(\omega)\)</span>.</p>
<section id="solution">
<h5>Solution<a class="headerlink" href="#solution" title="Permalink to this heading">#</a></h5>
<p>Since</p>
<div class="math notranslate nohighlight">
\[G(s) = \frac{3s^2 + 5s + 7}{s^2 + 4s + 6} \]</div>
<p>it follows that</p>
<div class="math notranslate nohighlight">
\[G(-s) = \frac{3s^2 - 5s + 7}{s^2 - 4s + 6} \]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[G(s).G(-s) = \frac{3s^2 + 5s + 7}{s^2 + 4s + 6}.\frac{3s^2 - 5s + 7}{s^2 - 4s + 6} = \frac{9s^4 + 17s^2 + 49}{s^4 - 4s^2 + 36}  \]</div>
<p>Therefore</p>
<div class="math notranslate nohighlight">
\[A^2(\omega) = \left.\frac{9s^4 + 17s^2 + 49}{s^4 - 4s^s + 36}\right|_{s = j\omega} = \frac{9\omega^4 - 17\omega^2 + 49}{\omega^4 + 4\omega^2 + 36}\]</div>
</section>
</section>
<section id="general-form-of-magnitude-square-function">
<h4>General form of magnitude-square function<a class="headerlink" href="#general-form-of-magnitude-square-function" title="Permalink to this heading">#</a></h4>
<p>The general form of magnitude-square function <span class="math notranslate nohighlight">\(A^2(\omega)\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-3">
<span class="eqno">(18)<a class="headerlink" href="#equation-eq-7-1-3" title="Permalink to this equation">#</a></span>\[A^2(\omega) = \frac{C\left(b_k\omega^{2k}+b_{k-1}\omega^{2k-2}+\cdots+ b_0\right)}{a_k\omega^{2k}+a_{k-1}\omega^{2k-2}+\cdots+ a_0} \]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is the DC gain, <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are constant coefficients, and <span class="math notranslate nohighlight">\(k\)</span> is a positive integer denoting the order of the filter.</p>
<p>Once the magnitude-square function <span class="math notranslate nohighlight">\(A^2(\omega)\)</span> is known, we can derive <span class="math notranslate nohighlight">\(G(s)\)</span> from <a class="reference internal" href="#equation-eq-7-1-1">(16)</a> with the substitution <span class="math notranslate nohighlight">\(\left(j\omega\right)^2 = -\omega^2 = - s^2\)</span>,</p>
<p>that is</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-4">
<span class="eqno">(19)<a class="headerlink" href="#equation-eq-7-1-4" title="Permalink to this equation">#</a></span>\[G(s).G(-s) = \left. A^2(\omega)\right|_{\omega^2 = -s^2}\]</div>
</section>
<section id="analysis-of-magnitude-square-filter">
<h4>Analysis of magnitude-square filter<a class="headerlink" href="#analysis-of-magnitude-square-filter" title="Permalink to this heading">#</a></h4>
<p>In the simplest low-pass filter, the DC gain of the magnitude-square function is unity. In this case <a class="reference internal" href="#equation-eq-7-1-3">(18)</a> reduces to</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-5">
<span class="eqno">(20)<a class="headerlink" href="#equation-eq-7-1-5" title="Permalink to this equation">#</a></span>\[A^2(\omega) = \frac{b_0}{a_k\omega^{2k}+a_{k-1}\omega^{2k-2}+\cdots+ a_0} \]</div>
<p>and at high frequencies (i.e. in the stop-band) can be approximated as</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-6">
<span class="eqno">(21)<a class="headerlink" href="#equation-eq-7-1-6" title="Permalink to this equation">#</a></span>\[A^2(\omega) = \frac{b_0/a_k}{\omega^{2k}} \]</div>
<p>The <em>attenuation rate</em> of this approximation is <span class="math notranslate nohighlight">\(20k\)</span> dB/decade.</p>
</section>
<section id="example-2">
<span id="unit7-1-ex2"></span><h4>Example 2<a class="headerlink" href="#example-2" title="Permalink to this heading">#</a></h4>
<p>Given the magnitude-square function</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-7">
<span class="eqno">(22)<a class="headerlink" href="#equation-eq-7-1-7" title="Permalink to this equation">#</a></span>\[A^2(\omega) = \frac{16\left(-\omega^2 + 1\right)}{\left(\omega^2+4\right)\left(\omega^2+ 9\right)}\]</div>
<p>derive a suitable transfer function <span class="math notranslate nohighlight">\(G(s)\)</span>.</p>
<section id="id7">
<h5>Solution<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h5>
<p>From relation <a class="reference internal" href="#equation-eq-7-1-4">(19)</a></p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-8">
<span class="eqno">(23)<a class="headerlink" href="#equation-eq-7-1-8" title="Permalink to this equation">#</a></span>\[G(s).G(-s) = \left. A^2(\omega)\right|_{\omega^2 = -s^2} = \frac{16\left(s^2 + 1\right)}{\left(-s^2 + 4\right)\left(-s^2 + 9\right)} \]</div>
<p>This function has zeros at <span class="math notranslate nohighlight">\(s = \pm j\)</span>, and poles at <span class="math notranslate nohighlight">\(s = \pm 2\)</span> and <span class="math notranslate nohighlight">\(s = \pm 3\)</span>.</p>
<p>There is no restriction on the zeros, but for stability<a class="footnote-reference brackets" href="#u71-note3" id="id8">3</a>, we select the left-half <span class="math notranslate nohighlight">\(s\)</span>-plane poles.</p>
<p>Let</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-9">
<span class="eqno">(24)<a class="headerlink" href="#equation-eq-7-1-9" title="Permalink to this equation">#</a></span>\[G(s) = \frac{K\left(s^2 + 1\right)}{\left(s + 2\right)\left(s+3\right)} \]</div>
<p>We must find <span class="math notranslate nohighlight">\(K\)</span> such that <span class="math notranslate nohighlight">\(G(0) = A(0)\)</span>. From <a class="reference internal" href="#equation-eq-7-1-7">(22)</a></p>
<div class="math notranslate nohighlight">
\[A^2(0) = 16/36 = 4/9\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[A(0) = 2/3\]</div>
<p>From <a class="reference internal" href="#equation-eq-7-1-9">(24)</a>,</p>
<div class="math notranslate nohighlight">
\[G(0) = K/6\]</div>
<p>and for <span class="math notranslate nohighlight">\(G(0) = A(0)\)</span> we must have,</p>
<div class="math notranslate nohighlight">
\[K/6 = 2/3\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[K = 12/3 = 4\]</div>
<p>By subsitution into <a class="reference internal" href="#equation-eq-7-1-9">(24)</a>, we obtain</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-10a">
<span class="eqno">(25)<a class="headerlink" href="#equation-eq-7-1-10a" title="Permalink to this equation">#</a></span>\[G(s) = \frac{4\left(s^2 + 1\right)}{\left(s + 2\right)\left(s+3\right)} \]</div>
</section>
</section>
</section>
<section id="butterworth-analogue-low-pass-filter-design">
<span id="unit7-1-butter"></span><h3>Butterworth Analogue Low-Pass Filter Design<a class="headerlink" href="#butterworth-analogue-low-pass-filter-design" title="Permalink to this heading">#</a></h3>
<p>Consider the <em>Butterworth low-pass filter</em><a class="footnote-reference brackets" href="#u71-note5" id="id9">4</a> whose magnitude-squared function is</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-10">
<span class="eqno">(26)<a class="headerlink" href="#equation-eq-7-1-10" title="Permalink to this equation">#</a></span>\[A^2(\omega) = \frac{1}{\left(\omega/\omega_c\right)^{2k}+1} \]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> is a positive integer, and <span class="math notranslate nohighlight">\(\omega_c\)</span> is the cutoff (-3 dB) frequency.</p>
<p>We can use MATLAB to plot the frequency response of this relation for <span class="math notranslate nohighlight">\(k = 1,2,4,8\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">w_w0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="mf">0.02</span><span class="p">:</span><span class="mi">3</span><span class="p">;</span><span class="w"> </span>
<span class="n">Aw2k1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">w_w0</span><span class="o">.^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w"> </span><span class="n">Aw2k2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">w_w0</span><span class="o">.^</span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="n">Aw2k4</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">w_w0</span><span class="o">.^</span><span class="mi">8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span><span class="w"> </span><span class="n">Aw2k8</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">w_w0</span><span class="o">.^</span><span class="mi">16</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="nb">plot</span><span class="p">(</span><span class="n">w_w0</span><span class="p">,</span><span class="n">Aw2k1</span><span class="p">,</span><span class="n">w_w0</span><span class="p">,</span><span class="n">Aw2k2</span><span class="p">,</span><span class="n">w_w0</span><span class="p">,</span><span class="n">Aw2k4</span><span class="p">,</span><span class="n">w_w0</span><span class="p">,</span><span class="n">Aw2k8</span><span class="p">),</span><span class="nb">grid</span><span class="w"> </span><span class="n">on</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Normalized Frequency Ratio (ratio of actual to cut-off)&#39;</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude A (square root of A^2(omega))&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Butterworh Analogue Low-Pass Filter characteristics for k = 1, 2, 4 and 8&#39;</span><span class="p">)</span>
<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;k=1&#39;</span><span class="p">,</span><span class="s">&#39;k=2&#39;</span><span class="p">,</span><span class="s">&#39;k=4&#39;</span><span class="p">,</span><span class="s">&#39;k=8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e4a934df616438a55eeaf477af0ab03ed2e35fdf964b42c90f432dd27f6d994b.png" src="../_images/e4a934df616438a55eeaf477af0ab03ed2e35fdf964b42c90f432dd27f6d994b.png" />
</div>
</div>
<p>All Butterworth filters have the property that all poles of the transfer function that describes them lie on the circumference of a circle with radius <span class="math notranslate nohighlight">\(\omega_c\)</span>, and they are <span class="math notranslate nohighlight">\(2\pi/2k\)</span> radians apart. Thus, if <span class="math notranslate nohighlight">\(k\)</span> is odd, the poles start at zero radians, and if <span class="math notranslate nohighlight">\(k\)</span> is even, they start at <span class="math notranslate nohighlight">\(2\pi/2k\)</span> radians. But regardless wether <span class="math notranslate nohighlight">\(k\)</span> is odd or even, the poles are distributed with symmetry with respect to the <span class="math notranslate nohighlight">\(j\omega\)</span> axis. For stability, we chose the left half-plave poles to form <span class="math notranslate nohighlight">\(G(s)\)</span>.</p>
<p>We can find the nth roots of the complex number <span class="math notranslate nohighlight">\(s\)</span> by <em>De Moirvres theorem</em>. This states that</p>
<div class="math notranslate nohighlight">
\[\sqrt[n]{r e^{j\theta}} = \sqrt[n]{r} {e}^{j\left(\frac{\theta + 2k\pi}{N} \right)}\,k=1,\pm 1,\pm 2,\ldots\]</div>
<section id="example-3">
<span id="unit7-1-ex3"></span><h4>Example 3<a class="headerlink" href="#example-3" title="Permalink to this heading">#</a></h4>
<p>Derive the transfer function <span class="math notranslate nohighlight">\(G(s)\)</span> for the third-order (<span class="math notranslate nohighlight">\(k=3\)</span>) Butterworth low-pass filter with <em>normalized cut-off frequency</em> <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> rad/s.</p>
<section id="id10">
<h5>Solution<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h5>
<p>With <span class="math notranslate nohighlight">\(k = 3\)</span> and <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> rad/s, <a class="reference internal" href="#equation-eq-7-1-10">(26)</a> simplifies to</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-11">
<span class="eqno">(27)<a class="headerlink" href="#equation-eq-7-1-11" title="Permalink to this equation">#</a></span>\[A^2(\omega) = \frac{1}{\omega^6 + 1} \]</div>
<p>With the substitution <span class="math notranslate nohighlight">\(\omega^2 = -s^2\)</span>, <a class="reference internal" href="#equation-eq-7-1-10">(26)</a> becomes</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-12">
<span class="eqno">(28)<a class="headerlink" href="#equation-eq-7-1-12" title="Permalink to this equation">#</a></span>\[G(s).G(-s) = \frac{1}{-s^6 + 1} \]</div>
<p>The poles of <a class="reference internal" href="#equation-eq-7-1-12">(28)</a> are given by <span class="math notranslate nohighlight">\(\left(1 - s^6\right) = 0\)</span>  or <span class="math notranslate nohighlight">\(s = \sqrt[6]{1}\)</span>.</p>
<p>That is, <span class="math notranslate nohighlight">\(s = \sqrt[6]{1}\angle 0 ^\circ\)</span> and, by De Moivres theorem, with <span class="math notranslate nohighlight">\(n = 6\)</span>,</p>
<div class="math notranslate nohighlight">
\[\sqrt[6]{1e^{j0}} = \sqrt[6]{1}e^{j\left(\frac{0 + 2k\pi}{6} \right)},\,k=0,1,2,3,4,5\]</div>
<p>Thus</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{lll}
s_1 = 1\angle 0^\circ &amp; s_2 = 1\angle 60^\circ = \frac{1}{2} + j\frac{\sqrt{3}}{2} &amp; s_3 = 1\angle 120^\circ = -\frac{1}{2} + j\frac{\sqrt{3}}{2} \\
s_4 = 1\angle 180^\circ = -1 &amp;  s_5 = 1\angle 240^\circ = -\frac{1}{2} - j\frac{\sqrt{3}}{2} &amp; s_6 = 1\angle 300^\circ = \frac{1}{2} - j\frac{\sqrt{3}}{2}
\end{array}
\end{split}\]</div>
<p>As expected, these six poles lie on the circumference of the circle with radius <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> as shown in <a class="reference internal" href="#fig-7-1-2"><span class="std std-numref">Fig. 12</span></a>.</p>
<figure class="align-default" id="fig-7-1-2">
<a class="reference internal image-reference" href="../_images/butter6.png"><img alt="Location of the poles for the transfer function for the transfer function of Example 3" src="../_images/butter6.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">Location of the poles for the transfer function for the transfer function of Example 3</span><a class="headerlink" href="#fig-7-1-2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The transfer function <span class="math notranslate nohighlight">\(G(s)\)</span> is formed with the left half-plane poles <span class="math notranslate nohighlight">\(s_3\)</span>, <span class="math notranslate nohighlight">\(s_4\)</span> and <span class="math notranslate nohighlight">\(s_5\)</span>. Then</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-13">
<span class="eqno">(29)<a class="headerlink" href="#equation-eq-7-1-13" title="Permalink to this equation">#</a></span>\[G(s) = \frac{K}{\left(s + 1\right)\left(s + \frac{1}{2} -j\frac{\sqrt{3}}{2}\right)\left(s + \frac{1}{2} +j\frac{\sqrt{3}}{2}\right)} \]</div>
<p>We use MATLAB to express the denominator as a polynomial</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">syms</span><span class="w"> </span><span class="s">s</span><span class="p">;</span><span class="w"> </span><span class="n">den</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nb">j</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">j</span><span class="o">*</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>den =
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(s + 1)*(s - (3^(1/2)*1i)/2 + 1/2)*(s + (3^(1/2)*1i)/2 + 1/2)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">expand</span><span class="p">(</span><span class="n">den</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans =
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>s^3 + 2*s^2 + 2*s + 1
</pre></div>
</div>
</div>
</div>
<p>Therefore <a class="reference internal" href="#equation-eq-7-1-12">(28)</a> simplifies to</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-14">
<span class="eqno">(30)<a class="headerlink" href="#equation-eq-7-1-14" title="Permalink to this equation">#</a></span>\[G(s) = \frac{K}{s^3 + 2s^2 + 2s + 1} \]</div>
<p>The gain <span class="math notranslate nohighlight">\(K\)</span> is found from <span class="math notranslate nohighlight">\(A^2(0) = 1\)</span> and <span class="math notranslate nohighlight">\(G(0) = K\)</span>. Thus, K = 1 and</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-15">
<span class="eqno">(33)<a class="headerlink" href="#equation-eq-7-1-15" title="Permalink to this equation">#</a></span>\[G(s) = \frac{1}{s^3 + 2s^2 + 2s + 1} \]</div>
<p>The generalized form of any analogue low-pass filter (Butterworth, Chebyshev, Elliptic, etc) is</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-16">
<span class="eqno">(34)<a class="headerlink" href="#equation-eq-7-1-16" title="Permalink to this equation">#</a></span>\[\left.G(s)\right|_{\mathrm{lp}} = \frac{b_0}{a_ks^k + \cdots a_2 s^2 + a_1 s + a_0} \]</div>
<p>The pole locations and coefficients of the corresponding denominator polynomials have been derived and tabulated and easily found on the internet: for example <a class="reference external" href="https://en.wikipedia.org/wiki/Butterworth_filter#Normalized_Butterworth_polynomials">Normalized Butterworth polynomials</a> in Wikipedia.</p>
<p>For brevity, we will not reproduce these tables here.</p>
</section>
</section>
<section id="designing-butterworth-filters-in-matlab">
<h4>Designing Butterworth filters in MATLAB<a class="headerlink" href="#designing-butterworth-filters-in-matlab" title="Permalink to this heading">#</a></h4>
<p>The MATLAB functions <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/buttap.html"><code class="docutils literal notranslate"><span class="pre">buttap</span></code></a> and <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/zp2tf.html"><code class="docutils literal notranslate"><span class="pre">zp2tf</span></code></a> can also be used to derive the coefficients.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">buttap</span></code> function returns the zeros, poles and gain for an Nth order normalized prototyoe Butterworth low-pass filter. The resulting filter has <span class="math notranslate nohighlight">\(N\)</span> poles around the unit circle in the left half plane, and no zeros. The <code class="docutils literal notranslate"><span class="pre">zp2tf</span></code> function performs the zero-pole-gain to transfer function conversion.</p>
</section>
<section id="example-4">
<span id="unit7-1-ex4"></span><h4>Example 4<a class="headerlink" href="#example-4" title="Permalink to this heading">#</a></h4>
<p>Use MATLAB to derive the numerator <code class="docutils literal notranslate"><span class="pre">b</span></code> and denominator <code class="docutils literal notranslate"><span class="pre">a</span></code> coefficients for the third-order Butterworth low-pass filter prototype with normalized cutoff frequency. Plot the Bode plot of the filter.</p>
<section id="id11">
<h5>Solution<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttap</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w"> </span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">zp2tf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b =
         0         0         0    1.0000
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a =
    1.0000    2.0000    2.0000    1.0000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">tf</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
<span class="n">bode</span><span class="p">(</span><span class="n">G</span><span class="p">),</span><span class="w"> </span><span class="nb">grid</span><span class="w"> </span><span class="n">on</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Bode diagram for a 3rd order Butterworth filter with wc = 1 rad/s&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>G =
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>            1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ---------------------
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  s^3 + 2 s^2 + 2 s + 1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Continuous-time transfer function.
</pre></div>
</div>
<img alt="../_images/7106deda113492cee3b06fdda733cca1fe3698d431f64945b2f61c561bd3b8cd.png" src="../_images/7106deda113492cee3b06fdda733cca1fe3698d431f64945b2f61c561bd3b8cd.png" />
</div>
</div>
<p>Note that the roll-off is -60 dB/decade above the normalized cut-off <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> rad/s. Also note that the phase changes fron <span class="math notranslate nohighlight">\(0^\circ\)</span> to <span class="math notranslate nohighlight">\(-270^\circ\)</span> from low to high frequency.</p>
</section>
</section>
<section id="denormalizing-a-prototype-filter">
<span id="unit6-1-denormalize"></span><h4>Denormalizing a prototype filter<a class="headerlink" href="#denormalizing-a-prototype-filter" title="Permalink to this heading">#</a></h4>
<p>The examples given so far, and the MATLAB function <code class="docutils literal notranslate"><span class="pre">buttap</span></code> (and the others we will meet later) give the coefficents assuming that the cut-off frequency <span class="math notranslate nohighlight">\(\omega_c\)</span> is 1 rad/s. To <em>denormalize</em> the filter coefficients, we need to change the radius of the circle shown e.g in <a class="reference internal" href="#fig-7-1-2"><span class="std std-numref">Fig. 12</span></a> from <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> to <span class="math notranslate nohighlight">\(\omega_c = \omega_\mathrm{actual}\)</span> .</p>
<p>To do this we make the subsitution</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-15">
<span class="eqno">(33)<a class="headerlink" href="#equation-eq-7-1-15" title="Permalink to this equation">#</a></span>\[G(s)_\mathrm{actual} = G\left(\frac{s}{\omega_\mathrm{actual}} \right) \]</div>
<p>As you might expect, MATLAB provides a function for that: <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/lp2lp.html"><code class="docutils literal notranslate"><span class="pre">lp2lp</span></code></a>.</p>
</section>
<section id="example-5">
<span id="unit7-1-ex5"></span><h4>Example 5<a class="headerlink" href="#example-5" title="Permalink to this heading">#</a></h4>
<p>Redesign the filter designed in <a class="reference internal" href="#unit7-1-ex4"><span class="std std-ref">Example 4</span></a> so that it has a a cut-off frequency of <span class="math notranslate nohighlight">\(1\)</span> kHz.</p>
<section id="id12">
<h5>Solution<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttap</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w"> </span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">zp2tf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">);</span>
<span class="n">fc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">1e3</span><span class="p">;</span><span class="w"> </span><span class="c">% 1 kHz</span>
<span class="n">wc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">fc</span><span class="p">;</span><span class="w"> </span><span class="c">% rad/s</span>
<span class="nb">format</span><span class="w"> </span><span class="n">long</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">lp2lp</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">wc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b =
     2.480502134423985e+11
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a =
   1.0e+11 *
  Columns 1 through 3
   0.000000000010000   0.000000125663706   0.000789568352087
  Column 4
   2.480502134423986
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bodeplot</span><span class="p">(</span><span class="n">tf</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">));</span><span class="w"> </span><span class="n">setoptions</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="s">&#39;FreqUnits&#39;</span><span class="p">,</span><span class="s">&#39;kHz&#39;</span><span class="p">),</span><span class="nb">grid</span><span class="w"> </span><span class="n">on</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Butterworth 3rd Order Low-Pass Filter: fc = 1 kHz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b44048415e05cffe06d9a46b44624b3d891d3c0dfe240d57945795ba2dbebd82.png" src="../_images/b44048415e05cffe06d9a46b44624b3d891d3c0dfe240d57945795ba2dbebd82.png" />
</div>
</div>
</section>
</section>
<section id="defining-the-stop-band-attenuation-in-a-butterworth-filter">
<h4>Defining the stop-band attenuation in a Butterworth filter<a class="headerlink" href="#defining-the-stop-band-attenuation-in-a-butterworth-filter" title="Permalink to this heading">#</a></h4>
<p>Quite often, we require that in the stop-band of the filter, that is when <span class="math notranslate nohighlight">\(\omega \ge \omega_c\)</span>, the attenuation is larger than <span class="math notranslate nohighlight">\(-20\)</span> dB/decade. That is, we require a sharper cut-off. As can be seen from the plots of <a class="reference internal" href="#unit7-1-butter"><span class="std std-ref">Butterworth Analogue Low-Pass Filter Design</span></a>, the Butterworth becomes sharper for larger values of <span class="math notranslate nohighlight">\(k\)</span>. To see this more clearly, we generate a family of attenuation curves using the MATLAB script given below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">w_w0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mf">0.01</span><span class="p">:</span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">dBk1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="o">.*</span><span class="nb">log10</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">w_w0</span><span class="o">.^</span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)));</span>
<span class="n">dBk2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="o">.*</span><span class="nb">log10</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">w_w0</span><span class="o">.^</span><span class="mi">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)));</span><span class="w"> </span><span class="n">dBk3</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="o">.*</span><span class="nb">log10</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">w_w0</span><span class="o">.^</span><span class="mi">6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)));</span>
<span class="n">dBk4</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="o">.*</span><span class="nb">log10</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">w_w0</span><span class="o">.^</span><span class="mi">8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)));</span><span class="w"> </span><span class="n">dBk5</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="o">.*</span><span class="nb">log10</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">w_w0</span><span class="o">.^</span><span class="mi">10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)));</span>
<span class="n">dBk6</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="o">.*</span><span class="nb">log10</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">w_w0</span><span class="o">.^</span><span class="mi">12</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)));</span><span class="w"> </span><span class="n">dBk7</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="o">.*</span><span class="nb">log10</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">w_w0</span><span class="o">.^</span><span class="mi">14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)));</span>
<span class="n">dBk8</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="o">.*</span><span class="nb">log10</span><span class="p">(</span><span class="nb">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">./</span><span class="p">(</span><span class="n">w_w0</span><span class="o">.^</span><span class="mi">16</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)));</span>
<span class="nb">semilogx</span><span class="p">(</span><span class="n">w_w0</span><span class="p">,</span><span class="n">dBk1</span><span class="p">,</span><span class="n">w_w0</span><span class="p">,</span><span class="n">dBk2</span><span class="p">,</span><span class="n">w_w0</span><span class="p">,</span><span class="n">dBk3</span><span class="p">,</span><span class="n">w_w0</span><span class="p">,</span><span class="n">dBk4</span><span class="p">,</span><span class="k">...</span>
<span class="w">         </span><span class="n">w_w0</span><span class="p">,</span><span class="n">dBk5</span><span class="p">,</span><span class="n">w_w0</span><span class="p">,</span><span class="n">dBk6</span><span class="p">,</span><span class="n">w_w0</span><span class="p">,</span><span class="n">dBk7</span><span class="p">,</span><span class="n">w_w0</span><span class="p">,</span><span class="n">dBk8</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Normalized Frequency (rad/sec)&#39;</span><span class="p">),</span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude Response (dB)&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Magnitude Attenuation ad a Fuction of Noramized Frequency&#39;</span><span class="p">)</span>
<span class="nb">set</span><span class="p">(</span><span class="nb">gca</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;XTick&#39;</span><span class="p">,[</span><span class="mi">1</span><span class="p">:</span><span class="mi">10</span><span class="p">]),</span><span class="nb">grid</span>
<span class="nb">legend</span><span class="p">(</span><span class="s">&#39;k = 1&#39;</span><span class="p">,</span><span class="s">&#39;k = 2&#39;</span><span class="p">,</span><span class="s">&#39;k = 3&#39;</span><span class="p">,</span><span class="s">&#39;k = 4&#39;</span><span class="p">,</span><span class="s">&#39;k = 5&#39;</span><span class="p">,</span><span class="s">&#39;k = 6&#39;</span><span class="p">,</span><span class="s">&#39;k = 7&#39;</span><span class="p">,</span><span class="s">&#39;k = 8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6070cc68a657c91faa30883009d26d68feecccc6ec6503e240f07ae535321dd9.png" src="../_images/6070cc68a657c91faa30883009d26d68feecccc6ec6503e240f07ae535321dd9.png" />
</div>
</div>
<p>This plot indicates that for <span class="math notranslate nohighlight">\(k = 1\)</span> the attenuation is <span class="math notranslate nohighlight">\(-20\)</span> dB/decade, for <span class="math notranslate nohighlight">\(k=2\)</span>, the attenuation is <span class="math notranslate nohighlight">\(-40\)</span> dB/decade, and so on. In general, the attenuation is <span class="math notranslate nohighlight">\(-20k\)</span> dB/decade for a Butterworth filter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We have used several new MATLAB commands in <a class="reference internal" href="#unit7-1-ex5"><span class="std std-ref">Example 5</span></a>. These are summarized below.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://uk.mathworks.com/help/signal/ref/lp2lp.html"><code class="docutils literal notranslate"><span class="pre">lp2lp</span></code></a> - change cutoff frequency for lowpass analogue filter.</p></li>
<li><p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">bodeplot</span></code></span> - plot Bode frequency response with additional plot customization options.</p></li>
<li><p>option <a class="reference external" href="https://uk.mathworks.com/help/ident/ref/frdmodel.chgfrequnit.html"><code class="docutils literal notranslate"><span class="pre">FreqUnits</span></code></a> - changes the units for frequency response data.</p></li>
</ul>
</div>
<p><span id="id13">Karris [<a class="reference internal" href="../zbib.html#id7" title="Steven T. Karris. Signals and systems with MATLAB computing and Simulink modeling. Orchard Publishing, Fremont, CA., fifth edition, 2012. ISBN 9781934404232. Library call number: TK5102.9 K37 2012 LOCATE. URL: https://ebookcentral.proquest.com/lib/swansea-ebooks/detail.action?docID=3384197&amp;pq-origsite=primo.">2012</a>]</span> goes on to give more details of the Butterworth filter, including how to chose the filter order <span class="math notranslate nohighlight">\(N\)</span> to match a specific requirement on the stop-band attenuation, and how such a filter might be implemented with Op-Amp circuits. We leave you to explore these topics on your own.</p>
</section>
</section>
<section id="chebyshev-type-i-analogue-low-pass-filter-design">
<span id="unit7-1-cheby1"></span><h3>Chebyshev Type I Analogue Low-Pass Filter Design<a class="headerlink" href="#chebyshev-type-i-analogue-low-pass-filter-design" title="Permalink to this heading">#</a></h3>
<p>An issue with the Butterworth filter is that the stop-band attenuation rate may not be high enough for some applications unless a very large value of <span class="math notranslate nohighlight">\(N\)</span> is used.</p>
<p>If we allow some ripple in the pass-band we can obtain a sharper cut-off for smaller values of <span class="math notranslate nohighlight">\(N\)</span>.</p>
<p>The Chebyshev analogue low-pass filter is such a design.</p>
<p>The model transfer function for a Type I Chebyshev filter is</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-16">
<span class="eqno">(34)<a class="headerlink" href="#equation-eq-7-1-16" title="Permalink to this equation">#</a></span>\[ A^2(\omega) = \frac{\alpha}{1 + \epsilon^2C_k^2(\omega/\omega_c)}  \]</div>
<p>Where <span class="math notranslate nohighlight">\(C_k\)</span> is the Chebyshev polynomial<a class="footnote-reference brackets" href="#chebyshev-poly" id="id14">5</a> of degree <span class="math notranslate nohighlight">\(k\)</span>, and <span class="math notranslate nohighlight">\(\epsilon^2\)</span> is a parameter that is used to set the pass-band ripple.</p>
<p>A Chebyshev filter has the same transfer function structure as <a class="reference internal" href="#equation-eq-7-1-16">(34)</a>, but the poles are located on an elipse rather than a circle.</p>
<p>We will not present the formulae used to define the poles of this filter type, as MATLAB provides the design tool <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/cheb1ap.html"><code class="docutils literal notranslate"><span class="pre">cheb1ap</span></code></a> that will do this for us.</p>
<section id="example-6">
<span id="unit7-1-ex6"></span><h4>Example 6<a class="headerlink" href="#example-6" title="Permalink to this heading">#</a></h4>
<p>Use the MATLAB function <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/cheb1ap.html"><code class="docutils literal notranslate"><span class="pre">cheb1ap</span></code></a> to design a second-order Chebysehv Type I low-pass filter with 3 dB ripple in the pass-band.</p>
<section id="id15">
<h5>Solution<a class="headerlink" href="#id15" title="Permalink to this heading">#</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">cheb1ap</span></code> function takes two arguments, the order <span class="math notranslate nohighlight">\(N\)</span> and the pass-band ripple (in dB). It returns the zero-pole-gain values as vectors.</p>
<p>To solve the problem, we use the script:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="mf">0.05</span><span class="p">:</span><span class="mi">400</span><span class="p">;</span><span class="w"> </span><span class="c">% Range of frequencies to plot.</span>
<span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1ap</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">zp2tf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="c">% Convert zeros and poles of G(s) to polynomial form</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b =
                   0                   0   0.501188646503800
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a =
   1.000000000000000   0.644899651302867   0.707947780125280
</pre></div>
</div>
</div>
</div>
<p>Now, with the known values of <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>, we can use the <code class="docutils literal notranslate"><span class="pre">bode</span></code> function to produce the magnitude and phase plots as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">bode</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Bode plot for Type | Second-Order Chebyshev Low-Pass Filter&#39;</span><span class="p">)</span>
<span class="nb">grid</span><span class="w"> </span><span class="n">on</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/14c04be541afe8135cdfba9078d34615501993c2cc39bcc1a68a0a35a6929c8d.png" src="../_images/14c04be541afe8135cdfba9078d34615501993c2cc39bcc1a68a0a35a6929c8d.png" />
</div>
</div>
<p>On the Bode plots shown, the ripple is not so obvious. The reason is that the Magnitude is in dB so the plot is essentially a linear approximation. To see the ripple we plot magnitude:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="mf">0.01</span><span class="p">:</span><span class="mi">10</span><span class="p">;</span><span class="w"> </span>
<span class="n">Gs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">freqs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">);</span><span class="w"> </span><span class="c">% returns response as complex values</span>
<span class="nb">semilogx</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">Gs</span><span class="p">)),</span><span class="nb">grid</span><span class="w"> </span><span class="n">on</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency in rad/s&#39;</span><span class="p">),</span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude of G(s)&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Type I Chebyshev Low-Pass Filter&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d922f8d0ff636ca073afa4b9aaab1a3f05f369e75ab9bfdd911145d71311c391.png" src="../_images/d922f8d0ff636ca073afa4b9aaab1a3f05f369e75ab9bfdd911145d71311c391.png" />
</div>
</div>
<p>The function <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/freqs.html"><code class="docutils literal notranslate"><span class="pre">freqs</span></code></a> computes the complex frequency response <span class="math notranslate nohighlight">\(H(j\omega)\)</span> of an analogue filter <span class="math notranslate nohighlight">\(H(s) = b(s)/a(s)\)</span>.</p>
</section>
</section>
</section>
<section id="chebyshev-type-ii-analogue-low-pass-filter-design">
<span id="unit7-1-cheby2"></span><h3>Chebyshev Type II Analogue Low-Pass Filter Design<a class="headerlink" href="#chebyshev-type-ii-analogue-low-pass-filter-design" title="Permalink to this heading">#</a></h3>
<p>A Type II Chebyshev filter has ripple in the stop-band. It is defined by the magnitude squared expression:</p>
<div class="math notranslate nohighlight" id="equation-eq-7-1-17">
<span class="eqno">(35)<a class="headerlink" href="#equation-eq-7-1-17" title="Permalink to this equation">#</a></span>\[ A^2(\omega) = \frac{\epsilon^2C_k^2(\omega/\omega_c)}{1 + \epsilon^2C_k^2(\omega/\omega_c)}  \]</div>
<p>We can design Chebyshev Type II low-pass filters with the MATLAB <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/cheb2ap.html"><code class="docutils literal notranslate"><span class="pre">cheb2ap</span></code></a> function.</p>
<section id="example-7">
<span id="unit7-1-ex7"></span><h4>Example 7<a class="headerlink" href="#example-7" title="Permalink to this heading">#</a></h4>
<p>Using the MATLAB <code class="docutils literal notranslate"><span class="pre">cheb2ap</span></code> function, design a third-order Chebyshev analogue filter with 3 dB ripple in the stop band.</p>
<section id="id16">
<h5>Solution<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h5>
<p>We begin with the MATLAB script reporoduced below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="mf">0.01</span><span class="p">:</span><span class="mi">1000</span><span class="p">;</span><span class="w"> </span>
<span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb2ap</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">zp2tf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b =
  Columns 1 through 3
                   0   3.007131879022801                   0
  Column 4
   4.009509172030401
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a =
  Columns 1 through 3
   1.000000000000000   3.716637149027132   2.385274779846660
  Column 4
   4.009509172030401
</pre></div>
</div>
</div>
</div>
<p>Plot this response</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">Gs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">freqs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">w</span><span class="p">);</span><span class="w"> </span><span class="nb">semilogx</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">Gs</span><span class="p">))</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency in rad/s - log scale&#39;</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude of G(s) (absolute values)&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Type 2 Chebyshev Low-Pass Filter: k = 3, 3 dB ripple in stop band&#39;</span><span class="p">)</span>
<span class="nb">grid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a23d646ac47487aaefbce5e225dd416e24b611ac323ae7fb0ea125293455e3aa.png" src="../_images/a23d646ac47487aaefbce5e225dd416e24b611ac323ae7fb0ea125293455e3aa.png" />
</div>
</div>
</section>
</section>
</section>
<section id="elliptic-analogue-low-pass-filter-design">
<span id="unit7-1-ellip"></span><h3>Elliptic Analogue Low-Pass Filter Design<a class="headerlink" href="#elliptic-analogue-low-pass-filter-design" title="Permalink to this heading">#</a></h3>
<p>The <em>elliptic filter</em>, also known as <em>Cauer</em> filter, is characterized by the low-pass magnutude-squared function</p>
<div class="math notranslate nohighlight" id="equation-7-1-18">
<span class="eqno">(36)<a class="headerlink" href="#equation-7-1-18" title="Permalink to this equation">#</a></span>\[ A^2(\omega) = \frac{1}{1 + R_k^2\left(\omega/\omega_c\right)}  \]</div>
<p>where <span class="math notranslate nohighlight">\(R_k(x)\)</span> represents a rational elliptic function used with eliptic integrals.</p>
<p>Elliptic filters have ripple in both the pass-bad and stop-band, but have a very steep transiition between these bands.</p>
<p>We can design elliptic low-pass filters with the <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/ellip.html"><code class="docutils literal notranslate"><span class="pre">ellip</span></code></a> function. The statement</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Rp</span><span class="p">,</span><span class="n">Rs</span><span class="p">,</span><span class="n">W0</span><span class="p">,</span><span class="s">&#39;s&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>returns the pole-zero-gain values for an elliptic low-pass filter of order <code class="docutils literal notranslate"><span class="pre">N</span></code>, with a maximum passband ripple of <code class="docutils literal notranslate"><span class="pre">Rp</span></code> dB, a stop-band ripple of <code class="docutils literal notranslate"><span class="pre">Rs</span></code> dB, cut-off frequency of <code class="docutils literal notranslate"><span class="pre">W0</span></code> rad/s. The argument s returns the poles and zeros of an analogue filter. If ommitted, the function designs a discrete-time filter.</p>
<section id="example-8">
<span id="uni7-1-ex8"></span><h4>Example 8<a class="headerlink" href="#example-8" title="Permalink to this heading">#</a></h4>
<p>Use the MATLAB function <code class="docutils literal notranslate"><span class="pre">ellip</span></code> to design a fifth-order analogue eliptic low-pass filter with <span class="math notranslate nohighlight">\(\omega_c = 200\)</span> rad/s, pass-band ripple of <span class="math notranslate nohighlight">\(0.6\)</span> dB and stop-band ripple of <span class="math notranslate nohighlight">\(20\)</span> dB. Plot the magnitude frequency response of the filter.</p>
<section id="id17">
<h5>Solution<a class="headerlink" href="#id17" title="Permalink to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="mf">0.05</span><span class="p">:</span><span class="mi">500</span><span class="p">;</span>
<span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellip</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;s&#39;</span><span class="p">);</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">zp2tf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">Gs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">freqs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">w</span><span class="p">);</span>
<span class="nb">semilogx</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">Gs</span><span class="p">)),</span><span class="nb">grid</span><span class="w"> </span><span class="n">on</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency in rad/s - log scale&#39;</span><span class="p">),</span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude of G(s) (absolute values)&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;Five Pole Elliptic Low-Pass Filter &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b273c39e59a8469736d56f9df3985abb04022bf2e3981a04d000bfd36679ca94.png" src="../_images/b273c39e59a8469736d56f9df3985abb04022bf2e3981a04d000bfd36679ca94.png" />
</div>
</div>
</section>
</section>
</section>
<section id="comparison-of-analogue-low-pass-filter-designs">
<span id="unit7-1-comparison"></span><h3>Comparison of analogue low-pass filter designs<a class="headerlink" href="#comparison-of-analogue-low-pass-filter-designs" title="Permalink to this heading">#</a></h3>
<p>Figure <a class="reference internal" href="#fig-u71-comparison"><span class="std std-numref">Fig. 13</span></a> shows the Butterworth, Chebyshev and Elliptic filters for a fifth-order prototype analogue low-pass filter.</p>
<figure class="align-default" id="fig-u71-comparison">
<img alt="Frequency response curves of four linear analog filters: Butterworth filter, Chebyshev filter of type 1 and 2 and Elliptic filter, each one as 5th order filter." src="../_images/Filters_order5.svg" /><figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">Frequency response curves of four linear analog filters: Butterworth filter, Chebyshev filter of type 1 and 2 and Elliptic filter, each one as 5th order filter. (Originally published as <a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_filter#/media/File:Filters_order5.svg">Filters_order5.svg</a> on WikiPedia article <a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_filter">Chebyshev filter</a>. Image CC BY <a class="reference external" href="https://commons.wikimedia.org/wiki/User:Geek3">Geek2</a>)</span><a class="headerlink" href="#fig-u71-comparison" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>As you can see, the Chebyshev filters are sharper than the Butterworth filter; they are not as sharp as the elliptic one, but they show fewer ripples over the bandwidth.</p>
</section>
<section id="advantages-and-disadvantages-of-different-types-of-filters">
<h3>Advantages and disadvantages of different types of filters<a class="headerlink" href="#advantages-and-disadvantages-of-different-types-of-filters" title="Permalink to this heading">#</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Filter Type</strong></p></th>
<th class="head"><p><strong>Advantages</strong></p></th>
<th class="head"><p>Disadvantages</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Butterworth</p></td>
<td><p>Simplest design; Flat pass band</p></td>
<td><p>Slow rate of attenuation for order 4 or less</p></td>
</tr>
<tr class="row-odd"><td><p>Chebyshev Type I</p></td>
<td><p>Sharp cuttoff rate in transition (pass to stop) band</p></td>
<td><p>Ripple in pass band. Bad (non-linear) phase response</p></td>
</tr>
<tr class="row-even"><td><p>Chebyshev Type II</p></td>
<td><p>Sharp cuttoff rate in transition (pass to stop) band</p></td>
<td><p>Ripple in stop band. Bad (non-linear) phase response</p></td>
</tr>
<tr class="row-odd"><td><p>Elliptic (Cauer)</p></td>
<td><p>Sharpest cutoff rate among all other types of filters</p></td>
<td><p>Ripple in both pass and stop band. Worst (most non-linear) phase response among the other types of filters.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="high-pass-band-pass-and-band-elimination-filter-design">
<span id="unit7-1-other"></span><h2>High-Pass, Band-Pass and Band-Elimination Filter Design<a class="headerlink" href="#high-pass-band-pass-and-band-elimination-filter-design" title="Permalink to this heading">#</a></h2>
<p>Prototype analogue filters can be converted to high-pass, band-pass and band-elimination (band-stop filters) by the application of frequency transformations on <span class="math notranslate nohighlight">\(s\)</span> in <span class="math notranslate nohighlight">\(G(s)\)</span>. These transformations are listed in Table 11.5 on Page 11-40 of <span id="id18">[<a class="reference internal" href="../zbib.html#id7" title="Steven T. Karris. Signals and systems with MATLAB computing and Simulink modeling. Orchard Publishing, Fremont, CA., fifth edition, 2012. ISBN 9781934404232. Library call number: TK5102.9 K37 2012 LOCATE. URL: https://ebookcentral.proquest.com/lib/swansea-ebooks/detail.action?docID=3384197&amp;pq-origsite=primo.">Karris, 2012</a>]</span> and will not be reproduced here. Instead we will introduce the MATLAB transformation functions and give some examples of their use.</p>
<section id="low-pass-to-low-pass">
<h3>Low-pass to low-pass<a class="headerlink" href="#low-pass-to-low-pass" title="Permalink to this heading">#</a></h3>
<p>As already seen in <a class="reference internal" href="#unit6-1-denormalize"><span class="std std-ref">Denormalizing a prototype filter</span></a>, the function <code class="docutils literal notranslate"><span class="pre">lp2lp</span></code> will convert a normalised low-pass analogue filter with cut-off frequency <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> to <span class="math notranslate nohighlight">\(\omega_c = \omega_\mathrm{actual}\)</span>.</p>
<p>See <a class="reference internal" href="#unit6-1-denormalize"><span class="std std-ref">Denormalizing a prototype filter</span></a> for an example.</p>
</section>
<section id="low-pass-to-high-pass">
<h3>Low-pass to high-pass<a class="headerlink" href="#low-pass-to-high-pass" title="Permalink to this heading">#</a></h3>
<p>The MATLAB function <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/lp2hp.html"><code class="docutils literal notranslate"><span class="pre">lp2hp</span></code></a> will convert a low-pass analogue filter to a high-pass analogue filter.</p>
<section id="example-9">
<h4>Example 9<a class="headerlink" href="#example-9" title="Permalink to this heading">#</a></h4>
<p>Use the MATLAB commands <code class="docutils literal notranslate"><span class="pre">cheb1ap</span></code> and <code class="docutils literal notranslate"><span class="pre">lp2hp</span></code> to derive the transfer function of a 3-pole Chebyshev Type I analogue high-pass filter with cutoff frequency <span class="math notranslate nohighlight">\(f_c = 5\)</span> kHz.</p>
<section id="id19">
<h5>Solution<a class="headerlink" href="#id19" title="Permalink to this heading">#</a></h5>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">cheb1ap</span></code> command to derive the transfer function <span class="math notranslate nohighlight">\(G(s)\)</span> of the low-pass filter with normalized cutoff frequency at <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> rad/s. Then we will use the command <code class="docutils literal notranslate"><span class="pre">lp2hp</span></code> to transform <span class="math notranslate nohighlight">\(G(s)\)</span> to another transfer function <span class="math notranslate nohighlight">\(G'(s)\)</span> with cut-off frequency at <span class="math notranslate nohighlight">\(f_c = 5\)</span> kHz or <span class="math notranslate nohighlight">\(\omega_c = 2\pi\times 5\times 10^3\)</span> rad/s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% design 3 pole Type I Chebyshev low-pass filter, wc = 1 rad/s</span>
<span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1ap</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span><span class="w">    </span><span class="c">% 3 pole, 3dB ripple in pass band</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">zp2tf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">);</span><span class="w">      </span><span class="c">% Compute numerator and denoninator coefficents with wcn = 1 rad/s</span>
<span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1000</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mi">100000</span><span class="p">;</span><span class="w">       </span><span class="c">% Define frequency range to plot</span>
<span class="n">fc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">5000</span><span class="p">;</span><span class="w">                 </span><span class="c">% Define actual cutoff frequency at 5 kHz</span>
<span class="n">wc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">fc</span><span class="p">;</span><span class="w">              </span><span class="c">% Convert desired cut-off frequency to rad/s       </span>
<span class="p">[</span><span class="n">bn</span><span class="p">,</span><span class="n">an</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">lp2hp</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">wc</span><span class="p">);</span><span class="w"> </span><span class="c">% Compute numerator and denoninator coefficents of high-pass filter with fc = 5 kHz</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Compute and plot frequency response of high-pass filter</span>
<span class="n">Gsn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">freqs</span><span class="p">(</span><span class="n">bn</span><span class="p">,</span><span class="w"> </span><span class="n">an</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">f</span><span class="p">);</span>
<span class="nb">semilogx</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Gsn</span><span class="p">))),</span><span class="w"> </span><span class="nb">grid</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency (Hz) - log scale&#39;</span><span class="p">),</span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude of Transfer Function (dB)&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;3-Pole Type 1 Chebyshev high-pass filter with fc = 5 kHz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8bcab8f648e0a62bf8e48944626a13c8c0ebc881cc1ff1eba06678e9be92fce9.png" src="../_images/8bcab8f648e0a62bf8e48944626a13c8c0ebc881cc1ff1eba06678e9be92fce9.png" />
</div>
</div>
</section>
</section>
</section>
<section id="low-pass-to-band-pass">
<h3>Low-pass to band-pass<a class="headerlink" href="#low-pass-to-band-pass" title="Permalink to this heading">#</a></h3>
<p>The MATLAB function <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/lp2bp.html"><code class="docutils literal notranslate"><span class="pre">lp2bp</span></code></a> will convert a normalized low-pass analogue filter to a band-pass analogue filter.</p>
<section id="example-10">
<h4>Example 10<a class="headerlink" href="#example-10" title="Permalink to this heading">#</a></h4>
<p>Use the MATLAB commands <code class="docutils literal notranslate"><span class="pre">buttap</span></code> and <code class="docutils literal notranslate"><span class="pre">lp2bp</span></code> to derive the transfer function of a 3-pole Butterworth analogue band-pass filter with the pass band frequency centred at <span class="math notranslate nohighlight">\(f_0 = 4\)</span> kHz, and bandwidth <span class="math notranslate nohighlight">\(\mathrm{BW} = 2\)</span> kHz.</p>
<section id="id20">
<h5>Solution<a class="headerlink" href="#id20" title="Permalink to this heading">#</a></h5>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">buttap</span></code> function to derive the transfer function <span class="math notranslate nohighlight">\(G(s)\)</span> of the low-pass analogue filter with normalized cutoff frequency at <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> rad/s. Then we will use the command <code class="docutils literal notranslate"><span class="pre">lp2bp</span></code> to transform <span class="math notranslate nohighlight">\(G(s)\)</span> to another transfer function <span class="math notranslate nohighlight">\(G'(s)\)</span> with centred frequency at <span class="math notranslate nohighlight">\(f_0 = 4\)</span> kHz and bandwith <span class="math notranslate nohighlight">\(\mathrm{BW} = 2\)</span> hHz.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">format</span><span class="w"> </span><span class="n">short</span><span class="p">;</span>
<span class="c">% design 3 pole Butterworth low-pass filter, wc = 1 rad/s</span>
<span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttap</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w">       </span><span class="c">% 3 pole</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">zp2tf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">);</span><span class="w">      </span><span class="c">% Compute numerator and denoninator coefficents with wcn = 1 rad/s</span>
<span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">100</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mi">100000</span><span class="p">;</span><span class="w">        </span><span class="c">% Define frequency range to plot</span>
<span class="n">f0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">4000</span><span class="p">;</span><span class="w">                 </span><span class="c">% Define center frequency at 4 kHz</span>
<span class="n">W0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">f0</span><span class="p">;</span><span class="w">              </span><span class="c">% Convert desired centre frequency to rad/s    </span>
<span class="n">fbw</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2000</span><span class="p">;</span><span class="w">                </span><span class="c">% Define bandwidth</span>
<span class="n">Bw</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">fbw</span><span class="p">;</span><span class="w">             </span><span class="c">% Convert desired bandwidth to rad/s</span>
<span class="p">[</span><span class="n">bn</span><span class="p">,</span><span class="n">an</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">lp2bp</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">W0</span><span class="p">,</span><span class="w"> </span><span class="n">Bw</span><span class="p">);</span><span class="w"> </span><span class="c">% Compute numerator and denoninator coefficents of band-pass filter</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Compute and plot frequency response of band-pass filter</span>
<span class="n">Gsn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">freqs</span><span class="p">(</span><span class="n">bn</span><span class="p">,</span><span class="w"> </span><span class="n">an</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">f</span><span class="p">);</span>
<span class="nb">semilogx</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Gsn</span><span class="p">))),</span><span class="w"> </span><span class="nb">grid</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency (Hz) - log scale&#39;</span><span class="p">),</span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude of Transfer Function (dB)&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;3-Pole Butterworth band-pass filter with f0 = 4 kHz, BW = 2 kHz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a44bb8b51f81735d9a2ce2c7e7d9d27d8c48ad1dddbcd8598071d2fb8556b39e.png" src="../_images/a44bb8b51f81735d9a2ce2c7e7d9d27d8c48ad1dddbcd8598071d2fb8556b39e.png" />
</div>
</div>
</section>
</section>
</section>
<section id="low-pass-to-band-stop">
<h3>Low-pass to band-stop<a class="headerlink" href="#low-pass-to-band-stop" title="Permalink to this heading">#</a></h3>
<p>The MATLAB function <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/lp2bs.html"><code class="docutils literal notranslate"><span class="pre">lp2bs</span></code></a> will convert a low-pass normalized analogue filter to a band-stop analogue filter.</p>
<section id="example-11">
<h4>Example 11<a class="headerlink" href="#example-11" title="Permalink to this heading">#</a></h4>
<p>Use the MATLAB commands <code class="docutils literal notranslate"><span class="pre">buttap</span></code> and <code class="docutils literal notranslate"><span class="pre">lp2bs</span></code> to derive the transfer function of a 3-pole Butterworth analogue band-elimination (band-stop) filter with the stop band frequency centred at <span class="math notranslate nohighlight">\(f_0 = 5\)</span> kHz, and bandwidth <span class="math notranslate nohighlight">\(\mathrm{BW} = 2\)</span> kHz.</p>
</section>
</section>
<section id="id21">
<h3>Low-pass to band-pass<a class="headerlink" href="#id21" title="Permalink to this heading">#</a></h3>
<p>The MATLAB function <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/lp2bp.html"><code class="docutils literal notranslate"><span class="pre">lp2bp</span></code></a> will convert a low-pass filter to a band-pass filter.</p>
<section id="id22">
<h4>Solution<a class="headerlink" href="#id22" title="Permalink to this heading">#</a></h4>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">buttap</span></code> function to derive the transfer function <span class="math notranslate nohighlight">\(G(s)\)</span> of the low-pass analogue filter with normalized cutoff frequency at <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> rad/s. Then we will use the command <code class="docutils literal notranslate"><span class="pre">lp2bs</span></code> to transform <span class="math notranslate nohighlight">\(G(s)\)</span> to another transfer function <span class="math notranslate nohighlight">\(G'(s)\)</span> with centred frequency at <span class="math notranslate nohighlight">\(f_0 = 5\)</span> kHz and bandwith <span class="math notranslate nohighlight">\(\mathrm{BW} = 2\)</span> hHz.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">format</span><span class="w"> </span><span class="n">short</span><span class="p">;</span>
<span class="c">% design 3 pole Butterworth low-pass filter, wc = 1 rad/s</span>
<span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttap</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w">       </span><span class="c">% 3 pole</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">zp2tf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">);</span><span class="w">      </span><span class="c">% Compute numerator and denoninator coefficents with wcn = 1 rad/s</span>
<span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1000</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mi">10000</span><span class="p">;</span><span class="w">        </span><span class="c">% Define frequency range to plot</span>
<span class="n">f0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">5000</span><span class="p">;</span><span class="w">                 </span><span class="c">% Define center frequency at 4 kHz</span>
<span class="n">W0</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">f0</span><span class="p">;</span><span class="w">              </span><span class="c">% Convert desired centre frequency to rad/s    </span>
<span class="n">fbw</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2000</span><span class="p">;</span><span class="w">                </span><span class="c">% Define bandwidth</span>
<span class="n">Bw</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">fbw</span><span class="p">;</span><span class="w">             </span><span class="c">% Convert desired bandwidth to rad/s</span>
<span class="p">[</span><span class="n">bn</span><span class="p">,</span><span class="n">an</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">lp2bs</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">W0</span><span class="p">,</span><span class="w"> </span><span class="n">Bw</span><span class="p">);</span><span class="w"> </span><span class="c">% Compute numerator and denoninator coefficents of band-pass filter</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="c">% Compute and plot frequency response of band-pass filter</span>
<span class="n">Gsn</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">freqs</span><span class="p">(</span><span class="n">bn</span><span class="p">,</span><span class="w"> </span><span class="n">an</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">f</span><span class="p">);</span>
<span class="nb">semilogx</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Gsn</span><span class="p">))),</span><span class="w"> </span><span class="nb">grid</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency (Hz) - log scale&#39;</span><span class="p">),</span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude of Transfer Function (dB)&#39;</span><span class="p">)</span>
<span class="nb">title</span><span class="p">(</span><span class="s">&#39;3-Pole Butterworth band-stop filter with f0 = 5 kHz, BW = 2 kHz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/27a66ce6a0939fecb7c4b4cdaae0dc6dc19f8e816c15407d36da9946230094f7.png" src="../_images/27a66ce6a0939fecb7c4b4cdaae0dc6dc19f8e816c15407d36da9946230094f7.png" />
</div>
</div>
</section>
</section>
</section>
<section id="unit-7-1-summary">
<span id="unit7-1-summary"></span><h2>Unit 7.1 Summary<a class="headerlink" href="#unit-7-1-summary" title="Permalink to this heading">#</a></h2>
<p>In this unit we have looked at the design of prototype analogue low-pass filters which is a basis for filter design in general. We have demonstrated how the analogue-squared function <span class="math notranslate nohighlight">\(A^2(\omega) = G(s)G(-s)\)</span> can be used to design an analogue filter <span class="math notranslate nohighlight">\(G(s)\)</span> with particular properties, we then looked at the Butterworth filter, Chebyshev Type I and Type II filters and the elliptic filter. We explored the MATLAB tools provided by the Signal Processing Toolbox that can used to these design these prototype filters and the functions that can be used to denormalize the cutoff frequency and design high-pass, band-pass and band-stop filters.</p>
<p>These are the topics we covered:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#unit7-1-introduction"><span class="std std-ref">Introduction</span></a></p></li>
<li><p><a class="reference internal" href="#unit7-1-afp"><span class="std std-ref">Low-pass analogue filter prototypes</span></a></p>
<ul>
<li><p><a class="reference internal" href="#unit7-1-msf"><span class="std std-ref">Magnitude-square function</span></a></p></li>
<li><p><a class="reference internal" href="#unit7-1-butter"><span class="std std-ref">Butterworth Analogue Low-Pass Filter Design</span></a></p></li>
<li><p><a class="reference internal" href="#unit7-1-cheby1"><span class="std std-ref">Chebyshev Type I Analogue Low-Pass Filter Design</span></a></p></li>
<li><p><a class="reference internal" href="#unit7-1-cheby2"><span class="std std-ref">Chebyshev Type II Analogue Low-Pass Filter Design</span></a></p></li>
<li><p><a class="reference internal" href="#unit7-1-ellip"><span class="std std-ref">Elliptic Analogue Low-Pass Filter Design</span></a></p></li>
<li><p><a class="reference internal" href="#unit7-1-comparison"><span class="std std-ref">Comparison of analogue low-pass filter designs</span></a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#unit7-1-other"><span class="std std-ref">High-Pass, Band-Pass and Band-Elimination Filter Design</span></a></p></li>
</ul>
<section id="unit-7-1-takeaways">
<span id="unit7-1-takeaways"></span><h3>Unit 7.1 Takeaways<a class="headerlink" href="#unit-7-1-takeaways" title="Permalink to this heading">#</a></h3>
</section>
<section id="coming-next">
<span id="unit7-1-next"></span><h3>Coming Next<a class="headerlink" href="#coming-next" title="Permalink to this heading">#</a></h3>
<p>We will conclude this module in <a class="reference internal" href="#unit7-1"><span class="std std-ref">Unit 7.1: Designing Analogue Filters</span></a> with a look at how analogue prototype filters can be digitized, how the digitized filters can be implemented and a demonstration of the interactive filter-design tools provided by MATLAB.</p>
</section>
<section id="matlab-functions-introduced-in-unit-7-1">
<span id="unit7-1-matlab"></span><h3>MATLAB functions introduced in Unit 7.1<a class="headerlink" href="#matlab-functions-introduced-in-unit-7-1" title="Permalink to this heading">#</a></h3>
<section id="analogue-prototype-designers">
<h4>Analogue prototype designers<a class="headerlink" href="#analogue-prototype-designers" title="Permalink to this heading">#</a></h4>
<p>Used to design an analogue prototype low-pass filter <span class="math notranslate nohighlight">\(G(s)\)</span> with normalized cutoff frequency <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> rad/s. The examples in this unit show the functions returning the zeros, poles and gain of the equivalent transfer function <span class="math notranslate nohighlight">\(G(s)\)</span>. They can all return the numerator and denominator polynomial coeffiecients of <span class="math notranslate nohighlight">\(G(s) = b(s)/a(s)\)</span> directly.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://uk.mathworks.com/help/signal/ref/buttap.html"><code class="docutils literal notranslate"><span class="pre">buttap</span></code></a> - <span class="math notranslate nohighlight">\(N\)</span>-pole Butterworth analogue prototype low-pass filter.</p></li>
<li><p><a class="reference external" href="https://uk.mathworks.com/help/signal/ref/cheb1ap.html"><code class="docutils literal notranslate"><span class="pre">cheb1ap</span></code></a> - <span class="math notranslate nohighlight">\(N\)</span>-pole Chebyshev Type I analogue prototype low-pass filter with defined pass-band ripple.</p></li>
<li><p><a class="reference external" href="https://uk.mathworks.com/help/signal/ref/cheb2ap.html"><code class="docutils literal notranslate"><span class="pre">cheb2ap</span></code></a> - <span class="math notranslate nohighlight">\(N\)</span>-pole Chebyshev Type II analogue prototype low-pass filter with defined stop-band ripple.</p></li>
<li><p><a class="reference external" href="https://uk.mathworks.com/help/signal/ref/ellipap.html"><code class="docutils literal notranslate"><span class="pre">ellipap</span></code></a> - <span class="math notranslate nohighlight">\(N\)</span>-pole Elliptic analogue prototype low-pass filter with defined pass-band and stop-band ripple.</p></li>
</ul>
</section>
<section id="filter-transformation-functions">
<h4>Filter transformation functions<a class="headerlink" href="#filter-transformation-functions" title="Permalink to this heading">#</a></h4>
<p>These functions convert the analogue low-pass filter <span class="math notranslate nohighlight">\(G(s)\)</span> with normalized cutoff frequency <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> \rad/s and convert it to a new filter <span class="math notranslate nohighlight">\(G'(s)\)</span>.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://uk.mathworks.com/help/signal/ref/lp2lp.html"><code class="docutils literal notranslate"><span class="pre">lp2lp</span></code></a> - converts an analogue low-pass filter with <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> to one with <span class="math notranslate nohighlight">\(\omega_c = \omega_\mathrm{actual}\)</span>.</p></li>
<li><p><a class="reference external" href="https://uk.mathworks.com/help/signal/ref/lp2hp.html"><code class="docutils literal notranslate"><span class="pre">lp2hp</span></code></a> - converts an analogue low-pass filter with <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> to a high-pass filter with <span class="math notranslate nohighlight">\(\omega_c = \omega_\mathrm{actual}\)</span>.</p></li>
<li><p><a class="reference external" href="https://uk.mathworks.com/help/signal/ref/lp2bp.html"><code class="docutils literal notranslate"><span class="pre">lp2bp</span></code></a> - converts an analogue low-pass filter with <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> to a band-pass filter with defined centre frequency <span class="math notranslate nohighlight">\(f_0\)</span> and bandwidth <span class="math notranslate nohighlight">\(\mathrm{BW}\)</span>.</p></li>
<li><p><a class="reference external" href="https://uk.mathworks.com/help/signal/ref/lp2lp.html"><code class="docutils literal notranslate"><span class="pre">lp2lp</span></code></a> - converts an analogue low-pass filter with <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> to a band-stop filter with defined centre frequency <span class="math notranslate nohighlight">\(f_0\)</span> and bandwidth <span class="math notranslate nohighlight">\(\mathrm{BW}\)</span>.</p></li>
</ul>
</section>
<section id="utility-functions">
<h4>Utility functions<a class="headerlink" href="#utility-functions" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://uk.mathworks.com/help/signal/ref/zp2tf.html"><code class="docutils literal notranslate"><span class="pre">zp2tf</span></code></a> - return the numerator and denominator polynomial coeffiecients of <span class="math notranslate nohighlight">\(G(s) = b(s)/a(s)\)</span> from the zeros, poles and gain returned by the design functions.</p></li>
<li><p><a class="reference external" href="https://uk.mathworks.com/support/search.html"><code class="docutils literal notranslate"><span class="pre">fregs</span></code></a> - return the CT frequency response of an analogue filter</p></li>
<li><p><a class="reference external" href="https://uk.mathworks.com/help/matlab/ref/semilogx.html"><code class="docutils literal notranslate"><span class="pre">semilogx</span></code></a> - plot y against the log of x.</p></li>
<li><p><a class="reference external" href="https://uk.mathworks.com/help/control/ref/tf.html"><code class="docutils literal notranslate"><span class="pre">tf</span></code></a> - create an LTI system object</p></li>
<li><p><a class="reference external" href="https://uk.mathworks.com/help/control/ref/dynamicsystem.bode.html"><code class="docutils literal notranslate"><span class="pre">bode</span></code></a> - Bode ploto of an LTI system:  magnitude in dB, phase in degrees plotted against log frequency.</p></li>
<li><p><a class="reference external" href="https://uk.mathworks.com/help/signal/ref/mag2db.html"><code class="docutils literal notranslate"><span class="pre">mag2db</span></code></a> - Converts magnitude into dB using <span class="math notranslate nohighlight">\(20\log_{10} M\)</span>.</p></li>
</ul>
</section>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h2>
<p>See <a class="reference internal" href="../zbib.html"><span class="doc std std-doc">Bibliography</span></a>.</p>
</section>
<section id="footnotes">
<h2>Footnotes<a class="headerlink" href="#footnotes" title="Permalink to this heading">#</a></h2>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="u71-note1"><span class="brackets"><a class="fn-backref" href="#id5">1</a></span></dt>
<dd><p>This avoids having to deal with complex magnitudes which use the square-root operator.</p>
</dd>
<dt class="label" id="u71-note2"><span class="brackets"><a class="fn-backref" href="#id6">2</a></span></dt>
<dd><p>A rational function is said to be <em>proper</em> if the largest power in the denominator is equal to or larger than that of the numerator.</p>
</dd>
<dt class="label" id="u71-note3"><span class="brackets"><a class="fn-backref" href="#id8">3</a></span></dt>
<dd><p>A system is said to be stable if a finite input produces a finite output. Alternatively, a system is stable if its impulse response <span class="math notranslate nohighlight">\(h(t)\)</span> vanishes after a sufficiently long time. For linear time-invariant systems, a system will be stable <em>only if</em> all the real-parts of the poles have negative sign. That is, they lie in the left-half of the <span class="math notranslate nohighlight">\(s\)</span>-plane.</p>
</dd>
<dt class="label" id="u71-note5"><span class="brackets"><a class="fn-backref" href="#id9">4</a></span></dt>
<dd><p>The frequency response of the Butterworth filter is <em>maximally flat</em> (has no ripples) in the passband, and rolls off towards zero in the stopband. When viewed on a logarithmic Bode plot, the response slopes off linearly at a rate of <span class="math notranslate nohighlight">\(-20k\)</span> dB/decade towards negative infinity.</p>
</dd>
<dt class="label" id="chebyshev-poly"><span class="brackets"><a class="fn-backref" href="#id14">5</a></span></dt>
<dd><p>The derivation of the Chebyshev polynomials is outside the scope of this unit, but if you are interested you can review one of the many online resources: e.g. <a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_polynomials">Chebyshev polynomials</a> [WikiPedia]. The <a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_polynomials#Examples">Chebyshev polynomials of the first kind</a> are used in the design of filters. If you want the details, please consult Section 11.2.2 of <span id="id23">Karris [<a class="reference internal" href="../zbib.html#id7" title="Steven T. Karris. Signals and systems with MATLAB computing and Simulink modeling. Orchard Publishing, Fremont, CA., fifth edition, 2012. ISBN 9781934404232. Library call number: TK5102.9 K37 2012 LOCATE. URL: https://ebookcentral.proquest.com/lib/swansea-ebooks/detail.action?docID=3384197&amp;pq-origsite=primo.">2012</a>]</span>. See also <a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_filter">Chebyshev filter</a> [WikiPedia]</p>
</dd>
</dl>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "matlab"
        },
        kernelOptions: {
            name: "matlab",
            path: "./filter_design"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'matlab'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Unit 7: Analogue and Digital Filters</p>
      </div>
    </a>
    <a class="right-next"
       href="digital_filters.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Unit 7.2: Designing Digital Filters in MATLAB and Simulink</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#colophon">Colophon</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scope-and-background-reading">Scope and Background Reading</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#agenda">Agenda</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#low-pass-analogue-filter-prototypes">Low-pass analogue filter prototypes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#magnitude-square-function">Magnitude-square function</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-1">Example 1</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#solution">Solution</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#general-form-of-magnitude-square-function">General form of magnitude-square function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analysis-of-magnitude-square-filter">Analysis of magnitude-square filter</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-2">Example 2</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#butterworth-analogue-low-pass-filter-design">Butterworth Analogue Low-Pass Filter Design</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-3">Example 3</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Solution</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#designing-butterworth-filters-in-matlab">Designing Butterworth filters in MATLAB</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-4">Example 4</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">Solution</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#denormalizing-a-prototype-filter">Denormalizing a prototype filter</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-5">Example 5</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">Solution</a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-the-stop-band-attenuation-in-a-butterworth-filter">Defining the stop-band attenuation in a Butterworth filter</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chebyshev-type-i-analogue-low-pass-filter-design">Chebyshev Type I Analogue Low-Pass Filter Design</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-6">Example 6</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chebyshev-type-ii-analogue-low-pass-filter-design">Chebyshev Type II Analogue Low-Pass Filter Design</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-7">Example 7</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#elliptic-analogue-low-pass-filter-design">Elliptic Analogue Low-Pass Filter Design</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-8">Example 8</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-of-analogue-low-pass-filter-designs">Comparison of analogue low-pass filter designs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advantages-and-disadvantages-of-different-types-of-filters">Advantages and disadvantages of different types of filters</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#high-pass-band-pass-and-band-elimination-filter-design">High-Pass, Band-Pass and Band-Elimination Filter Design</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#low-pass-to-low-pass">Low-pass to low-pass</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#low-pass-to-high-pass">Low-pass to high-pass</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-9">Example 9</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#low-pass-to-band-pass">Low-pass to band-pass</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-10">Example 10</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#low-pass-to-band-stop">Low-pass to band-stop</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-11">Example 11</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">Low-pass to band-pass</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id22">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-7-1-summary">Unit 7.1 Summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-7-1-takeaways">Unit 7.1 Takeaways</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coming-next">Coming Next</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matlab-functions-introduced-in-unit-7-1">MATLAB functions introduced in Unit 7.1</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#analogue-prototype-designers">Analogue prototype designers</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-transformation-functions">Filter transformation functions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#utility-functions">Utility functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#footnotes">Footnotes</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Chris P. Jobling
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright Swansea University (2023-2024).
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  This page was created by 
<a href="https://www.swansea.ac.uk/staff/engineering/c.p.jobling/">
  Dr Chris P. Jobling
</a> 
for 
<a href="https://www.swansea.ac.uk">
  Swansea University
</a>.

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>