

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Unit 7.2: Designing Digital Filters in MATLAB and Simulink &#8212; EG-247 Digital Signal Processing</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystyles.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'filter_design/digital_filters';</script>
    <link rel="canonical" href="https://cpjobling.github.io/eg-247-textbook/filter_design/digital_filters.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="References" href="../zbib.html" />
    <link rel="prev" title="Unit 7.1: Designing Analogue Filters" href="analogue_filters.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../introduction/index.html">
  
  
  
  
  
  
    <p class="title logo__title">EG-247 Digital Signal Processing</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../introduction/index.html">
                    Unit 1: Introducing Digital Signal Processing
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Online notes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../transfer_functions/index.html">Transfer Function Analysis of Dynamic Systems</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../transfer_functions/1/concepts.html">Concept Review</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transfer_functions/2/transfer_function_basics.html">Transfer Function Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transfer_functions/3/pole_zero_analysis.html">Pole Zero Analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fourier_series/index.html">Fourier Series</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/1/trig_fseries.html">Trigonometric Fourier Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/2/exp_fs1.html">Exponential Fourier Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/3/exp_fs2.html">Computing Line Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/4/exp_fs3.html">Applications of Line Spectra</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../fourier_transform/index.html">Fourier Transform</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/1/ft1.html">Defining the Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/2/ft2.html">Fourier transforms of commonly occuring signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/3/ft3.html">Fourier Transforms for Circuit and LTI Systems Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/4/ft4.html">Introduction to Filters</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dt_systems/index.html">Sampled Data Systems</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../dt_systems/1/sampling.html">Sampling Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dt_systems/2/z_transform.html">The Z-Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dt_systems/3/i_z_transform.html">The Inverse Z-Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dt_systems/4/dt_models.html">Models of Discrete Time Systems</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dft/index.html">Discrete Fourier Transform</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../dft/1/dft.html">The Discrete Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dft/2/fft.html">The Fast-Fourier Transform</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Analogue and Digital Filter Design</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="analogue_filters.html">Unit 7.1: Designing Analogue Filters</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Unit 7.2: Designing Digital Filters in MATLAB and Simulink</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../zbib.html">Bibliography</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">In Class Worksheets</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../worksheets/index.html">Worksheets</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/worksheet1.html">Worksheet 1 Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/1/worksheet2.html">Worksheet 2 Trigonometric Fourier Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/2/worksheet3.html">Worksheet 3 Exponential Fourier Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/3/worksheet4.html">Worksheet 4 Computing Line Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_series/4/worksheet5.html">Worksheet 5 Applications of Line Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/1/worksheet6.html">Worksheet 6 Defining the Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/2/worksheet7.html">Worksheet 7 Fourier transforms of commonly occuring signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/3/worksheet8.html">Worksheet 8 Fourier Transforms for Circuit and LTI Systems Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fourier_transform/4/worksheet9.html">Worksheet 9 Introduction to Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dt_systems/3/worksheet10.html">Worksheet 10 The Inverse Z-Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dt_systems/4/worksheet11.html">Worksheet 11 Models of DT Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dft/1/worksheet12.html">Worksheet 12 The Discrete-time Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dft/2/worksheet13.html">Worksheet 13 The Fast Fourier Transform</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Homework problems</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../homework/index.html">Homework</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../homework/hw4.html">Homework 4 Fourier Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/hw5.html">Homework 5 Fourier Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/hw6.html">Homework 6: Fourier Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/hw7.html">Homework 7 Applications of the Fourier Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/hw8.html">Homework 8 Sampling Theory and the Z-Transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../homework/hw9.html">Homework 9 Inverse Z-Transform and Models of Discrete-Time Systems</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Answers to Selected Problems</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../introduction/answers.html">Worksheet 2</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../transfer_functions/1/lt_props.html">Properties of the Laplace Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transfer_functions/1/lt_table.html">Common Laplace Transform Pairs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fourier_transform/1/ft_props.html">Properties of the Fourier Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fourier_transform/1/ft_table.html">Common Fourier Transform Pairs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dt_systems/2/zt_props.html">Properties of the Z-Transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dt_systems/2/zt_table.html">Table of Z-Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup/polling_setup.html">Set Up In-Class Polling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">List of Planned Enhancements</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../setup/index.html">Setting up your own version of this book</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../transfer_functions/1/LICENSE.html">MathWorks License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/jupyter.html">About Jupyter notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/python.html">Installing Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/setup.html">Setting up your Own Jupyter-MATLAB Computing Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/matlab_kernel.html">Testing the Jupyter Matlab Kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/advanced-setup.html">Quick Start - For Experienced Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/jupyter-book.html">Setting up jupyter-book</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/cpjobling/eg-247-textbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cpjobling/eg-247-textbook/edit/master/filter_design/digital_filters.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/cpjobling/eg-247-textbook/issues/new?title=Issue%20on%20page%20%2Ffilter_design/digital_filters.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/filter_design/digital_filters.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Unit 7.2: Designing Digital Filters in MATLAB and Simulink</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#colophon">Colophon</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scope-and-background-reading">Scope and Background Reading</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started-with-simulink-for-signal-processing">Getting Started with Simulink for Signal Processing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#agenda">Agenda</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#digital-filters">Digital filters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-of-digital-filters">Classification of digital filters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#impulse-response-duration">1. Impulse response duration</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#realization">2. Realization</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-of-digital-filters">Implementation of digital filters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recursive-realization">Recursive realization</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#non-recursive-realization">Non-recursive realization</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#digital-filter-design-methods">Digital filter design methods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-impulse-invariant-method">1. The <em>impulse invariant method</em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-step-invariant-method">2. The <em>step invariant method</em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-bilinear-transformation-method">3. The <em>bilinear transformation method</em></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-bilinear-transformation">The Bilinear Transformation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#digital-frequency-response-of-the-bilinear-transformation">Digital frequency response of the bilinear transformation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-warping-of-the-bilinear-transformation">Frequency warping of the bilinear transformation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-warping">Pre-warping</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-12">Example 12</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#solution">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matlab-bilinear-function">MATLAB bilinear function</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-13">Example 13</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Solution</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matlab-functions-for-direct-digital-filter-design">MATLAB Functions for direct digital filter design</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-low-pass-filters">For Low-Pass Filters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-high-pass-filters">For High-Pass Filters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-band-pass-filters">For Band-Pass Filters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-band-elimination-filters">For Band-Elimination Filters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Example 13</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#a">13(a)</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#b">13(b)</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#c">13(c)</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#d">13(d)</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Solution</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#digital-filter-design-with-simulink">Digital Filter Design with Simulink</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-direct-form-i-realization-of-a-digital-filter">The Direct Form I Realization of a Digital Filter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-direct-form-ii-realization-of-a-digital-filter">The Direct Form II Realization of a Digital Filter</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-14">Example 14</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-series-form-realization-of-a-digital-filter">The Series Form Realization of a Digital Filter</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-15">Example 15</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-parallel-form-realization-of-a-digital-filter">The Parallel Form Realization of a Digital Filter</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-16">Example 16</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-digital-filter-design-block">The Digital Filter Design Block</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-generation">Code generation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-end">The End?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-2-1">Exercise 7.2.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-2-2">Exercise 7.2.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-2-3">Exercise 7.2.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-2-4">Exercise 7.2.4</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="unit-7-2-designing-digital-filters-in-matlab-and-simulink">
<span id="unit7-2"></span><h1>Unit 7.2: Designing Digital Filters in MATLAB and Simulink<a class="headerlink" href="#unit-7-2-designing-digital-filters-in-matlab-and-simulink" title="Permalink to this heading">#</a></h1>
<p>You can view the notes for this presentation as a webpage (<a class="reference external" href="https://cpjobling.github.io/eg-247-textbook/filter_design/digital_filters.html">HTML</a>).</p>
<section id="colophon">
<h2>Colophon<a class="headerlink" href="#colophon" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>The source code for this page is <a class="reference external" href="https://github.com/cpjobling/eg-247-textbook/blob/master/filter_design/digital_filters.md">filters/1/filters.md</a>.</p></li>
<li><p>You can view the notes for this presentation as a webpage (<a class="reference external" href="https://cpjobling.github.io/eg-247-textbook/filter_design/digital_filters.html">HTML</a>).</p></li>
<li><p>This page is downloadable as a <a class="reference external" href="https://cpjobling.github.io/eg-247-textbook/filter_design/digital_filters.pdf">PDF</a> file.</p></li>
</ul>
</section>
<section id="scope-and-background-reading">
<h2>Scope and Background Reading<a class="headerlink" href="#scope-and-background-reading" title="Permalink to this heading">#</a></h2>
<section id="getting-started-with-simulink-for-signal-processing">
<h3>Getting Started with Simulink for Signal Processing<a class="headerlink" href="#getting-started-with-simulink-for-signal-processing" title="Permalink to this heading">#</a></h3>
<p>To provide some inspiration for the power of MATLAB and Simulink for the design of digital filters, we have included the following <a class="reference external" href="https://uk.mathworks.com/support/search.html/videos/getting-started-with-simulink-for-signal-processing-1586429627003.html">video from the MathWorks</a>.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/GTpP3Agz3L8?si=X66ZSHTHrvhp6bGo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe><blockquote>
<div><p>[The] video shows you an example of designing a signal processing system using Simulink®.</p>
</div></blockquote>
<blockquote>
<div><p>You start off with a blank Simulink model and design a signal processing algorithm to predict whether it is going to be sunny or cloudy in order to optimize power generated from a solar energy grid. The video walks you through analyzing sensor signals, designing filters and finally generating code for hardware deployment.</p>
</div></blockquote>
<blockquote>
<div><p>By the end of the video, you will learn the basics of Simulink and how Model-Based Design can be used to model, simulate, test and implement real-world signal processing systems.</p>
</div></blockquote>
<p>In <a class="reference internal" href="analogue_filters.html#unit7-1"><span class="std std-ref">Unit 7.1: Designing Analogue Filters</span></a> we looked at the MATLAB tools that can be used to design prototype analogue low-pass filters of various types, and introduced the MATLAB tools that design the prototypes and map them to high-pass, band-pass and band-stop filters. We also demostrated the tools needed to visualize the frequency response of such filters.</p>
<p>A the end of this process, we will have a transfer function <span class="math notranslate nohighlight">\(H(s)\)</span> that defines the poles and zeros of an analogue filter which we now need to digitize for implementation.</p>
<p>In this unit, we will introduce one way to convert and analogue filter <span class="math notranslate nohighlight">\(H(s)\)</span> into a digital filter <span class="math notranslate nohighlight">\(H(z)\)</span> which is known as the bilinear transformation. We will give an example of a digital filter design for a second-order analogue filter.</p>
<p>We will present the tools that MATLAB provides for the direct design of digital filters.</p>
<p>We will also look at the realization of such filters and give examples as Simulink block diagrams.</p>
<p>Finally we will present the Digital Filter Design block which allows the design of a filter directly in Simulink and supports the automatic generation of C-code or VHDL for digital filter design.</p>
<p>This unit is based on Sections 11.4-11.6 of <span id="id1">[<a class="reference internal" href="../zbib.html#id7" title="Steven T. Karris. Signals and systems with MATLAB computing and Simulink modeling. Orchard Publishing, Fremont, CA., fifth edition, 2012. ISBN 9781934404232. Library call number: TK5102.9 K37 2012 LOCATE. URL: https://ebookcentral.proquest.com/lib/swansea-ebooks/detail.action?docID=3384197&amp;pq-origsite=primo.">Karris, 2012</a>]</span>.</p>
<p><strong>At the end of this unit you should be able to use the bilinear transform to convert a 2nd-order analogue proptotype into a digital filter and provide the coefficients for a block-diagram or code implementation of such a filter.</strong></p>
<p>To continue your learning we recommend that you visit the following pages on the MATLAB Documentation Platform:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://uk.mathworks.com/help/overview/signal-processing.html">Signal Processing</a> [in MATLAB]</p></li>
<li><p><a class="reference external" href="https://uk.mathworks.com/help/signal/index.html">Signal Processing Toolbox</a> - signal analysis, analogue and digital filter design</p></li>
<li><p><a class="reference external" href="https://uk.mathworks.com/help/dsp/index.html">DSP System Toolbox</a> - for designing and implementing digital filters in Simulink and for code generation.</p></li>
</ul>
</section>
</section>
<section id="agenda">
<h2>Agenda<a class="headerlink" href="#agenda" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#unit7-2-digital"><span class="std std-ref">Digital filters</span></a></p></li>
<li><p><a class="reference internal" href="#unit7-2-bilinear"><span class="std std-ref">The Bilinear Transformation</span></a></p></li>
<li><p><a class="reference internal" href="#u72-matlab-fd-tools"><span class="std std-ref">MATLAB Functions for direct digital filter design</span></a></p></li>
<li><p><a class="reference internal" href="#u72-simulink"><span class="std std-ref">Digital Filter Design with Simulink</span></a></p></li>
<li><p><a class="reference internal" href="#u72-df-design-block"><span class="std std-ref">The Digital Filter Design Block</span></a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">format</span><span class="w"> </span><span class="n">compact</span>
<span class="nb">cd</span><span class="w"> </span><span class="n">matlab</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="digital-filters">
<span id="unit7-2-digital"></span><h2>Digital filters<a class="headerlink" href="#digital-filters" title="Permalink to this heading">#</a></h2>
<p>A <em>digital filter</em> is a computational process (algorithm) that converts one sequence of numbers <span class="math notranslate nohighlight">\(x[n]\)</span> representing the input, to another sequence <span class="math notranslate nohighlight">\(y[n]\)</span> that represents the output.</p>
<p>A digital filter can be used to filter out desired bands of frequency.</p>
<p>Digital filters can also be used to perform other functions, such as integration, differentiation, and estimation.</p>
<p>The input-output <em>difference equation</em> that relates the output and input can be expressed in the discrete-time (DT) domain as a summation of the form</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-1">
<span class="eqno">(37)<a class="headerlink" href="#equation-eq-7-2-1" title="Permalink to this equation">#</a></span>\[y[n] = \sum_{i=0}^{k}b_i x[n - i]-\sum_{i=0}^{k}a_i y[n - i]\]</div>
<p>or, as a Z-transform as</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-2">
<span class="eqno">(38)<a class="headerlink" href="#equation-eq-7-2-2" title="Permalink to this equation">#</a></span>\[H(z) = \frac{Y(z)}{X(z)} = \frac{\displaystyle\sum_{i=0}^{k}b_i z^{-i}}{1 + \displaystyle\sum_{i=0}^{k}a_i z^{-i}}\]</div>
<p>Therefore, the design of a digital filter to perform a desired function, entails the determination of the coefficients <span class="math notranslate nohighlight">\(b_i\)</span> and <span class="math notranslate nohighlight">\(a_i\)</span>.</p>
<section id="classification-of-digital-filters">
<span id="unit7-2-classification"></span><h3>Classification of digital filters<a class="headerlink" href="#classification-of-digital-filters" title="Permalink to this heading">#</a></h3>
<p>Digital filters are classified in terms of the duration of the impulse response, and in terms of realization.</p>
<section id="impulse-response-duration">
<h4>1. Impulse response duration<a class="headerlink" href="#impulse-response-duration" title="Permalink to this heading">#</a></h4>
<p>a). An <em>infinite impulse response</em> (IIR) filter as an infinite number of samples in its impulse response <span class="math notranslate nohighlight">\(h[n]\)</span>.</p>
<p>b). A <em>finite impulse response</em> (FIR) filter as a finite number of samples in its impulse response <span class="math notranslate nohighlight">\(h[n]\)</span>.</p>
</section>
<section id="realization">
<h4>2. Realization<a class="headerlink" href="#realization" title="Permalink to this heading">#</a></h4>
<p>a). In a <em>recursive realization</em> digital filter, the output depends on the input and the <em>previous</em> values of the output. In a recursive digital filter, both the coefficients <span class="math notranslate nohighlight">\(b_i\)</span> and <span class="math notranslate nohighlight">\(a_i\)</span> are present.</p>
<p>b). In a <em>non-recursive realization</em> digital filter, the output depends on present and past values of the input only. In a non-recursive digital filter, only the coefficients <span class="math notranslate nohighlight">\(b_i\)</span> are present, i.e. <span class="math notranslate nohighlight">\(a_i=0\)</span>.</p>
</section>
</section>
<section id="implementation-of-digital-filters">
<h3>Implementation of digital filters<a class="headerlink" href="#implementation-of-digital-filters" title="Permalink to this heading">#</a></h3>
<section id="recursive-realization">
<h4>Recursive realization<a class="headerlink" href="#recursive-realization" title="Permalink to this heading">#</a></h4>
<p><a class="reference internal" href="#fig-u72-1"><span class="std std-numref">Fig. 14</span></a> shows a Simulink model of a third-order (3-delay element or 3-tap) recursive realization of a digital filter<a class="footnote-reference brackets" href="#u72-note-1" id="id2">1</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">recursive</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-u72-1">
<a class="reference internal image-reference" href="../_images/recursive.png"><img alt="Picture of a digital filter realization in Simulink" src="../_images/recursive.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">Recursive digital filter realization in Simulink</span><a class="headerlink" href="#fig-u72-1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Download Simulink model <a class="reference download internal" download="" href="../_downloads/30da42faf2ff15d17921d08610eaf622/nonrecursive.slx"><span class="xref download myst">recursive.slx</span></a></p>
</section>
<section id="non-recursive-realization">
<h4>Non-recursive realization<a class="headerlink" href="#non-recursive-realization" title="Permalink to this heading">#</a></h4>
<p><a class="reference internal" href="#fig-u72-2"><span class="std std-numref">Fig. 15</span></a> shows a Simulink model of a third-order non-recursive realization of a digital filter<a class="footnote-reference brackets" href="#u72-note-2" id="id3">2</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">nonrecursive</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-u72-2">
<a class="reference internal image-reference" href="../_images/nonrecursive.png"><img alt="Picture of a digital filter realization in Simulink" src="../_images/nonrecursive.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">Non-recursive digital filter realization in Simulink</span><a class="headerlink" href="#fig-u72-2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Download Simulink model <a class="reference download internal" download="" href="../_downloads/30da42faf2ff15d17921d08610eaf622/nonrecursive.slx"><span class="xref download myst">nonrecursive.slx</span></a></p>
<p>Generally, IIR filters are implemented by a recursive realization, and FIR filters are implemented by a non-recursive implementation.</p>
</section>
</section>
<section id="digital-filter-design-methods">
<h3>Digital filter design methods<a class="headerlink" href="#digital-filter-design-methods" title="Permalink to this heading">#</a></h3>
<p>As demonstrated in <a class="reference internal" href="analogue_filters.html#unit7-1"><span class="std std-ref">Unit 7.1: Designing Analogue Filters</span></a>, filter-design methods have been established and analogue prototypes have been published. Thus, we can choose an appropriate analogue prototype to satisfy the requirements.</p>
<p>Transformation methods are also available to transform analogue prototypes into an equivalent digital filter.</p>
<p>Three commonly used transformation methods are</p>
<section id="the-impulse-invariant-method">
<h4>1. The <em>impulse invariant method</em><a class="headerlink" href="#the-impulse-invariant-method" title="Permalink to this heading">#</a></h4>
<p>Produces a digital filter <span class="math notranslate nohighlight">\(H(z)\)</span> whose impulse response consists of the sampled values of the impulse response of the equivalent analogue filter <span class="math notranslate nohighlight">\(H(s)\)</span>.</p>
<p>This is implemented in MATLAB by the system transformation function: <code class="docutils literal notranslate"><span class="pre">Hz</span> <span class="pre">=</span> <span class="pre">c2d(Hs,Ts,'impulse')</span></code> where <code class="docutils literal notranslate"><span class="pre">Hs</span></code> is the analogue transfer function <span class="math notranslate nohighlight">\(H(s)\)</span>, <code class="docutils literal notranslate"><span class="pre">Ts</span></code> is the sampling period, and <code class="docutils literal notranslate"><span class="pre">Hz</span></code> is the equivalent <span class="math notranslate nohighlight">\(H(z)\)</span>.</p>
</section>
<section id="the-step-invariant-method">
<h4>2. The <em>step invariant method</em><a class="headerlink" href="#the-step-invariant-method" title="Permalink to this heading">#</a></h4>
<p>Produces a digital filter <span class="math notranslate nohighlight">\(H(z)\)</span> whose step response consists of the sampled values of the step response of the equivalent analogue filter <span class="math notranslate nohighlight">\(H(s)\)</span>.</p>
</section>
<section id="the-bilinear-transformation-method">
<h4>3. The <em>bilinear transformation method</em><a class="headerlink" href="#the-bilinear-transformation-method" title="Permalink to this heading">#</a></h4>
<p>This uses the transformation<a class="footnote-reference brackets" href="#u72-note-3" id="id4">3</a></p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-3">
<span class="eqno">(39)<a class="headerlink" href="#equation-eq-7-2-3" title="Permalink to this equation">#</a></span>\[s = \frac{2}{T_s}\cdot\frac{z-1}{z+1}\]</div>
<p>to transform the left-half of the <span class="math notranslate nohighlight">\(s\)</span>-plane into the interior of the unit circle in the <span class="math notranslate nohighlight">\(z\)</span>-plane.</p>
<p>In this unit, we will discuss, <em>and assess</em>, only the use of the blinear transformation.</p>
</section>
</section>
</section>
<section id="the-bilinear-transformation">
<span id="unit7-2-bilinear"></span><h2>The Bilinear Transformation<a class="headerlink" href="#the-bilinear-transformation" title="Permalink to this heading">#</a></h2>
<p>We recall from <a class="reference internal" href="../dt_systems/2/z_transform.html#s-to-z"><span class="std std-ref">Relationship Between the Laplace and Z-Transform</span></a> that since <span class="math notranslate nohighlight">\(z = e^{sT_s}\)</span>, <span class="math notranslate nohighlight">\(s = 1/T_s \log_e z\)</span>, then a DT transfer function <span class="math notranslate nohighlight">\(H(z)\)</span> can be determined from a CT transfer function <span class="math notranslate nohighlight">\(H(s)\)</span> using the mapping:</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-4">
<span class="eqno">(40)<a class="headerlink" href="#equation-eq-7-2-4" title="Permalink to this equation">#</a></span>\[H(z) = \left.H(s)\right|_{s = \frac{1}{T_s} \log_e z}\]</div>
<p>But the relation <span class="math notranslate nohighlight">\(s = 1/T_s \log_e z\)</span> is a multi-valued transformation, and as such, cannot be used to derive a rational polynomial in <span class="math notranslate nohighlight">\(z\)</span>.</p>
<p>It can be approximated as</p>
<div class="math notranslate nohighlight">
\[s = \frac{1}{T_s} \log_e z = \frac{2}{T_s} \left[\frac{z-1}{z+1}  + \frac{1}{3} \left(\frac{z-1}{z+1} \right)^3 + \frac{1}{5} \left(\frac{z-1}{z+1} \right)^5 + \frac{1}{7} \left(\frac{z-1}{z+1} \right)^7 + \cdots\right]\]</div>
<div class="math notranslate nohighlight" id="equation-eq-7-2-5">
<span class="eqno">(41)<a class="headerlink" href="#equation-eq-7-2-5" title="Permalink to this equation">#</a></span>\[s \approx \frac{2}{T_s} \cdot \frac{z-1}{z+1} \]</div>
<p>Substitution of <a class="reference internal" href="#equation-eq-7-2-5">(41)</a> into <a class="reference internal" href="#equation-eq-7-2-4">(40)</a> yields</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-6">
<span class="eqno">(42)<a class="headerlink" href="#equation-eq-7-2-6" title="Permalink to this equation">#</a></span>\[H(z) = \left.G(s)\right|_{s = \frac{2}{T_s} \cdot \frac{z-1}{z+1}} \]</div>
<section id="digital-frequency-response-of-the-bilinear-transformation">
<span id="unit7-2-freqz"></span><h3>Digital frequency response of the bilinear transformation<a class="headerlink" href="#digital-frequency-response-of-the-bilinear-transformation" title="Permalink to this heading">#</a></h3>
<p>The digital frequency response (using <span class="math notranslate nohighlight">\(\omega_d\)</span> on the unit circle in the <span class="math notranslate nohighlight">\(z\)</span>-plane) is obtained by the substitution <span class="math notranslate nohighlight">\(z = e^{j\omega_d T_s}\)</span>, giving</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-7">
<span class="eqno">(43)<a class="headerlink" href="#equation-eq-7-2-7" title="Permalink to this equation">#</a></span>\[H\left(e^{j\omega_d T_s}\right) = H\left(\frac{2}{T_s} \cdot \frac{e^{j\omega_d T_s } - 1}{e^{j\omega_d T_s } + 1} \right) \]</div>
<p>Since the <span class="math notranslate nohighlight">\(z\to s\)</span> transformation maps the unit circle on the <span class="math notranslate nohighlight">\(z\)</span>-plane into the <span class="math notranslate nohighlight">\(j\omega\)</span> axis on the <span class="math notranslate nohighlight">\(s\)</span>-plane, the quantity</p>
<div class="math notranslate nohighlight">
\[\frac{2}{T_s} \cdot \frac{e^{j\omega_d T_s } - 1}{e^{j\omega_d T_s} + 1}\]</div>
<p>and <span class="math notranslate nohighlight">\(j\omega\)</span> must be equal to some point <span class="math notranslate nohighlight">\(\omega = \omega_a\)</span> on the <span class="math notranslate nohighlight">\(j\omega\)</span> axis.</p>
<p>That is,</p>
<div class="math notranslate nohighlight">
\[j\omega_a = \frac{2}{T_s} \cdot \frac{e^{j\omega_d T_s } - 1}{e^{j\omega_d T_s } + 1}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[\omega_a = \frac{1}{J} \cdot \frac{2}{T_s} \cdot \frac{e^{j\omega_d T_s } - 1}{e^{j\omega_d T_s } + 1} = \frac{2}{T_s}\cdot \frac{1/(j2)}{1/2} \cdot \frac{e^{j\omega_d T_s/2} - e^{-j\omega_d T_s/2}}{e^{j\omega_d T_s/2} + e^{-j\omega_d T_s/2}}\]</div>
<div class="math notranslate nohighlight">
\[\omega_a = \frac{2}{T_s} \cdot \frac{\sin\left(\omega_d T_s\right)/2}{\cos\left(\omega_d T_s\right)/2} \]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-8">
<span class="eqno">(44)<a class="headerlink" href="#equation-eq-7-2-8" title="Permalink to this equation">#</a></span>\[\omega_a = \frac{2}{T_s} \tan\left(\frac{\omega_d T_s}{2} \right)\]</div>
</section>
<section id="frequency-warping-of-the-bilinear-transformation">
<span id="u72-warping"></span><h3>Frequency warping of the bilinear transformation<a class="headerlink" href="#frequency-warping-of-the-bilinear-transformation" title="Permalink to this heading">#</a></h3>
<p>We see that the analogue frequency to digital frequency transformation results in a non-linear mapping; this condition is know as <em>warping</em>.</p>
<p>For instance, the frequency range <span class="math notranslate nohighlight">\(0 \lt \omega_a \le \infty\)</span> the analogue frequency is warped into the range <span class="math notranslate nohighlight">\(0 \le \omega_d \le \pi/T_s\)</span> in digital frequency.</p>
<p>To express <span class="math notranslate nohighlight">\(\omega_d\)</span> in terms of <span class="math notranslate nohighlight">\(\omega_a\)</span>, we rewrite <a class="reference internal" href="#equation-eq-7-2-8">(44)</a> as</p>
<div class="math notranslate nohighlight">
\[\tan\left(\frac{\omega_d T_s}{2} \right) = \frac{\omega_a T_s}{2} \]</div>
<p>Then,</p>
<div class="math notranslate nohighlight">
\[\omega_d T_s  = 2 \tan^{-1}\left(\frac{\omega_a T_s}{2}\right) \]</div>
<p>and for small <span class="math notranslate nohighlight">\(\omega_a T_s/2\)</span>,</p>
<div class="math notranslate nohighlight">
\[\tan^{-1}\left(\frac{\omega_a T_s}{2}\right) \approx \frac{\omega_a T_s}{2}\]</div>
<p>Therefore,</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-9">
<span class="eqno">(45)<a class="headerlink" href="#equation-eq-7-2-9" title="Permalink to this equation">#</a></span>\[\omega_d T_s \approx 2 \left(\frac{\omega_a T_s}{2}\right) \approx \omega_a T_s\]</div>
<p>that is, for small frequencies,</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-10">
<span class="eqno">(46)<a class="headerlink" href="#equation-eq-7-2-10" title="Permalink to this equation">#</a></span>\[\omega_d \approx \omega_a\]</div>
<p>In MATLAB, <span class="math notranslate nohighlight">\(z\)</span> is a function of normalized frequency and thus the range of frequencies in <span class="math notranslate nohighlight">\(H(z)\)</span> is from <span class="math notranslate nohighlight">\(0 \to \pi\)</span>. Then <a class="reference internal" href="#equation-eq-7-2-9">(45)</a>, when used with MATLAB, becomes</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-11">
<span class="eqno">(47)<a class="headerlink" href="#equation-eq-7-2-11" title="Permalink to this equation">#</a></span>\[\omega_d \approx \frac{\omega_a T_s}{\pi} \]</div>
</section>
<section id="pre-warping">
<span id="u72-pre-warping"></span><h3>Pre-warping<a class="headerlink" href="#pre-warping" title="Permalink to this heading">#</a></h3>
<p>The effect of warping can be eliminated by <em>pre-warping</em> the analogue filter prior to the application of the bilinear transformation. This is acomplished with the use of <a class="reference internal" href="#equation-eq-7-2-8">(44)</a>.</p>
<section id="example-12">
<span id="u72-ex-12"></span><h4>Example 12<a class="headerlink" href="#example-12" title="Permalink to this heading">#</a></h4>
<p>Compute the transfer function <span class="math notranslate nohighlight">\(H(z)\)</span> of a low-pass filter with <span class="math notranslate nohighlight">\(3\)</span> dB cutoff frequency at <span class="math notranslate nohighlight">\(20\)</span> Hz, and attenuation of at least <span class="math notranslate nohighlight">\(10\)</span> dB for frequencies greater than <span class="math notranslate nohighlight">\(40\)</span> Hz. The sampling frequency <span class="math notranslate nohighlight">\(f_s = 200\)</span> Hz. Compare the magnitude plot with that obtained by a low-pass analogue filter with the same specifications.</p>
<section id="solution">
<h5>Solution<a class="headerlink" href="#solution" title="Permalink to this heading">#</a></h5>
<p>We will apply the bilinear transformation. We arbitrarily choose a second-order Butterworth filter which will meet the stop-band specification.</p>
<p>The transfer function <span class="math notranslate nohighlight">\(H(s)\)</span> of the analogue low-pass filter with normalized frequency at <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> rad/s is found with the MATLAB <code class="docutils literal notranslate"><span class="pre">buttap</span></code> function as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttap</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">zp2tf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>b =
     0     0     1
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a =
    1.0000    1.4142    1.0000
</pre></div>
</div>
</div>
</div>
<p>Thus, the transfer function with noramlized frequency, denoted as <span class="math notranslate nohighlight">\(H_n(s)\)</span>, is</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-12">
<span class="eqno">(49)<a class="headerlink" href="#equation-eq-7-2-12" title="Permalink to this equation">#</a></span>\[H_n(s) = \frac{1}{s^2 + 1.414 s + 1} \]</div>
<p>Now, we must transform this transfer function to another with actual cutoff frequency at <span class="math notranslate nohighlight">\(20\)</span> Hz. We donote it as <span class="math notranslate nohighlight">\(H_a(s)\)</span>.</p>
<p>We will first pre-warp the analogue frequency which by relation <a class="reference internal" href="#equation-eq-7-2-8">(44)</a>, us related to the digital frequency as</p>
<div class="math notranslate nohighlight">
\[\omega_a = \frac{2}{T_s}\tan\left(\frac{\omega_d T_s}{2} \right)\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[T_s = \frac{1}{f_s} = \frac{1}{200}.\]</div>
<p>Denoting the analogue cutoff (3 dB) frequency as <span class="math notranslate nohighlight">\(\omega_{ac}\)</span>, we obtain</p>
<div class="math notranslate nohighlight">
\[\omega_{ac} = 400 \tan \left(\frac{2\pi\times 20}{2\times 200} \right) = 400\tan\left(0.1\pi\right) \approx 130\,\mathrm{rad/s}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[f_{ac} = \frac{130}{2\pi} \approx 20.69\,\mathrm{Hz}.\]</div>
<p>As expected from relation <a class="reference internal" href="#equation-eq-7-2-10">(46)</a>, this frequency is very close to the discrete-time frequency <span class="math notranslate nohighlight">\(f_{dc} = 20\)</span> Hz, and thus from <a class="reference internal" href="#equation-eq-7-2-12">(49)</a>,</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-12">
<span class="eqno">(49)<a class="headerlink" href="#equation-eq-7-2-12" title="Permalink to this equation">#</a></span>\[H_a(s) \approx H_n(s) = \frac{1}{s^2 + 1.414 s + 1} \]</div>
<p>Relation <a class="reference internal" href="#equation-eq-7-2-12">(49)</a> applies only when the cutoff frequency is normalized to <span class="math notranslate nohighlight">\(\omega_c = 1\)</span> rad/s.</p>
<p>If <span class="math notranslate nohighlight">\(\omega_c \ne 1\)</span>, we must scale the transfer function in accordance with relation <a class="reference internal" href="analogue_filters.html#equation-eq-7-1-15">(33)</a>, that is,</p>
<div class="math notranslate nohighlight">
\[H(s)_\mathrm{actual} = H\left(\frac{s}{\omega_\mathrm{actual}} \right) \]</div>
<p>For this example, <span class="math notranslate nohighlight">\(\omega_\mathrm{actual} = 130\)</span> rad/s, and thus we replace <span class="math notranslate nohighlight">\(s\)</span> with <span class="math notranslate nohighlight">\(s/130\)</span> and we obtain</p>
<div class="math notranslate nohighlight">
\[H_a(s) = \frac{1}{\left(s/130\right)^2 + 1.414s/130 + 1} \]</div>
<p>We will use MATLAB to simplify this expression</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">syms</span><span class="w"> </span><span class="s">s</span><span class="p">;</span><span class="w"> </span><span class="n">simplifyFraction</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="n">s</span><span class="o">/</span><span class="mi">130</span><span class="p">)</span>^<span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.414</span><span class="o">*</span><span class="n">s</span><span class="o">/</span><span class="mi">130</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="mi">845000</span><span class="o">/</span><span class="mi">50</span>
<span class="mi">9191</span><span class="o">/</span><span class="mi">50</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans =
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>845000/(50*s^2 + 9191*s + 845000)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans =
       16900
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans =
  183.8200
</pre></div>
</div>
</div>
</div>
<p>Then,</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-13">
<span class="eqno">(50)<a class="headerlink" href="#equation-eq-7-2-13" title="Permalink to this equation">#</a></span>\[H_a(s) = \frac{845000}{50s^2 + 9191s + 845000} = \frac{16900}{s^2 + 183.82s + 16900} \]</div>
<p>and making the substitution of <span class="math notranslate nohighlight">\(s = (2/T_s)(z -1)/(z + 1) = 400(z-1)/(z + 1)\)</span> we obtain</p>
<div class="math notranslate nohighlight">
\[H(z) = \frac{16900}{\left(400\cdot \frac{z-1}{z + 1}\right)^2 + \frac{183.82\times 400(z-1)}{(z + 1)} + 16900} \]</div>
<p>We use the MATLAB code below to simplify this expression</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">syms</span><span class="w"> </span><span class="s">z</span><span class="p">;</span><span class="w"> </span><span class="nb">simplify</span><span class="p">(</span><span class="mi">16900</span><span class="o">/</span><span class="p">((</span><span class="mi">400</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>^<span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">183.82</span><span class="o">*</span><span class="mi">400</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">16900</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans =
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(4225*(z + 1)^2)/(62607*z^2 - 71550*z + 25843)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">expand</span><span class="p">(</span><span class="mi">4225</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>^<span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ans =
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4225*z^2 + 8450*z + 4225
</pre></div>
</div>
</div>
</div>
<p>and thus</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-14">
<span class="eqno">(51)<a class="headerlink" href="#equation-eq-7-2-14" title="Permalink to this equation">#</a></span>\[H(z) = \frac{4225z^2 + 8450z + 4225}{62607z^2 - 71550z + 25843} \]</div>
<p>We will used the MATLAB <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/freqz.html"><code class="docutils literal notranslate"><span class="pre">freqz</span></code></a> function to plot the magnitude of <span class="math notranslate nohighlight">\(H(z)\)</span>, but we must first express it in negative powers of <span class="math notranslate nohighlight">\(z\)</span>.</p>
<p>Dividing each term of <a class="reference internal" href="#equation-eq-7-2-14">(51)</a> by <span class="math notranslate nohighlight">\(62607z^2\)</span>, we obtain</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-15">
<span class="eqno">(52)<a class="headerlink" href="#equation-eq-7-2-15" title="Permalink to this equation">#</a></span>\[\frac{0.0675 + 0.1350z^{-1} + 0.0675z^{-2}}{1 - 1.1428z^{-1} + 0.4128 z^{-2}}\]</div>
<p>The MATLAB script below will generate <span class="math notranslate nohighlight">\(H(z)\)</span> and will plot the magnitude of this transfer function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">az</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w">  </span><span class="o">-</span><span class="mf">1.1428</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4128</span><span class="p">];</span><span class="w"> </span><span class="n">bz</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.0675</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1350</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0675</span><span class="p">];</span><span class="w"> </span><span class="n">fs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">200</span><span class="p">;</span><span class="w"> </span><span class="n">fc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span>
<span class="p">[</span><span class="n">Hz</span><span class="p">,</span><span class="w"> </span><span class="n">wT</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">freqz</span><span class="p">(</span><span class="n">bz</span><span class="p">,</span><span class="n">az</span><span class="p">,</span><span class="n">fc</span><span class="p">,</span><span class="n">fs</span><span class="p">);</span>
<span class="nb">semilogx</span><span class="p">(</span><span class="n">wT</span><span class="p">,</span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Hz</span><span class="p">)));</span><span class="w"> </span><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency in Hz - log scale&#39;</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude (dB)&#39;</span><span class="p">),</span><span class="w"> </span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;Digital Low-Pass Filter. Example 12&#39;</span><span class="p">),</span><span class="nb">grid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/db6686943cbb3391b245752bb2ece6405d9a91f049e59cd5068e0fa350116992.png" src="../_images/db6686943cbb3391b245752bb2ece6405d9a91f049e59cd5068e0fa350116992.png" />
</div>
</div>
<p>We now plot the analogue equivalent to compare the digital to the analogue frequency response.</p>
<p>The MATLAB script below produces the desired plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttap</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">zp2tf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">);</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">100</span><span class="p">;</span><span class="w"> </span><span class="n">fc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">20</span><span class="p">;</span><span class="w"> </span><span class="p">[</span><span class="n">bn</span><span class="p">,</span><span class="n">an</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">lp2lp</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">fc</span><span class="p">);</span>
<span class="n">Hs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">freqs</span><span class="p">(</span><span class="n">bn</span><span class="p">,</span><span class="n">an</span><span class="p">,</span><span class="n">f</span><span class="p">);</span>
<span class="nb">semilogx</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="o">*</span><span class="nb">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">Hs</span><span class="p">))),</span><span class="w"> </span><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency in Hz - log scale&#39;</span><span class="p">)</span>
<span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude (dB)&#39;</span><span class="p">),</span><span class="w"> </span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;Analogue Low-Pass Filter. Example 12&#39;</span><span class="p">),</span><span class="nb">grid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c2bece196ae8d4a57c577f139cdd90d798612e48b7800e15ab4018c9135988fc.png" src="../_images/c2bece196ae8d4a57c577f139cdd90d798612e48b7800e15ab4018c9135988fc.png" />
</div>
</div>
<p>Comparing the digital filter plot with the equivalent analogue filter plot, we observe that the magnitude is greater than <span class="math notranslate nohighlight">\(-3\)</span> dB for frequencies less than <span class="math notranslate nohighlight">\(20\)</span> rad/s, and is smaller than <span class="math notranslate nohighlight">\(-10\)</span> dB for frequencies greater than <span class="math notranslate nohighlight">\(40\)</span> Hz. Therefore, both the digital and analogue low-pass filters meet the specified requirements.<a class="footnote-reference brackets" href="#u72-note-4" id="id5">4</a></p>
</section>
</section>
</section>
<section id="matlab-bilinear-function">
<span id="u72-matlab-bilinear"></span><h3>MATLAB bilinear function<a class="headerlink" href="#matlab-bilinear-function" title="Permalink to this heading">#</a></h3>
<p>An analogue filter transfer function can be mapped to a digital transfer function directly with the MATLAB <a class="reference external" href="https://uk.mathworks.com/help/signal/ref/bilinear.html"><code class="docutils literal notranslate"><span class="pre">bilinear</span></code></a> function. The procedure is illustrated with the following example.</p>
<section id="example-13">
<span id="u72-ex-13"></span><h4>Example 13<a class="headerlink" href="#example-13" title="Permalink to this heading">#</a></h4>
<p>Use the MATLAB <code class="docutils literal notranslate"><span class="pre">bilinear</span></code> function to derive the low-pass digital transfer function <span class="math notranslate nohighlight">\(H(z)\)</span> from a second-order Butterworth analogue filter with a <span class="math notranslate nohighlight">\(3\)</span> dB cutoff frequency at <span class="math notranslate nohighlight">\(50\)</span> Hz, and sample rate <span class="math notranslate nohighlight">\(f_s = 500\)</span> Hz.</p>
<section id="id6">
<h5>Solution<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h5>
<p>We will use the following MATLAB script to produce the desired digital filter function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttap</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="p">[</span><span class="n">num</span><span class="p">,</span><span class="n">den</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">zp2tf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">k</span><span class="p">);</span><span class="w"> </span><span class="n">fc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span><span class="w"> </span><span class="n">wc</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">fc</span><span class="p">;</span>
<span class="p">[</span><span class="n">num1</span><span class="p">,</span><span class="n">den1</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">lp2lp</span><span class="p">(</span><span class="n">num</span><span class="p">,</span><span class="n">den</span><span class="p">,</span><span class="n">wc</span><span class="p">);</span>
<span class="n">fs</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">500</span><span class="p">;</span><span class="w"> </span><span class="p">[</span><span class="n">numd</span><span class="p">,</span><span class="n">dend</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">bilinear</span><span class="p">(</span><span class="n">num1</span><span class="p">,</span><span class="w"> </span><span class="n">den1</span><span class="p">,</span><span class="w"> </span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>numd =
    0.0640    0.1279    0.0640
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dend =
    1.0000   -1.1683    0.4241
</pre></div>
</div>
</div>
</div>
<p>Therefore, the transfer function <span class="math notranslate nohighlight">\(H(z)\)</span> for this filter is</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-16">
<span class="eqno">(54)<a class="headerlink" href="#equation-eq-7-2-16" title="Permalink to this equation">#</a></span>\[H(z) = \frac{0.0640 z^2  +  0.1279 z +   0.0640}{z^2   -1.1683 z +    0.4241} = \frac{0.0640  +  0.1279 z^{-1} +   0.0640 z^{-2}}{1   -1.1683 z^{-1} +    0.4241 z^{-2}}\]</div>
</section>
</section>
</section>
</section>
<section id="matlab-functions-for-direct-digital-filter-design">
<span id="u72-matlab-fd-tools"></span><h2>MATLAB Functions for direct digital filter design<a class="headerlink" href="#matlab-functions-for-direct-digital-filter-design" title="Permalink to this heading">#</a></h2>
<p>MATLAB provides us with a suite of functions that we need to design digital filters using analogue prototypes. These are listed below.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> = order of the filter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Wn</span></code> = normalized cutoff frequency</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Rp</span></code> = pass band ripple</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Rs</span></code> = stop band ripple</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> = <span class="math notranslate nohighlight">\(B(z)\)</span>, i.e. the numerator of the discrete transfer function <span class="math notranslate nohighlight">\(H(z) = B(z)/A(z)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">A</span></code> = <span class="math notranslate nohighlight">\(A(z)\)</span>, i.e. the denominator of the discrete transfer function <span class="math notranslate nohighlight">\(H(z)\)</span></p></li>
</ul>
<p>The MathWorks also provides a catalogue of filter design tools with examples in the <a class="reference external" href="https://uk.mathworks.com/help/signal/ug/filter-design-gallery.html">Filter Design Gallery</a>.</p>
<section id="for-low-pass-filters">
<span id="u72-fd-lp"></span><h3>For Low-Pass Filters<a class="headerlink" href="#for-low-pass-filters" title="Permalink to this heading">#</a></h3>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Wn</span><span class="p">)</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Rp</span><span class="p">,</span><span class="n">Wn</span><span class="p">)</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Rs</span><span class="p">,</span><span class="n">Wn</span><span class="p">)</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Rp</span><span class="p">,</span><span class="n">Rs</span><span class="p">,</span><span class="n">Wn</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="for-high-pass-filters">
<span id="u72-fd-hp"></span><h3>For High-Pass Filters<a class="headerlink" href="#for-high-pass-filters" title="Permalink to this heading">#</a></h3>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Wn</span><span class="p">,</span><span class="s">&#39;high&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Rp</span><span class="p">,</span><span class="n">Wn</span><span class="p">,</span><span class="s">&#39;high&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Rs</span><span class="p">,</span><span class="n">Wn</span><span class="p">,</span><span class="s">&#39;high&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">rp</span><span class="p">,</span><span class="n">Rs</span><span class="p">,</span><span class="n">Wn</span><span class="p">,</span><span class="s">&#39;high&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="for-band-pass-filters">
<span id="u72-fd-bp"></span><h3>For Band-Pass Filters<a class="headerlink" href="#for-band-pass-filters" title="Permalink to this heading">#</a></h3>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,[</span><span class="n">Wn1</span><span class="p">,</span><span class="n">Wn2</span><span class="p">])</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Rp</span><span class="p">,[</span><span class="n">Wn1</span><span class="p">,</span><span class="n">Wn2</span><span class="p">])</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Rs</span><span class="p">,[</span><span class="n">Wn1</span><span class="p">,</span><span class="n">Wn2</span><span class="p">])</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Rp</span><span class="p">,</span><span class="n">Rs</span><span class="p">,[</span><span class="n">Wn1</span><span class="p">,</span><span class="n">Wn2</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="for-band-elimination-filters">
<span id="u72-fd-sb"></span><h3>For Band-Elimination Filters<a class="headerlink" href="#for-band-elimination-filters" title="Permalink to this heading">#</a></h3>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,[</span><span class="n">Wn1</span><span class="p">,</span><span class="n">Wn2</span><span class="p">],</span><span class="s">&#39;stop&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Rp</span><span class="p">,[</span><span class="n">Wn1</span><span class="p">,</span><span class="n">Wn2</span><span class="p">],</span><span class="s">&#39;stop&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Rs</span><span class="p">,[</span><span class="n">Wn1</span><span class="p">,</span><span class="n">Wn2</span><span class="p">],</span><span class="s">&#39;stop&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="n">A</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Rp</span><span class="p">,</span><span class="n">Rs</span><span class="p">,[</span><span class="n">Wn1</span><span class="p">,</span><span class="n">Wn2</span><span class="p">],</span><span class="s">&#39;stop&#39;</span><span class="p">)</span>
</pre></div>
</div>
<section id="id7">
<span id="id8"></span><h4>Example 13<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h4>
<p>The transfer functions <a class="reference internal" href="#equation-eq-7-2-16">(54)</a> through <a class="reference internal" href="#equation-eq-7-2-19">(57)</a>, describe different types of digital filters. Use the MATLAB <code class="docutils literal notranslate"><span class="pre">freqz</span></code> commmand to plot the magnitude versus radian frequency. What types of filter does each transfer function represent? What classes of filter are they?</p>
<section id="a">
<h5>13(a)<a class="headerlink" href="#a" title="Permalink to this heading">#</a></h5>
<div class="math notranslate nohighlight" id="equation-eq-7-2-16">
<span class="eqno">(54)<a class="headerlink" href="#equation-eq-7-2-16" title="Permalink to this equation">#</a></span>\[H_1(z) = \frac{\left(2.8982 + 8.6946z^{-1} + 8.6946z^{-2} + 2.8982z^{-3}\right)\cdot 10^{-3}}{1 - 2.3741z^{-1} + 1.9294z^{-2} - 0.5321z^{-3}} \]</div>
</section>
<section id="b">
<h5>13(b)<a class="headerlink" href="#b" title="Permalink to this heading">#</a></h5>
<div class="math notranslate nohighlight" id="equation-eq-7-2-17">
<span class="eqno">(58)<a class="headerlink" href="#equation-eq-7-2-17" title="Permalink to this equation">#</a></span>\[H_2(z) = \frac{0.5276 - 1.5828z^{-1} + 1.5828z^{-2} - 0.5276z^{-3}}{1 - 1.7600z^{-1} + 1.1829z^{-2} - 0.2781z^{-3}} \]</div>
</section>
<section id="c">
<h5>13(c)<a class="headerlink" href="#c" title="Permalink to this heading">#</a></h5>
<div class="math notranslate nohighlight" id="equation-eq-7-2-18">
<span class="eqno">(59)<a class="headerlink" href="#equation-eq-7-2-18" title="Permalink to this equation">#</a></span>\[H_3(z) = \frac{\left(6.8482 - 13.6964z^{-2} + 6.8482z^{-4}\right)\cdot 10^{-4}}{1 + 3.3033z^{-1} + 4.5244z^{-2} + 3.1390z^{-3} + 0.9603z^{-4}}\]</div>
</section>
<section id="d">
<h5>13(d)<a class="headerlink" href="#d" title="Permalink to this heading">#</a></h5>
<div class="math notranslate nohighlight" id="equation-eq-7-2-19">
<span class="eqno">(57)<a class="headerlink" href="#equation-eq-7-2-19" title="Permalink to this equation">#</a></span>\[H_4(z) = \frac{0.9270-1.2079z^{-1}+0.9270z^{-2}}{1-1.2079z^{-1}+0.8541z^{-2}} \]</div>
</section>
<section id="id9">
<h5>Solution<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h5>
<p>The MATLAB script to plot each of the transfer functions of <a class="reference internal" href="#equation-eq-7-2-16">(54)</a> through <a class="reference internal" href="#equation-eq-7-2-19">(57)</a>, is given below where N = 512, i.e. the default value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">b1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">2.8982</span><span class="p">,</span><span class="w"> </span><span class="mf">8.6946</span><span class="p">,</span><span class="w"> </span><span class="mf">8.6946</span><span class="p">,</span><span class="w"> </span><span class="mf">2.8982</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span>^<span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">);</span><span class="w"> </span><span class="n">a1</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">2.3741</span><span class="p">,</span><span class="w"> </span><span class="mf">1.9294</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.5321</span><span class="p">];</span>
<span class="p">[</span><span class="n">H1z</span><span class="p">,</span><span class="n">w1T</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">freqz</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="n">a1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">b2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.5276</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1.5828</span><span class="p">,</span><span class="w"> </span><span class="mf">1.5828</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.5276</span><span class="p">];</span><span class="w"> </span><span class="n">a2</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1.7600</span><span class="p">,</span><span class="w"> </span><span class="mf">1.1829</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.2781</span><span class="p">];</span>
<span class="p">[</span><span class="n">H2z</span><span class="p">,</span><span class="n">w2T</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">freqz</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span><span class="w"> </span><span class="n">a2</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">b3</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">6.8482</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">13.6964</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">6.8482</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span>^<span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">);</span><span class="w"> </span><span class="n">a3</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mf">3.2033</span><span class="p">,</span><span class="w"> </span><span class="mf">4.5244</span><span class="p">,</span><span class="w"> </span><span class="mf">3.1390</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9603</span><span class="p">];</span>
<span class="p">[</span><span class="n">H3z</span><span class="p">,</span><span class="n">w3T</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">freqz</span><span class="p">(</span><span class="n">b3</span><span class="p">,</span><span class="w"> </span><span class="n">a3</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">b4</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mf">0.9270</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1.2079</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9270</span><span class="p">];</span><span class="w"> </span><span class="n">a4</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">1.2079</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8541</span><span class="p">];</span>
<span class="p">[</span><span class="n">H4z</span><span class="p">,</span><span class="n">w4T</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">freqz</span><span class="p">(</span><span class="n">b4</span><span class="p">,</span><span class="w"> </span><span class="n">a4</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Now do the plots</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">clf</span><span class="p">;</span><span class="w"> </span><span class="c">% clear the current figure</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">),</span><span class="w"> </span><span class="nb">semilogx</span><span class="p">(</span><span class="n">w1T</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">H1z</span><span class="p">)),</span><span class="nb">axis</span><span class="p">([</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">]),</span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;Filter for H1(z)&#39;</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">),</span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude&#39;</span><span class="p">),</span><span class="nb">grid</span>
<span class="c">%</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">),</span><span class="w"> </span><span class="nb">semilogx</span><span class="p">(</span><span class="n">w2T</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">H2z</span><span class="p">)),</span><span class="nb">axis</span><span class="p">([</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">]),</span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;Filter for H2(z)&#39;</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">),</span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude&#39;</span><span class="p">),</span><span class="nb">grid</span>
<span class="c">%</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">),</span><span class="w"> </span><span class="nb">semilogx</span><span class="p">(</span><span class="n">w3T</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">H3z</span><span class="p">)),</span><span class="nb">axis</span><span class="p">([</span><span class="mi">1</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">]),</span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;Filter for H3(z)&#39;</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">),</span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude&#39;</span><span class="p">),</span><span class="nb">grid</span>
<span class="c">%</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">),</span><span class="w"> </span><span class="nb">semilogx</span><span class="p">(</span><span class="n">w4T</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">H4z</span><span class="p">)),</span><span class="nb">axis</span><span class="p">([</span><span class="mf">0.1</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="p">]),</span><span class="nb">title</span><span class="p">(</span><span class="s">&#39;Filter for H4(z)&#39;</span><span class="p">)</span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">),</span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Magnitude&#39;</span><span class="p">),</span><span class="nb">grid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b5881c6ea206091c18da806c7c4bd7807ec92ed037caeb6c3bc70d29adb8e4b4.png" src="../_images/b5881c6ea206091c18da806c7c4bd7807ec92ed037caeb6c3bc70d29adb8e4b4.png" />
</div>
</div>
<p>It is clear that the filters are low-pass, high-pass, band-pass and band-stop. There is now ripple in the pass-band or stop band so they are all Butterworth filters.</p>
</section>
</section>
</section>
</section>
<section id="digital-filter-design-with-simulink">
<span id="u72-simulink"></span><h2>Digital Filter Design with Simulink<a class="headerlink" href="#digital-filter-design-with-simulink" title="Permalink to this heading">#</a></h2>
<p>As stated earlier in this unit, a digital filter is a computational process, or algorithm, that converts one sequence of numbers representing the input signal into another sequence of numbers representing the output signal.</p>
<p>To close out this unit and the module, we will explore Simulink models that can be used to implement digital filters, and present the <em>Digital Filter Design</em> block included in the <a class="reference external" href="https://uk.mathworks.com/help/dsp/index.html">Simulink DSP System Toolbox</a>, which can generate these models automatically.</p>
<section id="the-direct-form-i-realization-of-a-digital-filter">
<span id="u72-fd-direct-i"></span><h3>The Direct Form I Realization of a Digital Filter<a class="headerlink" href="#the-direct-form-i-realization-of-a-digital-filter" title="Permalink to this heading">#</a></h3>
<p>The <strong>Direct Form I Realization</strong> of a second-order digital filter is shown in <a class="reference internal" href="#fig-u72-3"><span class="std std-numref">Fig. 16</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">dfir_df</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-u72-3">
<a class="reference internal image-reference" href="../_images/dfir_df.png"><img alt="Direct Form I Realization of a second-order digital filter" src="../_images/dfir_df.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">Direct Form I Realization of a second-order digital filter</span><a class="headerlink" href="#fig-u72-3" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Download this model as <a class="reference download internal" download="" href="../_downloads/cc11377491744efd0fbab600c3966605/dfir_df.slx"><span class="xref download myst">dfir_df</span></a>.</p>
<p>At the summing junction of <a class="reference internal" href="#fig-u72-3"><span class="std std-numref">Fig. 16</span></a> we obtain</p>
<div class="math notranslate nohighlight">
\[b_0X(z)+b_1z^{-1}X(z)+b_2z^{-2}X(z) + \left(-a_1\right)z^{-1}Y(z) + \left(-a_1\right)z^{-2}Y(z) = Y(z)\]</div>
<div class="math notranslate nohighlight">
\[X(z)\left(b_0 + b_1z^{-1} + b_2z^{-2}\right) = Y(s)\left(1 + a_1z^{-1} + a_2z^{-2}\right)\]</div>
<p>And thus, the transfer function of the Direct Form I Realization of the second-order digital filter of <a class="reference internal" href="#fig-u72-3"><span class="std std-numref">Fig. 16</span></a> is</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-17">
<span class="eqno">(58)<a class="headerlink" href="#equation-eq-7-2-17" title="Permalink to this equation">#</a></span>\[H(z) = \frac{Y(z)}{X(z)} = \frac{b_0 + b_1z^{-1} + b_2z^{-2}}{1 + a_1z^{-1} + a_2z^{-2}} \]</div>
<p>A disadvantage of the Direct Form I Realization digital filter is that it requires <span class="math notranslate nohighlight">\(2k\)</span> registers where <span class="math notranslate nohighlight">\(k\)</span> represents the order of the filter. We observe that the second-order (<span class="math notranslate nohighlight">\(k=2\)</span>) digital filter of <a class="reference internal" href="#fig-u72-3"><span class="std std-numref">Fig. 16</span></a> requires 4 delay (register) elements denoted as <span class="math notranslate nohighlight">\(z^{-1}\)</span>. However, this form of realization has the advantage that there is no possibility of internal filter overflow<a class="footnote-reference brackets" href="#u72-notes-5" id="id10">5</a>.</p>
</section>
<section id="the-direct-form-ii-realization-of-a-digital-filter">
<span id="u72-fd-direct-ii"></span><h3>The Direct Form II Realization of a Digital Filter<a class="headerlink" href="#the-direct-form-ii-realization-of-a-digital-filter" title="Permalink to this heading">#</a></h3>
<p>The <strong>Direct Form II Realization</strong><a class="footnote-reference brackets" href="#u72-notes-6" id="id11">6</a> of a second-order digital filter is shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig:u72:4</span></code>. The Simulink <a class="reference external" href="https://uk.mathworks.com/help/simulink/slref/transferfcndirectformii.html"><strong>Transfer Fcn Direct Form II</strong></a> block implements the transfer function of this filter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">dfiir_df</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-u72-4">
<a class="reference internal image-reference" href="../_images/dfiir_df.png"><img alt="Direct Form II Realization of a second-order digital filter" src="../_images/dfiir_df.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 17 </span><span class="caption-text">Direct Form II Realization of a second-order digital filter</span><a class="headerlink" href="#fig-u72-4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Download this model as <a class="reference download internal" download="" href="../_downloads/6da708592d4381f1d785541440f3e765/dfiir_df.slx"><span class="xref download myst">dfiir_df.slx</span></a>.</p>
<p>The transfer function for the Direct Form-II second-order digital filter of <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig:u72:4</span></code> is the same as for a Direct Form-I second-order filter of <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig:u72:4</span></code>, that is,</p>
<div class="math notranslate nohighlight" id="equation-eq-7-2-18">
<span class="eqno">(59)<a class="headerlink" href="#equation-eq-7-2-18" title="Permalink to this equation">#</a></span>\[H(z) = \frac{b_0 + b_1z^{-1} + b_2z^{-2}}{1 + a_1z^{-1} + a_2z^{-2}} \]</div>
<p>A camparison of <code class="xref std std-numref docutils literal notranslate"><span class="pre">eq:7.2:17</span></code> and <code class="xref std std-numref docutils literal notranslate"><span class="pre">eq:7.2:18</span></code> shows that whereas a Direct Form-I second-order digital filter requires <span class="math notranslate nohighlight">\(2k\)</span> registers, where <span class="math notranslate nohighlight">\(k\)</span> represents the order of the filter, a Direct Type-II second-order digital filter requires only <span class="math notranslate nohighlight">\(k\)</span> register elements denoted as <span class="math notranslate nohighlight">\(z^{-1}\)</span>. This is because the register (<span class="math notranslate nohighlight">\(z^{-1}\)</span>) elements of the Direct Form-II realization are shared between the zeros section and the poles section.</p>
<section id="example-14">
<span id="u72-ex-14"></span><h4>Example 14<a class="headerlink" href="#example-14" title="Permalink to this heading">#</a></h4>
<p><code class="xref std std-numref docutils literal notranslate"><span class="pre">u72:fig:5</span></code> shows a Direct Form-II second-order digital filter whose transfer function is</p>
<div class="math notranslate nohighlight" id="equation-eq-u72-19">
<span class="eqno">(60)<a class="headerlink" href="#equation-eq-u72-19" title="Permalink to this equation">#</a></span>\[H(z) = \frac{1+1.5z^{-1}+1.02z^{-2}}{1 - 0.25 z^{-1} -0.75 z^{-2}} \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">ex14</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="id12">
<a class="reference internal image-reference" href="../_images/ex14.png"><img alt="Direct Form II Realization of the Simulink implementation of Example 14" src="../_images/ex14.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 18 </span><span class="caption-text">Model for Example 14</span><a class="headerlink" href="#id12" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Download this model as <a class="reference download internal" download="" href="../_downloads/db9bd56d8213eea9cd080fd5f59d5da5/ex14.slx"><span class="xref download myst">ex14.slx</span></a>.</p>
</section>
</section>
<section id="the-series-form-realization-of-a-digital-filter">
<span id="u72-fd-series"></span><h3>The Series Form Realization of a Digital Filter<a class="headerlink" href="#the-series-form-realization-of-a-digital-filter" title="Permalink to this heading">#</a></h3>
<p>For the Series Form Realization, the transfer function is expressed as a product of first-order and second-orer transefer functions as shown in <a class="reference internal" href="#equation-eq-u72-20">(61)</a> below.</p>
<div class="math notranslate nohighlight" id="equation-eq-u72-20">
<span class="eqno">(61)<a class="headerlink" href="#equation-eq-u72-20" title="Permalink to this equation">#</a></span>\[H(z) = H_1(z)\cdot H_2(z)\cdots H_R(z)\]</div>
<p>Relation <a class="reference internal" href="#equation-eq-u72-20">(61)</a> is implemented as the cascaded blocks shown in <a class="reference internal" href="#fig-u72-5"><span class="std std-numref">Fig. 19</span></a></p>
<figure class="align-default" id="fig-u72-5">
<a class="reference internal image-reference" href="../_images/series.png"><img alt="../_images/series.png" src="../_images/series.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 19 </span><span class="caption-text">Series Form Realization</span><a class="headerlink" href="#fig-u72-5" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#fig-u72-6"><span class="std std-numref">Fig. 20</span></a> shows the Series Form Realization of a second-order digital filter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">series_form_2nd</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-u72-6">
<a class="reference internal image-reference" href="../_images/series_2nd.png"><img alt="../_images/series_2nd.png" src="../_images/series_2nd.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 20 </span><span class="caption-text">Series Form Realization of a second-order digital filter</span><a class="headerlink" href="#fig-u72-6" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Download this model as <a class="reference download internal" download="" href="../_downloads/e6cbfc13f414a5b5851bf0bb85da33a0/series_form_2nd.slx"><span class="xref download myst">series_form_2nd.slx</span></a>.</p>
<section id="example-15">
<span id="u72-ex-15"></span><h4>Example 15<a class="headerlink" href="#example-15" title="Permalink to this heading">#</a></h4>
<p>The transfer function of the series form Realization of a certian second-order digital filter is</p>
<div class="math notranslate nohighlight">
\[H(z) = \frac{0.5\left(1-0.36z^{-2}\right)}{1 + 0.1 z^{-1} - 0.72 z^{-2}} \]</div>
<p>To implement this filter, we factor the numerator and denominator polynomials as<a class="footnote-reference brackets" href="#u72-note-7" id="id13">7</a></p>
<div class="math notranslate nohighlight" id="equation-eq-u72-21">
<span class="eqno">(62)<a class="headerlink" href="#equation-eq-u72-21" title="Permalink to this equation">#</a></span>\[H(z) = \frac{0.5\left(1+0.6z^{-1}\right)\left(1-0.6z^{-1}\right)}{\left(1+0.9z^{-1}\right)\left(1-0.8z^{-1}\right)} \]</div>
<p>The Simulink model and the input and output waveforms are shown in <a class="reference internal" href="#fig-u72-7"><span class="std std-numref">Fig. 21</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">ex15</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="fig-u72-7">
<a class="reference internal image-reference" href="../_images/ex15.png"><img alt="Series Form Realization of the digital filter of Example 15" src="../_images/ex15.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 21 </span><span class="caption-text">Model for Example 15</span><a class="headerlink" href="#fig-u72-7" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Download this model as <a class="reference download internal" download="" href="../_downloads/6d2704d81f86bd2fb2ed313c814a8803/ex15.slx"><span class="xref download myst">ex15.slx</span></a>.</p>
</section>
</section>
<section id="the-parallel-form-realization-of-a-digital-filter">
<span id="u72-fd-parallel"></span><h3>The Parallel Form Realization of a Digital Filter<a class="headerlink" href="#the-parallel-form-realization-of-a-digital-filter" title="Permalink to this heading">#</a></h3>
<p>The general form of the transfer function of a Parallel Form Realization is</p>
<div class="math notranslate nohighlight" id="equation-eq-u72-22">
<span class="eqno">(63)<a class="headerlink" href="#equation-eq-u72-22" title="Permalink to this equation">#</a></span>\[H(z) = K + H_1(z) + H_2(z) + \cdots + H_R(z)\]</div>
<p>Relation <a class="reference internal" href="#equation-eq-u72-22">(63)</a> is implemented at the parallel blocks shown in <a href="#id14"><span class="problematic" id="id15">fig:u72:8</span></a></p>
<figure class="align-default" id="fig-u72-8">
<a class="reference internal image-reference" href="../_images/parallel.png"><img alt="../_images/parallel.png" src="../_images/parallel.png" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 22 </span><span class="caption-text">Parallel Form Realization of a second-order digital filter</span><a class="headerlink" href="#fig-u72-8" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>As with the Series Form Realization, the ordering of the individual filters in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig:u72:8</span></code> is immaterial. But because of the presence of the constant <span class="math notranslate nohighlight">\(K\)</span>, we can simplify the transfer function expressiom by performing the partial fraction expansion after we express the transfer function in the form <span class="math notranslate nohighlight">\(H(z)/z\)</span>.</p>
<section id="example-16">
<span id="u72-ex-16"></span><h4>Example 16<a class="headerlink" href="#example-16" title="Permalink to this heading">#</a></h4>
<p>The transfer function of a certain second-order digital filter is</p>
<div class="math notranslate nohighlight">
\[H(z) = \frac{0.5\left(1-0.36z^{-2}\right)}{1+0.1z^{-1}-0.72z^{-2}} \]</div>
<p>Implement this filter using the Parallel Form Realization.</p>
<div class="math notranslate nohighlight">
\[\frac{H(z)}{z}  = \frac{0.5\left(z+0.6\right)\left(z-0.6\right)}{z\left(z+0.9\right)\left(z-0.8\right)} \]</div>
<p>Next we perform partial fraction expansion</p>
<div class="math notranslate nohighlight">
\[\frac{0.5\left(z+0.6\right)\left(z-0.6\right)}{z\left(z+0.9\right)\left(z-0.8\right)} = \frac{r_1}{z} + \frac{r_2}{z+0.9} + \frac{r_2}{z-0.8} \]</div>
<div class="math notranslate nohighlight">
\[r_1 = \left.\frac{0.5\left(z+0.6\right)\left(z-0.6\right)}{\left(z+0.9\right)\left(z-0.8\right)}\right|_{z=0} = 0.25\]</div>
<div class="math notranslate nohighlight">
\[r_2 = \left.\frac{0.5\left(z+0.6\right)\left(z-0.6\right)}{z\left(z-0.8\right)}\right|_{z=-0.9} = 0.147\]</div>
<div class="math notranslate nohighlight">
\[r_3 = \left.\frac{0.5\left(z+0.6\right)\left(z-0.6\right)}{z\left(z+0.9\right)}\right|_{z=0.8} = 0.103\]</div>
<p>Therefore,</p>
<div class="math notranslate nohighlight">
\[\frac{H(z)}{z} = \frac{0.25}{z} + \frac{0.147}{z+0.9} + \frac{0.103}{z-0.8}\]</div>
<div class="math notranslate nohighlight">
\[H(z) = 0.25 + \frac{0.147z}{z+0.9} + \frac{0.103z}{z-0.8}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-u72-23">
<span class="eqno">(64)<a class="headerlink" href="#equation-eq-u72-23" title="Permalink to this equation">#</a></span>\[H(z) = 0.25 + \frac{0.147}{1+0.9z^{-1}} + \frac{0.103}{1-0.8z^{-1}}\]</div>
<p>The model and input and output waveforms are shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig:u72:8</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">ex16</span>
</pre></div>
</div>
</div>
</div>
<figure class="align-default" id="id16">
<a class="reference internal image-reference" href="../_images/ex16.png"><img alt="Parallel Form Realization of the digital filter of Example 16" src="../_images/ex16.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 23 </span><span class="caption-text">Model for Example 16</span><a class="headerlink" href="#id16" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Download this model as <a class="reference download internal" download="" href="../_downloads/150e0236e593584c08f4fa47f5fbd755/ex16.slx"><span class="xref download myst">ex16.slx</span></a>.</p>
</section>
</section>
</section>
<section id="the-digital-filter-design-block">
<span id="u72-df-design-block"></span><h2>The Digital Filter Design Block<a class="headerlink" href="#the-digital-filter-design-block" title="Permalink to this heading">#</a></h2>
<p>The <a class="reference external" href="https://uk.mathworks.com/help/dsp/ug/using-digital-filter-design-block.html"><strong>Digital Filter Design</strong> block</a> is included in the <a class="reference external" href="https://uk.mathworks.com/help/dsp/index.html">DSP System Toolbox</a> and is included in the version of MATLAB for which Swansea University has a site license. It also works on MATLAB online. This block can be used to create models related to digital filter design applications directly in Simulink.</p>
<p>The functionality of this block can be observed by dragging this block from the library into a model and double clicking it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="n">dfd_block</span>
</pre></div>
</div>
</div>
</div>
<p>When this is done, the <strong>Block Parameters</strong> dialogue box appears as shown in <a class="reference internal" href="#fig-u72-9"><span class="std std-numref">Fig. 24</span></a>.</p>
<figure class="align-default" id="fig-u72-9">
<a class="reference internal image-reference" href="../_images/dfd_block.png"><img alt="Screenshot of the Digital Filter Design Block Parameters dialogue box" src="../_images/dfd_block.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text">The Digital Filter Design Block Parameters dialogue box</span><a class="headerlink" href="#fig-u72-9" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Download this model as <a class="reference download internal" download="" href="../_downloads/8171f19cf2942abbf2aeb76493934639/dfd_block.slx"><span class="xref download myst">ex16.slx</span></a>.</p>
<p>As indicated on the lower left part of this window, we can choose the <em>Response Type</em> (Low-Pass, High-Pass, Band-Pass or Band-Stop), the <strong>Design Method</strong> (IIR or FIR) where an IIR filter can be Butterworth, Chebyshev Type I, Chebyshev Type II, or Elliptic, and FIR can be Window, Maximally Flat, etc., and the <strong>Window</strong><a class="footnote-reference brackets" href="#u72-note-8" id="id17">8</a> can be Kaiser, Hamming etc. We must click on the <strong>Design Filter</strong>. buttom at the bottom right of the Block Parameters dialogue box to update the specifications.</p>
<p>We will not give an actual example of the use of the Simulink filter design block in these notes. Instead we refer you to Example 11.7 in <span id="id18">[<a class="reference internal" href="../zbib.html#id7" title="Steven T. Karris. Signals and systems with MATLAB computing and Simulink modeling. Orchard Publishing, Fremont, CA., fifth edition, 2012. ISBN 9781934404232. Library call number: TK5102.9 K37 2012 LOCATE. URL: https://ebookcentral.proquest.com/lib/swansea-ebooks/detail.action?docID=3384197&amp;pq-origsite=primo.">Karris, 2012</a>]</span> and also to the relevant page <a class="reference external" href="https://uk.mathworks.com/help/dsp/ug/using-digital-filter-design-block.html">Using Digital Filter Design Block</a> in the MATLAB documentation site. There you will find documentation of the Digital Filter Design Block and several examples of its use.</p>
<p>If you go on from this course to do some actual signal processing, we would urge you to take full advantage of these resources.</p>
<section id="code-generation">
<h3>Code generation<a class="headerlink" href="#code-generation" title="Permalink to this heading">#</a></h3>
<p>As well as the ability to design filters that can be immediately used in simulations of digital signal processing applications, and the muliple analysis tools it provides in the the Digital Filter Design Block, povided by the Signal Processing Toolbox and the DSP System Toolbox, be used for code generation.</p>
<p>For example, it can generate Simulink models of the designed filter, as well as C header files, and HDL code for VHDL and verilog devices.</p>
<p>Thus, MATLAB can be used in a so-called model-based design process as described in the opening video</p>
</section>
</section>
<section id="the-end">
<h2>The End?<a class="headerlink" href="#the-end" title="Permalink to this heading">#</a></h2>
<p>This concludes this module. Don’t forget to let us know how it went for you in the end of module feedback.</p>
<p>There are exercises in the notes which will give you practice in the sort of questions that will come up in the exam.</p>
<p>Hopefully you found the module interesting and will make use of some of your knowledge after the exams are over!</p>
</section>
<section id="exercises">
<span id="u72-exercises"></span><h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<section id="exercise-7-2-1">
<span id="u72-ex-1"></span><h3>Exercise 7.2.1<a class="headerlink" href="#exercise-7-2-1" title="Permalink to this heading">#</a></h3>
<p><strong>Exam Preparation</strong></p>
<p>Use the block diagram shown in <a class="reference internal" href="#fig-u72-1"><span class="std std-numref">Fig. 14</span></a> to validate <code class="xref eq docutils literal notranslate"><span class="pre">eq:u7.2:2</span></code> and <code class="xref eq docutils literal notranslate"><span class="pre">eq:u7.2:1</span></code>.</p>
<p id="u72-ex-2"><strong>Exam Preparation</strong></p>
</section>
<section id="exercise-7-2-2">
<h3>Exercise 7.2.2<a class="headerlink" href="#exercise-7-2-2" title="Permalink to this heading">#</a></h3>
<p>Use the block diagram shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig:u72:4</span></code> to validate <code class="xref eq docutils literal notranslate"><span class="pre">eq:u72:18</span></code>. Write down the equivalent difference equation.</p>
</section>
<section id="exercise-7-2-3">
<span id="u72-ex-3"></span><h3>Exercise 7.2.3<a class="headerlink" href="#exercise-7-2-3" title="Permalink to this heading">#</a></h3>
<p><strong>Exam Preparation</strong></p>
<p>Design a 2nd-order Butterworth filter with <span class="math notranslate nohighlight">\(\omega_c = 20\)</span> kHz. Use the Bilinear transformation to convert the analogue filter to a digital filter with sampling frequency of 44.1 kHz. Use pre-warping to ensure that the cutoff frequency is correct at the equivalent digital frequency.</p>
</section>
<section id="exercise-7-2-4">
<span id="u72-ex-4"></span><h3>Exercise 7.2.4<a class="headerlink" href="#exercise-7-2-4" title="Permalink to this heading">#</a></h3>
<p><strong>Exam Preparation</strong></p>
<p>A digital filter with cutoff frequency of 100 Hz for a signal sampled at 1 kHz has transfer function</p>
<div class="math notranslate nohighlight">
\[H(z) = \frac{0.6401   -1.1518z^{-1}   + 0.6401z^{-2}}{1	-1.0130 z^{-1}    + 0.4190z^{-2}} \]</div>
<p>The frequency response for this filter (plotted against <span class="math notranslate nohighlight">\(f/(f_s/2)\)</span>) is shown in <code class="xref std std-numref docutils literal notranslate"><span class="pre">fig:u72:ex7.2.2</span></code>.</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="u72-note-1"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p>Note that the block labelled <span class="math notranslate nohighlight">\(z^{-1}\)</span> is a one unit delay <span class="math notranslate nohighlight">\(y[n] = x[n - 1]\)</span>; the triangular blocks are gains <span class="math notranslate nohighlight">\(y[n] = k x[n]\)</span>; and the circular blocks are summing points. Following the equations we have <span class="math notranslate nohighlight">\(w[n] = x[n] - a_1 w[n-1] - a_2 w[n-2] - a_3 w[n-3]\)</span> and <span class="math notranslate nohighlight">\(y[n] = b_0 w[n] + b_1 w[n-1] + b_2 w[n-2] + b_3 w[n-3]\)</span>. It is left as an exercise for the reader to show that combining these two equations, taking Z-transforms, and eliminating <span class="math notranslate nohighlight">\(W(z)\)</span>, results in the transfer function <span class="math notranslate nohighlight">\(H(z) = Y(z)/X(z)\)</span> given in <a class="reference internal" href="#equation-eq-7-2-2">(38)</a> and hence the difference equation of <a class="reference internal" href="#equation-eq-7-2-1">(37)</a>.</p>
</dd>
<dt class="label" id="u72-note-2"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p>It is obvious from this figure that <span class="math notranslate nohighlight">\(y[n] = b_0 x[n] + b_1 x[n-1] + b_2 x[n-2] + b_3 x[n-3]\)</span>.</p>
</dd>
<dt class="label" id="u72-note-3"><span class="brackets"><a class="fn-backref" href="#id4">3</a></span></dt>
<dd><p><span class="math notranslate nohighlight">\(T_s\)</span> is the sampling period, that is the reciprocal of the sampling frequency <span class="math notranslate nohighlight">\(f_s\)</span> Hz.</p>
</dd>
<dt class="label" id="u72-note-4"><span class="brackets"><a class="fn-backref" href="#id5">4</a></span></dt>
<dd><p>Note the significant distortion of the digital filter response at high frequencies.</p>
</dd>
<dt class="label" id="u72-notes-5"><span class="brackets"><a class="fn-backref" href="#id10">5</a></span></dt>
<dd><p>For a detailed discussion on overflow conditions please refer to Section 10.5, Chapter 10, Page 10-6 of <span id="id19">[<a class="reference internal" href="../zbib.html#id23" title="Steven T. Karris. Digital Circuit Analysis and Design with an Introduction to CPLDs and FPGAs. Orchard Publications, Fremont, CA., first edition, 2005. ISBN 0-9744239-6-3.">Karris, 2005</a>]</span>.</p>
</dd>
<dt class="label" id="u72-notes-6"><span class="brackets"><a class="fn-backref" href="#id11">6</a></span></dt>
<dd><p>The Direct Form-II is also known as the <strong>Canonical</strong> Form.</p>
</dd>
<dt class="label" id="u72-note-7"><span class="brackets"><a class="fn-backref" href="#id13">7</a></span></dt>
<dd><p>The way we combine the numerator and denominator factors is immaterial. For example we could group the factors as <span class="math notranslate nohighlight">\(\left(1 + 0.6z^{-1}\right)/\left(1+0.9z^{-1}\right)\)</span> and <span class="math notranslate nohighlight">\(\left(1 - 0.6z^{-1}\right)/\left(1-0.8z^{-1}\right)\)</span>, or as <span class="math notranslate nohighlight">\(\left(1 + 0.6z^{-1}\right)/\left(1-0.8z^{-1}\right)\)</span> and <span class="math notranslate nohighlight">\(\left(1 - 0.6z^{-1}\right)/\left(1+0.9z^{-1}\right)\)</span>.</p>
</dd>
<dt class="label" id="u72-note-8"><span class="brackets"><a class="fn-backref" href="#id17">8</a></span></dt>
<dd><p>A window function multiplies the infinte length impulse response (IIR) by a finite width function, referred to a a window function, so that the infinite length series will be terminated after a finite number of terms in the series. This causes what is called <em>leakage</em> and results in additional ripple in the frequency domain. Windows of various shapes can be used to minimize this leakage for particular applications. The study of windowing functions is beyond the scope of this course. In the CPD course <a class="reference external" href="https://matlabacademy.mathworks.com/R2023b/portal.html?course=mlsg#chapter=6&amp;lesson=4&amp;section=1">Signal Processing Toolbox</a> you were shown the use of windowing functions as a design method for approximating an ideal filter. EEE stidents will have experienced windowing effecrs in the EGA223 lab on ADC, DAC and filters. You can study windowing in more detail in Appendix E of <span id="id20">[<a class="reference internal" href="../zbib.html#id7" title="Steven T. Karris. Signals and systems with MATLAB computing and Simulink modeling. Orchard Publishing, Fremont, CA., fifth edition, 2012. ISBN 9781934404232. Library call number: TK5102.9 K37 2012 LOCATE. URL: https://ebookcentral.proquest.com/lib/swansea-ebooks/detail.action?docID=3384197&amp;pq-origsite=primo.">Karris, 2012</a>]</span>.</p>
</dd>
</dl>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "matlab"
        },
        kernelOptions: {
            name: "matlab",
            path: "./filter_design"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'matlab'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="analogue_filters.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Unit 7.1: Designing Analogue Filters</p>
      </div>
    </a>
    <a class="right-next"
       href="../zbib.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">References</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#colophon">Colophon</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scope-and-background-reading">Scope and Background Reading</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-started-with-simulink-for-signal-processing">Getting Started with Simulink for Signal Processing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#agenda">Agenda</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#digital-filters">Digital filters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#classification-of-digital-filters">Classification of digital filters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#impulse-response-duration">1. Impulse response duration</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#realization">2. Realization</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation-of-digital-filters">Implementation of digital filters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#recursive-realization">Recursive realization</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#non-recursive-realization">Non-recursive realization</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#digital-filter-design-methods">Digital filter design methods</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-impulse-invariant-method">1. The <em>impulse invariant method</em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-step-invariant-method">2. The <em>step invariant method</em></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#the-bilinear-transformation-method">3. The <em>bilinear transformation method</em></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-bilinear-transformation">The Bilinear Transformation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#digital-frequency-response-of-the-bilinear-transformation">Digital frequency response of the bilinear transformation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-warping-of-the-bilinear-transformation">Frequency warping of the bilinear transformation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-warping">Pre-warping</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-12">Example 12</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#solution">Solution</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matlab-bilinear-function">MATLAB bilinear function</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-13">Example 13</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Solution</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matlab-functions-for-direct-digital-filter-design">MATLAB Functions for direct digital filter design</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-low-pass-filters">For Low-Pass Filters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-high-pass-filters">For High-Pass Filters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-band-pass-filters">For Band-Pass Filters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#for-band-elimination-filters">For Band-Elimination Filters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">Example 13</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#a">13(a)</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#b">13(b)</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#c">13(c)</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#d">13(d)</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">Solution</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#digital-filter-design-with-simulink">Digital Filter Design with Simulink</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-direct-form-i-realization-of-a-digital-filter">The Direct Form I Realization of a Digital Filter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-direct-form-ii-realization-of-a-digital-filter">The Direct Form II Realization of a Digital Filter</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-14">Example 14</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-series-form-realization-of-a-digital-filter">The Series Form Realization of a Digital Filter</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-15">Example 15</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-parallel-form-realization-of-a-digital-filter">The Parallel Form Realization of a Digital Filter</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#example-16">Example 16</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-digital-filter-design-block">The Digital Filter Design Block</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-generation">Code generation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-end">The End?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-2-1">Exercise 7.2.1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-2-2">Exercise 7.2.2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-2-3">Exercise 7.2.3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7-2-4">Exercise 7.2.4</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Chris P. Jobling
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright Swansea University (2023-2024).
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  This page was created by 
<a href="https://www.swansea.ac.uk/staff/engineering/c.p.jobling/">
  Dr Chris P. Jobling
</a> 
for 
<a href="https://www.swansea.ac.uk">
  Swansea University
</a>.

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>